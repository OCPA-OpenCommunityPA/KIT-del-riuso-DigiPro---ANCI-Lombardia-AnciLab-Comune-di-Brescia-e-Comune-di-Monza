<definitions id="Definition"
				 targetNamespace="http://www.omg.org/bpmn20"
				 typeLanguage="http://www.java.com/javaTypes"
				 expressionLanguage="http://www.mvel.org/2.0"
				 xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL"
				 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
				 xsi:schemaLocation="http://www.omg.org/spec/BPMN/20100524/MODEL BPMN20.xsd"
				 xmlns:g="http://www.jboss.org/drools/flow/gpd"
				 xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI"
				 xmlns:dc="http://www.omg.org/spec/DD/20100524/DC"
				 xmlns:di="http://www.omg.org/spec/DD/20100524/DI"
				 xmlns:tns="http://www.jboss.org/drools">

    <itemDefinition id="booleanType" structureRef="java.lang.Boolean"/>

    <itemDefinition id="numberType" structureRef="java.lang.Number"/>
    <itemDefinition id="integerType" structureRef="java.lang.Number"/>

    <itemDefinition id="textType" structureRef="java.lang.String"/>
    <itemDefinition id="textRefType" structureRef="java.lang.String"/>
    <itemDefinition id="scriptType" structureRef="java.lang.String"/>
    <itemDefinition id="actorType" structureRef="java.lang.String"/>
    <itemDefinition id="actoridType" structureRef="java.lang.String"/>
    <itemDefinition id="fileType" structureRef="java.lang.String"/>
    <itemDefinition id="userTokenType" structureRef="java.lang.String"/>
    <itemDefinition id="htmlType" structureRef="java.lang.String"/>
    <itemDefinition id="noteType" structureRef="java.lang.String"/>
    <itemDefinition id="multiInstanceItemType" structureRef="java.lang.String" />
    <itemDefinition id="datetimeType" structureRef="java.lang.String"/>
    <itemDefinition id="timeSpanType" structureRef="java.lang.String"/>
    <itemDefinition id="deadlineType" structureRef="java.lang.String"/>
    <itemDefinition id="diagramType" structureRef="java.lang.String"/>

    <itemDefinition id="objectType" structureRef="java.util.HashMap"/>
    <itemDefinition id="entityType" structureRef="java.util.HashMap"/>
    <itemDefinition id="documentType" structureRef="java.util.HashMap"/>
    <itemDefinition id="fascicoloType" structureRef="java.util.HashMap"/>
    <itemDefinition id="mittenteType" structureRef="java.util.HashMap"/>
    <itemDefinition id="communicationType" structureRef="java.util.HashMap"/>
    <itemDefinition id="laneType" structureRef="java.util.HashMap"/>
    <itemDefinition id="systemType" structureRef="java.util.HashMap"/>
    <itemDefinition id="soggettoType" structureRef="java.util.HashMap"/>
    <itemDefinition id="classificaType" structureRef="java.util.HashMap"/>
    <itemDefinition id="registroType" structureRef="java.util.HashMap"/>
    <itemDefinition id="uoType" structureRef="java.util.HashMap"/>
    <itemDefinition id="roleType" structureRef="java.util.HashMap"/>
    <itemDefinition id="MessageType" structureRef="java.util.HashMap"/>

    <itemDefinition id="tempType" structureRef="java.lang.Object"/>

    <itemDefinition id="collectionType" structureRef="java.util.List"/>
    <itemDefinition id="_listItem" structureRef="java.util.List" />

    <message id="defaultMessage" itemRef="MessageType" />
    <error id="cancel" errorCode="cancel" />
    <itemDefinition id="canaleJMSType" structureRef="canaleJMS"/>
    <message id="canaleJMS" itemRef="canaleJMSType" />
    <error id="bpmn2.ServiceException" errorCode="bpmn2.ServiceException" />
    <error id="bpmn2.SendException" errorCode="bpmn2.SendException" />
    <error id="bpmn2.WorkflowException" errorCode="bpmn2.WorkflowException" />
    <itemDefinition id="canalePECType" structureRef="canalePEC"/>
    <message id="canalePEC" itemRef="canalePECType" />
    <error id="anyException" />
    <itemDefinition id="canaleMAILType" structureRef="canaleMAIL"/>
    <message id="canaleMAIL" itemRef="canaleMAILType" />

    <interface id="EAID_B73BF5BB_A892_460d_B3BA_5D8873850689" name="Interface1">
        <operation id="swaggerOperation" name="swaggerOperation">
            <inMessageRef>defaultMessage</inMessageRef>
        </operation>
    </interface>

    <process processType="Private" tns:version="1.1" isExecutable="true" id="Determinazioni dirigenziali Base1.1" name="Determinazioni dirigenziali Base" tns:packageName="Orchestratore">
        <property id="approvatori_proponente" itemSubjectRef="collectionType"/>
        <property id="indirizzoDefault" itemSubjectRef="textType"/>
        <property id="tipologiePrincipale" itemSubjectRef="collectionType"/>
        <property id="_tmpc_" itemSubjectRef="collectionType"/>
        <property id="tipologieAnnotazione" itemSubjectRef="collectionType"/>
        <property id="INSTANCE_AOO" itemSubjectRef="textType"/>
        <property id="humanToken" itemSubjectRef="userTokenType"/>
        <property id="listaAllegati_precedenti" itemSubjectRef="collectionType"/>
        <property id="responseObject" itemSubjectRef="objectType"/>
        <property id="istanceProvvedimento" itemSubjectRef="textType"/>
        <property id="tipo_determina" itemSubjectRef="textType"/>
        <property id="_tmp1_" itemSubjectRef="tempType"/>
        <property id="$state" itemSubjectRef="integerType"/>
        <property id="valori_determina" itemSubjectRef="objectType"/>
        <property id="lanes" itemSubjectRef="collectionType"/>
        <property id="valori_senzaSpeseEntrate" itemSubjectRef="objectType"/>
        <property id="urlDocer" itemSubjectRef="textType"/>
        <property id="controllo_responsabile" itemSubjectRef="textType"/>
        <property id="indice_destinatari" itemSubjectRef="textType"/>
        <property id="lista_risposte" itemSubjectRef="collectionType"/>
        <property id="mittente" itemSubjectRef="objectType"/>
        <property id="$" itemSubjectRef="objectType"/>
        <property id="table_risposta" itemSubjectRef="textType"/>
        <property id="docnum_determina" itemSubjectRef="textType"/>
        <property id="approvatori_dirigente" itemSubjectRef="collectionType"/>
        <property id="firma" itemSubjectRef="textType"/>
        <property id="destinatario" itemSubjectRef="objectType"/>
        <property id="exit" itemSubjectRef="textType"/>
        <property id="variabili_senzaSpeseEntrate" itemSubjectRef="objectType"/>
        <property id="nome_gruppoDirigenteDefault" itemSubjectRef="textType"/>
        <property id="_tmp0_" itemSubjectRef="tempType"/>
        <property id="fascicoli_secondari" itemSubjectRef="collectionType"/>
        <property id="mittenti_registrazione" itemSubjectRef="collectionType"/>
        <property id="tipologieAllegato" itemSubjectRef="collectionType"/>
        <property id="doc_visto_copy" itemSubjectRef="objectType"/>
        <property id="approvatori_responsabile" itemSubjectRef="collectionType"/>
        <property id="valori_conSpese" itemSubjectRef="objectType"/>
        <property id="template_conSpese" itemSubjectRef="objectType"/>
        <property id="figura_professionale2" itemSubjectRef="textType"/>
        <property id="prima_determina" itemSubjectRef="textType"/>
        <property id="instanceId" itemSubjectRef="textRefType"/>
        <property id="timeline_row1" itemSubjectRef="collectionType"/>
        <property id="variabili_conSpese" itemSubjectRef="objectType"/>
        <property id="businessState" itemSubjectRef="textType"/>
        <property id="importoLiquidazione" itemSubjectRef="textType"/>
        <property id="record_provvedimento" itemSubjectRef="entityType"/>
        <property id="lista_allegati_omissis" itemSubjectRef="collectionType"/>
        <property id="INSTANCE_ENTE" itemSubjectRef="textType"/>
        <property id="outcome" itemSubjectRef="objectType"/>
        <property id="Amministratori" itemSubjectRef="objectType"/>
        <property id="contextKey" itemSubjectRef="textType"/>
        <property id="record_determina_provvedimento" itemSubjectRef="entityType"/>
        <property id="Default" itemSubjectRef="objectType"/>
        <property id="template_senzaSpeseEntrate" itemSubjectRef="objectType"/>
        <property id="Default2" itemSubjectRef="objectType"/>
        <property id="record_risposte" itemSubjectRef="collectionType"/>
        <property id="__ckValue" itemSubjectRef="collectionType"/>
        <property id="variabili_determina_omissis" itemSubjectRef="objectType"/>
        <property id="fascicolo_determina" itemSubjectRef="objectType"/>
        <property id="timeline_state" itemSubjectRef="integerType"/>
        <property id="figura_professionale_amministratori" itemSubjectRef="textType"/>
        <property id="table_domanda" itemSubjectRef="textType"/>
        <property id="_tmp2_" itemSubjectRef="tempType"/>
        <property id="tipologieAnnesso" itemSubjectRef="collectionType"/>
        <property id="Administrators" itemSubjectRef="objectType"/>
        <property id="isRischio" itemSubjectRef="textType"/>
        <property id="lista_annessi_determina" itemSubjectRef="collectionType"/>
        <property id="risposteHT_out" itemSubjectRef="collectionType"/>
        <property id="tipo_firma" itemSubjectRef="textType"/>
        <property id="omissis" itemSubjectRef="textType"/>
        <property id="fascicolo" itemSubjectRef="objectType"/>
        <property id="gestione_omissis" itemSubjectRef="textType"/>
        <property id="destinatari_registrazione" itemSubjectRef="collectionType"/>
        <property id="descrizione_ufficioCompetenza" itemSubjectRef="textType"/>
        <property id="domandaHT" itemSubjectRef="objectType"/>
        <property id="doc_da_pubblicare" itemSubjectRef="collectionType"/>
        <property id="doc_determina" itemSubjectRef="objectType"/>
        <property id="lista_referenziati" itemSubjectRef="collectionType"/>
        <property id="verifica_dirigente" itemSubjectRef="textType"/>
        <property id="abilita_rest" itemSubjectRef="textType"/>
        <property id="registro_determina" itemSubjectRef="objectType"/>
        <property id="history" itemSubjectRef="objectType"/>
        <property id="doc_testo_determina" itemSubjectRef="objectType"/>
        <property id="gruppoDirigenteDefault" itemSubjectRef="textType"/>
        <property id="fascicolo_anticorruzione" itemSubjectRef="objectType"/>
        <property id="rif_codice_classifica" itemSubjectRef="textType"/>
        <property id="destinatari_notifica" itemSubjectRef="collectionType"/>
        <property id="allegati_doc_determina" itemSubjectRef="collectionType"/>
        <property id="gruppi_parent_proponente" itemSubjectRef="collectionType"/>
        <property id="determina_numerata" itemSubjectRef="textType"/>
        <property id="lista_registri" itemSubjectRef="collectionType"/>
        <property id="table_risposte_provvedimento" itemSubjectRef="textType"/>
        <property id="table_determina_provvedimento" itemSubjectRef="textType"/>
        <property id="note" itemSubjectRef="textType"/>
        <property id="variabile_test" itemSubjectRef="textType"/>
        <property id="instanceName" itemSubjectRef="textType"/>
        <property id="tipo_firma_registrazione" itemSubjectRef="textType"/>
        <property id="corpoNotifica" itemSubjectRef="textType"/>
        <property id="url_rest_uffici" itemSubjectRef="textType"/>
        <property id="oggetto_start" itemSubjectRef="textType"/>
        <property id="responseArray" itemSubjectRef="collectionType"/>
        <property id="provider" itemSubjectRef="textType"/>
        <property id="doc_determina_copy" itemSubjectRef="objectType"/>
        <property id="variabili_determina" itemSubjectRef="objectType"/>
        <property id="lista_domande" itemSubjectRef="collectionType"/>
        <property id="fascicolo_annullamento" itemSubjectRef="objectType"/>
        <property id="doc_visto" itemSubjectRef="objectType"/>
        <property id="systemToken" itemSubjectRef="userTokenType"/>
        <property id="nameHT" itemSubjectRef="objectType"/>
        <property id="suffisso_resp" itemSubjectRef="textType"/>
        <property id="listaCorrelati_precedenti" itemSubjectRef="collectionType"/>
        <property id="oggettoNotifica" itemSubjectRef="textType"/>
        <property id="table_provvedimento" itemSubjectRef="textType"/>
        <property id="template_determina" itemSubjectRef="objectType"/>
        <property id="descrizione" itemSubjectRef="textType"/>
        <property id="esito" itemSubjectRef="textType"/>
        <property id="figura_professionale_responsabile" itemSubjectRef="textType"/>
        <property id="note_ragioneria" itemSubjectRef="textType"/>
        <property id="figura_professionale" itemSubjectRef="textType"/>
        <property id="listaAnnessi_precedenti" itemSubjectRef="collectionType"/>
        <property id="__tmp__" itemSubjectRef="tempType"/>
        <property id="_tmpevt_" itemSubjectRef="objectType"/>
        <property id="$" itemSubjectRef="objectType"/>
        <property id="_foreachc_" itemSubjectRef="collectionType"/>
        <property id="_foreachi_" itemSubjectRef="objectType"/>

<scriptTask id="block127" scriptFormat="http://www.mvel.org/2.0" name="Gestione determina omissis come allegato" isForCompensation="false" >
    <script>
        <![CDATA[



//[auto-insert]
valori=valori_determina;

/************** start user script ***************/

java.util.HashMap doc = new java.util.HashMap();

doc.put("@structure","document");
doc.put("TIPO_COMPONENTE","ALLEGATO");
doc.put("DOCNAME","testo_determina-"+doc_testo_determina.DOCNAME);
doc.put("TYPE_ID",doc_determina.TYPE_ID);
doc.put("DOCNUM",doc_testo_determina.DOCNUM);
doc.put("STATO_BUSINESS","4");

doc_testo_determina=doc;
lista_allegati_omissis.clear();
lista_allegati_omissis.add(doc_testo_determina);

valori.put("docnumOmissis", doc_testo_determina.DOCNUM);

/**************  end user script  ***************/



//[auto-insert]
kcontext.setVariable("doc_testo_determina",null);
kcontext.setVariable("doc_testo_determina",doc_testo_determina);
kcontext.setVariable("lista_allegati_omissis",null);
kcontext.setVariable("lista_allegati_omissis",lista_allegati_omissis);
kcontext.setVariable("valori_determina",null);
kcontext.setVariable("valori_determina",valori);

        ]]>
    </script>
</scriptTask>



<sequenceFlow id="con_34455" sourceRef="block184" targetRef="block109">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<inclusiveGateway id="block130" name="gateway-branching" gatewayDirection="Diverging"></inclusiveGateway>
<inclusiveGateway id="block155" name="gateway-merge" gatewayDirection="Converging"></inclusiveGateway>
<exclusiveGateway id="block210" name="Exclusive Join (XOR)" gatewayDirection="Converging"></exclusiveGateway>

<sequenceFlow id="con_34353" sourceRef="block147" targetRef="block169">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<task id="block116" name="Aggiorna related" tns:taskName="DocerJMS" >
    <ioSpecification>

        <dataInput id="block116_TaskNameInput" name="TaskName" />
        <dataInput id="block116_GroupIdInput" name="GroupId" />
        <dataInput id="block116_Operation" name="operation" />

            <dataInput id="block116_userTokenInput" name="userToken" />
            <dataInput id="block116_relatedDocsInput" name="relatedDocs" />
            <dataInput id="block116_documentInput" name="document" />
        
            <dataOutput id="block116_deltaOutput" name="delta" />
            <dataOutput id="block116_userTokenOutput" name="userToken" />
            <dataOutput id="block116_resultsOutput" name="results" />
            <dataOutput id="block116_firstOutput" name="first" />
           

        <inputSet>
            <dataInputRefs>block116_TaskNameInput</dataInputRefs>
            <dataInputRefs>block116_GroupIdInput</dataInputRefs>
            <dataInputRefs>block116_Operation</dataInputRefs>
                <dataInputRefs>block116_userTokenInput</dataInputRefs>
                <dataInputRefs>block116_relatedDocsInput</dataInputRefs>
                <dataInputRefs>block116_documentInput</dataInputRefs>
        </inputSet>
        
        <outputSet>
                <dataOutputRefs>block116_deltaOutput</dataOutputRefs>
                <dataOutputRefs>block116_userTokenOutput</dataOutputRefs>
                <dataOutputRefs>block116_resultsOutput</dataOutputRefs>
                <dataOutputRefs>block116_firstOutput</dataOutputRefs>
                
         </outputSet>

    </ioSpecification>
                <dataInputAssociation>
                            <sourceRef>systemToken</sourceRef>
                            <targetRef>block116_userTokenInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef>lista_allegati_omissis</sourceRef>
                            <targetRef>block116_relatedDocsInput</targetRef>

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef>doc_determina</sourceRef>
                            <targetRef>block116_documentInput</targetRef>

                </dataInputAssociation>

      <dataInputAssociation>
        <targetRef>block116_GroupIdInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression"></from>
           <to xsi:type="tFormalExpression">block116_GroupIdInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>block116_TaskNameInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">Aggiorna related</from>
           <to xsi:type="tFormalExpression">block116_TaskNameInput</to>
        </assignment>
      </dataInputAssociation>
    <dataInputAssociation>
        <targetRef>block116_Operation</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression">AggiornaRelated</from>
            <to xsi:type="tFormalExpression">block116_Operation</to>
        </assignment>
    </dataInputAssociation>



            <dataOutputAssociation>
                            <sourceRef>block116_deltaOutput</sourceRef>
                            <targetRef></targetRef>
            </dataOutputAssociation>
            <dataOutputAssociation>
                            <sourceRef>block116_userTokenOutput</sourceRef>
                            <targetRef>systemToken</targetRef>
                            
            </dataOutputAssociation>
            <dataOutputAssociation>
                            <sourceRef>block116_resultsOutput</sourceRef>
                            <targetRef></targetRef>
            </dataOutputAssociation>
            <dataOutputAssociation>
                            <sourceRef>block116_firstOutput</sourceRef>
                            <targetRef>doc_determina</targetRef>
            </dataOutputAssociation>
           
      <potentialOwner>
        <resourceAssignmentExpression>
           <formalExpression></formalExpression>
        </resourceAssignmentExpression>
      </potentialOwner>
</task>

<sequenceFlow id="con_34107" sourceRef="block130" targetRef="block110">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[gestione_omissis=="si"]]>
    </conditionExpression>
</sequenceFlow>

<task id="block115" name="UpdateDocument" tns:taskName="DocerJMS" >
    <ioSpecification>

        <dataInput id="block115_TaskNameInput" name="TaskName" />
        <dataInput id="block115_GroupIdInput" name="GroupId" />
        <dataInput id="block115_Operation" name="operation" />

            <dataInput id="block115_userTokenInput" name="userToken" />
            <dataInput id="block115_mittenteInput" name="mittente" />
            <dataInput id="block115_documentInput" name="document" />
            <dataInput id="block115_destinatarioInput" name="destinatario" />
        
            <dataOutput id="block115_userTokenOutput" name="userToken" />
            <dataOutput id="block115_documentOutput" name="document" />
           

        <inputSet>
            <dataInputRefs>block115_TaskNameInput</dataInputRefs>
            <dataInputRefs>block115_GroupIdInput</dataInputRefs>
            <dataInputRefs>block115_Operation</dataInputRefs>
                <dataInputRefs>block115_userTokenInput</dataInputRefs>
                <dataInputRefs>block115_mittenteInput</dataInputRefs>
                <dataInputRefs>block115_documentInput</dataInputRefs>
                <dataInputRefs>block115_destinatarioInput</dataInputRefs>
        </inputSet>
        
        <outputSet>
                <dataOutputRefs>block115_userTokenOutput</dataOutputRefs>
                <dataOutputRefs>block115_documentOutput</dataOutputRefs>
                
         </outputSet>

    </ioSpecification>
                <dataInputAssociation>
                            <sourceRef>systemToken</sourceRef>
                            <targetRef>block115_userTokenInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef></sourceRef>
                            <targetRef>block115_mittenteInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef>doc_testo_determina</sourceRef>
                            <targetRef>block115_documentInput</targetRef>

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef></sourceRef>
                            <targetRef>block115_destinatarioInput</targetRef>
                            

                </dataInputAssociation>

      <dataInputAssociation>
        <targetRef>block115_GroupIdInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression"></from>
           <to xsi:type="tFormalExpression">block115_GroupIdInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>block115_TaskNameInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">UpdateDocument</from>
           <to xsi:type="tFormalExpression">block115_TaskNameInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>block115_Operation</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">AggiornaDocumento</from>
           <to xsi:type="tFormalExpression">block115_Operation</to>
        </assignment>
      </dataInputAssociation>


            <dataOutputAssociation>
                            <sourceRef>block115_userTokenOutput</sourceRef>
                            <targetRef>systemToken</targetRef>
                            
            </dataOutputAssociation>
            <dataOutputAssociation>
                            <sourceRef>block115_documentOutput</sourceRef>
                            <targetRef>doc_testo_determina</targetRef>
            </dataOutputAssociation>
           
      <potentialOwner>
        <resourceAssignmentExpression>
           <formalExpression></formalExpression>
        </resourceAssignmentExpression>
      </potentialOwner>
</task>


<callActivity id="block141" isForCompensation="false" independent="false" waitForCompletion="true" name="Invio notifica esecutivita'" calledElementByName="Invio messaggio senza allegati1.0" >
<!-- ioSpecification -->
<ioSpecification>
    <dataInput id="block141_messaggioInput" name="messaggio" />
    <dataInput id="block141_mittenteInput" name="mittente" />
    <dataInput id="block141_instanceNameInput" name="instanceName" />
    <dataInput id="block141_systemTokenInput" name="systemToken" />
    <dataInput id="block141_oggettoInput" name="oggetto" />
    <dataInput id="block141_humanTokenInput" name="humanToken" />
    <dataInput id="block141_destinatarioInput" name="destinatario" />
    <dataInput id="block141_canaleMAILInput" name="canaleMAIL" />
    <dataInput id="block141_descrizioneInput" name="descrizione" />
    <dataInput id="block141_instanceIdInput" name="instanceId" />
    <dataInput id="block141___ckValueInput" name="__ckValue" />
    <dataInput id="block141_canalePECInput" name="canalePEC" />
    <dataInput id="block141_canaleJMSInput" name="canaleJMS" />
    <dataInput id="block141_outcomeInput" name="outcome" />
    <dataInput id="block141_nameInput" name="name" />
    <dataInput id="block141_descriptionInput" name="description" />
    <dataInput id="block141_waitForCompletionInput" name="waitForCompletion" />
    <dataInput id="block141_processNameInput" name="processName" />

    <inputSet>
        <dataInputRefs>block141_messaggioInput</dataInputRefs>
        <dataInputRefs>block141_mittenteInput</dataInputRefs>
        <dataInputRefs>block141_instanceNameInput</dataInputRefs>
        <dataInputRefs>block141_systemTokenInput</dataInputRefs>
        <dataInputRefs>block141_oggettoInput</dataInputRefs>
        <dataInputRefs>block141_humanTokenInput</dataInputRefs>
        <dataInputRefs>block141_destinatarioInput</dataInputRefs>
        <dataInputRefs>block141_canaleMAILInput</dataInputRefs>
        <dataInputRefs>block141_descrizioneInput</dataInputRefs>
        <dataInputRefs>block141_instanceIdInput</dataInputRefs>
        <dataInputRefs>block141___ckValueInput</dataInputRefs>
        <dataInputRefs>block141_canalePECInput</dataInputRefs>
        <dataInputRefs>block141_canaleJMSInput</dataInputRefs>
        <dataInputRefs>block141_outcomeInput</dataInputRefs>
        <dataInputRefs>block141_nameInput</dataInputRefs>
        <dataInputRefs>block141_descriptionInput</dataInputRefs>
        <dataInputRefs>block141_waitForCompletionInput</dataInputRefs>
        <dataInputRefs>block141_processNameInput</dataInputRefs>
    </inputSet>

    <outputSet>
    </outputSet>
</ioSpecification>

<!-- lista inputs -->
<dataInputAssociation><!-- k:messaggio var type: textRef -->
        <sourceRef><![CDATA[corpoNotifica]]></sourceRef>
        <targetRef>block141_messaggioInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:mittente var type: soggetto -->
        <sourceRef><![CDATA[mittente]]></sourceRef>
        <targetRef>block141_mittenteInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:instanceName var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block141_instanceNameInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:systemToken var type: userToken -->
        <sourceRef><![CDATA[systemToken]]></sourceRef>
        <targetRef>block141_systemTokenInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:oggetto var type: textRef -->
        <sourceRef><![CDATA[oggettoNotifica]]></sourceRef>
        <targetRef>block141_oggettoInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:humanToken var type: userToken -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block141_humanTokenInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:destinatario var type: soggetto -->
        <sourceRef><![CDATA[destinatario]]></sourceRef>
        <targetRef>block141_destinatarioInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:canaleMAIL var type: channel -->
        <targetRef>block141_canaleMAILInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[]]></from>
            <to xsi:type="tFormalExpression">block141_canaleMAILInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- k:descrizione var type: script -->
        <sourceRef><![CDATA["Invio notifica esecutivita'";]]></sourceRef>
        <targetRef>block141_descrizioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:instanceId var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block141_instanceIdInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:__ckValue var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block141___ckValueInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:canalePEC var type: channel -->
        <targetRef>block141_canalePECInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[]]></from>
            <to xsi:type="tFormalExpression">block141_canalePECInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- k:canaleJMS var type: channel -->
        <targetRef>block141_canaleJMSInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[]]></from>
            <to xsi:type="tFormalExpression">block141_canaleJMSInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- k:outcome var type: object -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block141_outcomeInput</targetRef>
</dataInputAssociation>

<!-- lista props -->
<dataInputAssociation><!-- var type: string -->
        <targetRef>block141_nameInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[Invio notifica esecutivita']]></from>
            <to xsi:type="tFormalExpression">block141_nameInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: string -->
        <targetRef>block141_descriptionInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[note]]></from>
            <to xsi:type="tFormalExpression">block141_descriptionInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: bool -->
        <targetRef>block141_waitForCompletionInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[true]]></from>
            <to xsi:type="tFormalExpression">block141_waitForCompletionInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: string -->
        <targetRef>block141_processNameInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[Invio messaggio senza allegati1.0]]></from>
            <to xsi:type="tFormalExpression">block141_processNameInput</to>
        </assignment>
</dataInputAssociation>

<!-- lista outputs -->
    
</callActivity>




<inclusiveGateway id="block144" name="gateway-branching" gatewayDirection="Diverging"></inclusiveGateway>
<sequenceFlow id="con_34179" sourceRef="block141" targetRef="block143">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>


<callActivity id="block125" isForCompensation="false" independent="false" waitForCompletion="true" name="AMD Redazione omissis determina" calledElementByName="AMD_RedazioneUD_Base1.0" >
<!-- ioSpecification -->
<ioSpecification>
    <dataInput id="block125_instanceNameInput" name="instanceName" />
    <dataInput id="block125_tipologiePrincipaleInput" name="tipologiePrincipale" />
    <dataInput id="block125_tipologieAnnotazioniInput" name="tipologieAnnotazioni" />
    <dataInput id="block125_humanTokenInput" name="humanToken" />
    <dataInput id="block125_variabili_template_correlatiInput" name="variabili_template_correlati" />
    <dataInput id="block125_instanceIdInput" name="instanceId" />
    <dataInput id="block125_template_annotazioniInput" name="template_annotazioni" />
    <dataInput id="block125_template_allegatiInput" name="template_allegati" />
    <dataInput id="block125_metadati_annessoInput" name="metadati_annesso" />
    <dataInput id="block125_modificaInput" name="modifica" />
    <dataInput id="block125_outcomeInput" name="outcome" />
    <dataInput id="block125_mittenteInput" name="mittente" />
    <dataInput id="block125_systemTokenInput" name="systemToken" />
    <dataInput id="block125_template_annessiInput" name="template_annessi" />
    <dataInput id="block125_creazioneInput" name="creazione" />
    <dataInput id="block125_descrizioneInput" name="descrizione" />
    <dataInput id="block125_metadati_annotazioneInput" name="metadati_annotazione" />
    <dataInput id="block125_metadati_allegatoInput" name="metadati_allegato" />
    <dataInput id="block125_tipologieAnnessoInput" name="tipologieAnnesso" />
    <dataInput id="block125_template_principaleInput" name="template_principale" />
    <dataInput id="block125_canalePECInput" name="canalePEC" />
    <dataInput id="block125_tipologieAllegatoInput" name="tipologieAllegato" />
    <dataInput id="block125_variabili_template_principaleInput" name="variabili_template_principale" />
    <dataInput id="block125_docnum_principaleInput" name="docnum_principale" />
    <dataInput id="block125_figura_professionaleInput" name="figura_professionale" />
    <dataInput id="block125_userInput" name="user" />
    <dataInput id="block125_metadati_principaleInput" name="metadati_principale" />
    <dataInput id="block125_nameInput" name="name" />
    <dataInput id="block125_descriptionInput" name="description" />
    <dataInput id="block125_waitForCompletionInput" name="waitForCompletion" />
    <dataInput id="block125_processNameInput" name="processName" />
    <dataOutput id="block125_principaleOutput" name="principale" />

    <inputSet>
        <dataInputRefs>block125_instanceNameInput</dataInputRefs>
        <dataInputRefs>block125_tipologiePrincipaleInput</dataInputRefs>
        <dataInputRefs>block125_tipologieAnnotazioniInput</dataInputRefs>
        <dataInputRefs>block125_humanTokenInput</dataInputRefs>
        <dataInputRefs>block125_variabili_template_correlatiInput</dataInputRefs>
        <dataInputRefs>block125_instanceIdInput</dataInputRefs>
        <dataInputRefs>block125_template_annotazioniInput</dataInputRefs>
        <dataInputRefs>block125_template_allegatiInput</dataInputRefs>
        <dataInputRefs>block125_metadati_annessoInput</dataInputRefs>
        <dataInputRefs>block125_modificaInput</dataInputRefs>
        <dataInputRefs>block125_outcomeInput</dataInputRefs>
        <dataInputRefs>block125_mittenteInput</dataInputRefs>
        <dataInputRefs>block125_systemTokenInput</dataInputRefs>
        <dataInputRefs>block125_template_annessiInput</dataInputRefs>
        <dataInputRefs>block125_creazioneInput</dataInputRefs>
        <dataInputRefs>block125_descrizioneInput</dataInputRefs>
        <dataInputRefs>block125_metadati_annotazioneInput</dataInputRefs>
        <dataInputRefs>block125_metadati_allegatoInput</dataInputRefs>
        <dataInputRefs>block125_tipologieAnnessoInput</dataInputRefs>
        <dataInputRefs>block125_template_principaleInput</dataInputRefs>
        <dataInputRefs>block125_canalePECInput</dataInputRefs>
        <dataInputRefs>block125_tipologieAllegatoInput</dataInputRefs>
        <dataInputRefs>block125_variabili_template_principaleInput</dataInputRefs>
        <dataInputRefs>block125_docnum_principaleInput</dataInputRefs>
        <dataInputRefs>block125_figura_professionaleInput</dataInputRefs>
        <dataInputRefs>block125_userInput</dataInputRefs>
        <dataInputRefs>block125_metadati_principaleInput</dataInputRefs>
        <dataInputRefs>block125_nameInput</dataInputRefs>
        <dataInputRefs>block125_descriptionInput</dataInputRefs>
        <dataInputRefs>block125_waitForCompletionInput</dataInputRefs>
        <dataInputRefs>block125_processNameInput</dataInputRefs>
    </inputSet>

    <outputSet>
        <dataOutputRefs>block125_principaleOutput</dataOutputRefs>
    </outputSet>
</ioSpecification>

<!-- lista inputs -->
<dataInputAssociation><!-- k:instanceName var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block125_instanceNameInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:tipologiePrincipale var type: textRef -->
        <sourceRef><![CDATA[tipologiePrincipale]]></sourceRef>
        <targetRef>block125_tipologiePrincipaleInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:tipologieAnnotazioni var type: textRef -->
        <sourceRef><![CDATA[tipologieAnnotazione]]></sourceRef>
        <targetRef>block125_tipologieAnnotazioniInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:humanToken var type: userToken -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block125_humanTokenInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:variabili_template_correlati var type: object -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block125_variabili_template_correlatiInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:instanceId var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block125_instanceIdInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:template_annotazioni var type: document -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block125_template_annotazioniInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:template_allegati var type: document -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block125_template_allegatiInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:metadati_annesso var type: object -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block125_metadati_annessoInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:modifica var type: script -->
        <sourceRef><![CDATA["no";]]></sourceRef>
        <targetRef>block125_modificaInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:outcome var type: object -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block125_outcomeInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:mittente var type: soggetto -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block125_mittenteInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:systemToken var type: userToken -->
        <sourceRef><![CDATA[systemToken]]></sourceRef>
        <targetRef>block125_systemTokenInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:template_annessi var type: document -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block125_template_annessiInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:creazione var type: script -->
        <sourceRef><![CDATA["template";]]></sourceRef>
        <targetRef>block125_creazioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:descrizione var type: script -->
        <sourceRef><![CDATA["AMD Redazione documento omissis";]]></sourceRef>
        <targetRef>block125_descrizioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:metadati_annotazione var type: object -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block125_metadati_annotazioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:metadati_allegato var type: object -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block125_metadati_allegatoInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:tipologieAnnesso var type: textRef -->
        <sourceRef><![CDATA[tipologieAnnesso]]></sourceRef>
        <targetRef>block125_tipologieAnnessoInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:template_principale var type: document -->
        <sourceRef><![CDATA[template_determina]]></sourceRef>
        <targetRef>block125_template_principaleInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:canalePEC var type: channel -->
        <targetRef>block125_canalePECInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[]]></from>
            <to xsi:type="tFormalExpression">block125_canalePECInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- k:tipologieAllegato var type: textRef -->
        <sourceRef><![CDATA[tipologieAllegato]]></sourceRef>
        <targetRef>block125_tipologieAllegatoInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:variabili_template_principale var type: object -->
        <sourceRef><![CDATA[variabili_determina_omissis]]></sourceRef>
        <targetRef>block125_variabili_template_principaleInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:docnum_principale var type: script -->
        <sourceRef><![CDATA["";]]></sourceRef>
        <targetRef>block125_docnum_principaleInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:figura_professionale var type: textRef -->
        <sourceRef><![CDATA[figura_professionale2]]></sourceRef>
        <targetRef>block125_figura_professionaleInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:user var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block125_userInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:metadati_principale var type: object -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block125_metadati_principaleInput</targetRef>
</dataInputAssociation>

<!-- lista props -->
<dataInputAssociation><!-- var type: string -->
        <targetRef>block125_nameInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[AMD Redazione omissis determina]]></from>
            <to xsi:type="tFormalExpression">block125_nameInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: string -->
        <targetRef>block125_descriptionInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[note]]></from>
            <to xsi:type="tFormalExpression">block125_descriptionInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: bool -->
        <targetRef>block125_waitForCompletionInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[true]]></from>
            <to xsi:type="tFormalExpression">block125_waitForCompletionInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: string -->
        <targetRef>block125_processNameInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[AMD_RedazioneUD_Base1.0]]></from>
            <to xsi:type="tFormalExpression">block125_processNameInput</to>
        </assignment>
</dataInputAssociation>

<!-- lista outputs -->
<dataOutputAssociation>
        <sourceRef>block125_principaleOutput</sourceRef>
        <targetRef>doc_testo_determina</targetRef>
</dataOutputAssociation>
    
</callActivity>




<sequenceFlow id="con_34545" sourceRef="block188" targetRef="block193">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<inclusiveGateway id="block24" name="gateway-branching" gatewayDirection="Diverging"></inclusiveGateway>

<callActivity id="block97" isForCompensation="false" independent="false" waitForCompletion="true" name="AMD Registrazione - Protocollazione determina" calledElementByName="AMD_RegistrazioneInternaUD1.0" >
<!-- ioSpecification -->
<ioSpecification>
    <dataInput id="block97_fascicoloPrimarioInput" name="fascicoloPrimario" />
    <dataInput id="block97_tipo_firmaInput" name="tipo_firma" />
    <dataInput id="block97_proto_autoInput" name="proto_auto" />
    <dataInput id="block97_instanceNameInput" name="instanceName" />
    <dataInput id="block97_destinatari_registrazioneInput" name="destinatari_registrazione" />
    <dataInput id="block97_tipo_firma_registrazioneInput" name="tipo_firma_registrazione" />
    <dataInput id="block97_humanTokenInput" name="humanToken" />
    <dataInput id="block97_fascicolazioneInput" name="fascicolazione" />
    <dataInput id="block97_instanceIdInput" name="instanceId" />
    <dataInput id="block97_oggetto_registroInput" name="oggetto_registro" />
    <dataInput id="block97_destinatariInput" name="destinatari" />
    <dataInput id="block97_testo_attivitaInput" name="testo_attivita" />
    <dataInput id="block97_outcomeInput" name="outcome" />
    <dataInput id="block97_oggetto_protocolloInput" name="oggetto_protocollo" />
    <dataInput id="block97_registrazioneInput" name="registrazione" />
    <dataInput id="block97_fascicoliSecondariInput" name="fascicoliSecondari" />
    <dataInput id="block97_systemTokenInput" name="systemToken" />
    <dataInput id="block97_mittentiInput" name="mittenti" />
    <dataInput id="block97_firmatari_registrazioneInput" name="firmatari_registrazione" />
    <dataInput id="block97_assegnazione_registroInput" name="assegnazione_registro" />
    <dataInput id="block97_descrizioneInput" name="descrizione" />
    <dataInput id="block97_firmatariInput" name="firmatari" />
    <dataInput id="block97_protocollazioneInput" name="protocollazione" />
    <dataInput id="block97_fascicolo_fissoInput" name="fascicolo_fisso" />
    <dataInput id="block97_canalePECInput" name="canalePEC" />
    <dataInput id="block97_mittenti_registrazioneInput" name="mittenti_registrazione" />
    <dataInput id="block97_lista_registriInput" name="lista_registri" />
    <dataInput id="block97_docnum_principaleInput" name="docnum_principale" />
    <dataInput id="block97_figura_professionaleInput" name="figura_professionale" />
    <dataInput id="block97_reg_autoInput" name="reg_auto" />
    <dataInput id="block97_assegnazioneInput" name="assegnazione" />
    <dataInput id="block97_nameInput" name="name" />
    <dataInput id="block97_descriptionInput" name="description" />
    <dataInput id="block97_waitForCompletionInput" name="waitForCompletion" />
    <dataInput id="block97_processNameInput" name="processName" />
    <dataOutput id="block97_principaleOutput" name="principale" />

    <inputSet>
        <dataInputRefs>block97_fascicoloPrimarioInput</dataInputRefs>
        <dataInputRefs>block97_tipo_firmaInput</dataInputRefs>
        <dataInputRefs>block97_proto_autoInput</dataInputRefs>
        <dataInputRefs>block97_instanceNameInput</dataInputRefs>
        <dataInputRefs>block97_destinatari_registrazioneInput</dataInputRefs>
        <dataInputRefs>block97_tipo_firma_registrazioneInput</dataInputRefs>
        <dataInputRefs>block97_humanTokenInput</dataInputRefs>
        <dataInputRefs>block97_fascicolazioneInput</dataInputRefs>
        <dataInputRefs>block97_instanceIdInput</dataInputRefs>
        <dataInputRefs>block97_oggetto_registroInput</dataInputRefs>
        <dataInputRefs>block97_destinatariInput</dataInputRefs>
        <dataInputRefs>block97_testo_attivitaInput</dataInputRefs>
        <dataInputRefs>block97_outcomeInput</dataInputRefs>
        <dataInputRefs>block97_oggetto_protocolloInput</dataInputRefs>
        <dataInputRefs>block97_registrazioneInput</dataInputRefs>
        <dataInputRefs>block97_fascicoliSecondariInput</dataInputRefs>
        <dataInputRefs>block97_systemTokenInput</dataInputRefs>
        <dataInputRefs>block97_mittentiInput</dataInputRefs>
        <dataInputRefs>block97_firmatari_registrazioneInput</dataInputRefs>
        <dataInputRefs>block97_assegnazione_registroInput</dataInputRefs>
        <dataInputRefs>block97_descrizioneInput</dataInputRefs>
        <dataInputRefs>block97_firmatariInput</dataInputRefs>
        <dataInputRefs>block97_protocollazioneInput</dataInputRefs>
        <dataInputRefs>block97_fascicolo_fissoInput</dataInputRefs>
        <dataInputRefs>block97_canalePECInput</dataInputRefs>
        <dataInputRefs>block97_mittenti_registrazioneInput</dataInputRefs>
        <dataInputRefs>block97_lista_registriInput</dataInputRefs>
        <dataInputRefs>block97_docnum_principaleInput</dataInputRefs>
        <dataInputRefs>block97_figura_professionaleInput</dataInputRefs>
        <dataInputRefs>block97_reg_autoInput</dataInputRefs>
        <dataInputRefs>block97_assegnazioneInput</dataInputRefs>
        <dataInputRefs>block97_nameInput</dataInputRefs>
        <dataInputRefs>block97_descriptionInput</dataInputRefs>
        <dataInputRefs>block97_waitForCompletionInput</dataInputRefs>
        <dataInputRefs>block97_processNameInput</dataInputRefs>
    </inputSet>

    <outputSet>
        <dataOutputRefs>block97_principaleOutput</dataOutputRefs>
    </outputSet>
</ioSpecification>

<!-- lista inputs -->
<dataInputAssociation><!-- k:fascicoloPrimario var type: fascicolo -->
        <sourceRef><![CDATA[fascicolo_determina]]></sourceRef>
        <targetRef>block97_fascicoloPrimarioInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:tipo_firma var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block97_tipo_firmaInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:proto_auto var type: script -->
        <sourceRef><![CDATA["si";]]></sourceRef>
        <targetRef>block97_proto_autoInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:instanceName var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block97_instanceNameInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:destinatari_registrazione var type: soggetto -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block97_destinatari_registrazioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:tipo_firma_registrazione var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block97_tipo_firma_registrazioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:humanToken var type: userToken -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block97_humanTokenInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:fascicolazione var type: script -->
        <sourceRef><![CDATA["si";]]></sourceRef>
        <targetRef>block97_fascicolazioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:instanceId var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block97_instanceIdInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:oggetto_registro var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block97_oggetto_registroInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:destinatari var type: soggetto -->
        <sourceRef><![CDATA[destinatari_registrazione]]></sourceRef>
        <targetRef>block97_destinatariInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:testo_attivita var type: script -->
        <sourceRef><![CDATA["Determina";]]></sourceRef>
        <targetRef>block97_testo_attivitaInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:outcome var type: object -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block97_outcomeInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:oggetto_protocollo var type: script -->
        <sourceRef><![CDATA[org.apache.commons.lang.StringEscapeUtils.escapeHtml(variabili_determina.Intoggetto);]]></sourceRef>
        <targetRef>block97_oggetto_protocolloInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:registrazione var type: script -->
        <sourceRef><![CDATA["no";]]></sourceRef>
        <targetRef>block97_registrazioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:fascicoliSecondari var type: tempRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block97_fascicoliSecondariInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:systemToken var type: userToken -->
        <sourceRef><![CDATA[systemToken]]></sourceRef>
        <targetRef>block97_systemTokenInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:mittenti var type: soggetto -->
        <sourceRef><![CDATA[mittenti_registrazione]]></sourceRef>
        <targetRef>block97_mittentiInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:firmatari_registrazione var type: soggetto -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block97_firmatari_registrazioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:assegnazione_registro var type: object -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block97_assegnazione_registroInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:descrizione var type: script -->
        <sourceRef><![CDATA["AMD Registrazione interna determina";]]></sourceRef>
        <targetRef>block97_descrizioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:firmatari var type: soggetto -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block97_firmatariInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:protocollazione var type: script -->
        <sourceRef><![CDATA["si";]]></sourceRef>
        <targetRef>block97_protocollazioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:fascicolo_fisso var type: script -->
        <sourceRef><![CDATA["si";]]></sourceRef>
        <targetRef>block97_fascicolo_fissoInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:canalePEC var type: channel -->
        <targetRef>block97_canalePECInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[]]></from>
            <to xsi:type="tFormalExpression">block97_canalePECInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- k:mittenti_registrazione var type: soggetto -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block97_mittenti_registrazioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:lista_registri var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block97_lista_registriInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:docnum_principale var type: script -->
        <sourceRef><![CDATA[doc_determina.DOCNUM;]]></sourceRef>
        <targetRef>block97_docnum_principaleInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:figura_professionale var type: textRef -->
        <sourceRef><![CDATA[figura_professionale2]]></sourceRef>
        <targetRef>block97_figura_professionaleInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:reg_auto var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block97_reg_autoInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:assegnazione var type: object -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block97_assegnazioneInput</targetRef>
</dataInputAssociation>

<!-- lista props -->
<dataInputAssociation><!-- var type: string -->
        <targetRef>block97_nameInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[AMD Registrazione - Protocollazione determina]]></from>
            <to xsi:type="tFormalExpression">block97_nameInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: string -->
        <targetRef>block97_descriptionInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[note]]></from>
            <to xsi:type="tFormalExpression">block97_descriptionInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: bool -->
        <targetRef>block97_waitForCompletionInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[true]]></from>
            <to xsi:type="tFormalExpression">block97_waitForCompletionInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: string -->
        <targetRef>block97_processNameInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[AMD_RegistrazioneInternaUD1.0]]></from>
            <to xsi:type="tFormalExpression">block97_processNameInput</to>
        </assignment>
</dataInputAssociation>

<!-- lista outputs -->
<dataOutputAssociation>
        <sourceRef>block97_principaleOutput</sourceRef>
        <targetRef>doc_determina</targetRef>
</dataOutputAssociation>
    
</callActivity>




<task id="block129" name="Aggiorna related" tns:taskName="DocerJMS" >
    <ioSpecification>

        <dataInput id="block129_TaskNameInput" name="TaskName" />
        <dataInput id="block129_GroupIdInput" name="GroupId" />
        <dataInput id="block129_Operation" name="operation" />

            <dataInput id="block129_userTokenInput" name="userToken" />
            <dataInput id="block129_relatedDocsInput" name="relatedDocs" />
            <dataInput id="block129_documentInput" name="document" />
        
            <dataOutput id="block129_deltaOutput" name="delta" />
            <dataOutput id="block129_userTokenOutput" name="userToken" />
            <dataOutput id="block129_resultsOutput" name="results" />
            <dataOutput id="block129_firstOutput" name="first" />
           

        <inputSet>
            <dataInputRefs>block129_TaskNameInput</dataInputRefs>
            <dataInputRefs>block129_GroupIdInput</dataInputRefs>
            <dataInputRefs>block129_Operation</dataInputRefs>
                <dataInputRefs>block129_userTokenInput</dataInputRefs>
                <dataInputRefs>block129_relatedDocsInput</dataInputRefs>
                <dataInputRefs>block129_documentInput</dataInputRefs>
        </inputSet>
        
        <outputSet>
                <dataOutputRefs>block129_deltaOutput</dataOutputRefs>
                <dataOutputRefs>block129_userTokenOutput</dataOutputRefs>
                <dataOutputRefs>block129_resultsOutput</dataOutputRefs>
                <dataOutputRefs>block129_firstOutput</dataOutputRefs>
                
         </outputSet>

    </ioSpecification>
                <dataInputAssociation>
                            <sourceRef>systemToken</sourceRef>
                            <targetRef>block129_userTokenInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef>lista_allegati_omissis</sourceRef>
                            <targetRef>block129_relatedDocsInput</targetRef>

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef>doc_determina</sourceRef>
                            <targetRef>block129_documentInput</targetRef>

                </dataInputAssociation>

      <dataInputAssociation>
        <targetRef>block129_GroupIdInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression"></from>
           <to xsi:type="tFormalExpression">block129_GroupIdInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>block129_TaskNameInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">Aggiorna related</from>
           <to xsi:type="tFormalExpression">block129_TaskNameInput</to>
        </assignment>
      </dataInputAssociation>
    <dataInputAssociation>
        <targetRef>block129_Operation</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression">AggiornaRelated</from>
            <to xsi:type="tFormalExpression">block129_Operation</to>
        </assignment>
    </dataInputAssociation>



            <dataOutputAssociation>
                            <sourceRef>block129_deltaOutput</sourceRef>
                            <targetRef></targetRef>
            </dataOutputAssociation>
            <dataOutputAssociation>
                            <sourceRef>block129_userTokenOutput</sourceRef>
                            <targetRef>systemToken</targetRef>
                            
            </dataOutputAssociation>
            <dataOutputAssociation>
                            <sourceRef>block129_resultsOutput</sourceRef>
                            <targetRef></targetRef>
            </dataOutputAssociation>
            <dataOutputAssociation>
                            <sourceRef>block129_firstOutput</sourceRef>
                            <targetRef>doc_determina</targetRef>
            </dataOutputAssociation>
           
      <potentialOwner>
        <resourceAssignmentExpression>
           <formalExpression></formalExpression>
        </resourceAssignmentExpression>
      </potentialOwner>
</task>

<sequenceFlow id="con_33999" sourceRef="block113" targetRef="block114">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34119" sourceRef="block123" targetRef="block133">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<scriptTask id="block67" scriptFormat="http://www.mvel.org/2.0" name="Script-task set determina numerata" isForCompensation="false" >
    <script>
        <![CDATA[



/************** start user script ***************/

determina_numerata="si";

/**************  end user script  ***************/



//[auto-insert]
kcontext.setVariable("determina_numerata",null);
kcontext.setVariable("determina_numerata",determina_numerata);

        ]]>
    </script>
</scriptTask>




<callActivity id="block99" isForCompensation="false" independent="false" waitForCompletion="true" name="AMD Registrazione interna - Protocollazione determina " calledElementByName="AMD_RegistrazioneInternaUD1.0" >
<!-- ioSpecification -->
<ioSpecification>
    <dataInput id="block99_fascicoloPrimarioInput" name="fascicoloPrimario" />
    <dataInput id="block99_tipo_firmaInput" name="tipo_firma" />
    <dataInput id="block99_proto_autoInput" name="proto_auto" />
    <dataInput id="block99_instanceNameInput" name="instanceName" />
    <dataInput id="block99_destinatari_registrazioneInput" name="destinatari_registrazione" />
    <dataInput id="block99_tipo_firma_registrazioneInput" name="tipo_firma_registrazione" />
    <dataInput id="block99_humanTokenInput" name="humanToken" />
    <dataInput id="block99_fascicolazioneInput" name="fascicolazione" />
    <dataInput id="block99_instanceIdInput" name="instanceId" />
    <dataInput id="block99_oggetto_registroInput" name="oggetto_registro" />
    <dataInput id="block99_destinatariInput" name="destinatari" />
    <dataInput id="block99_testo_attivitaInput" name="testo_attivita" />
    <dataInput id="block99_outcomeInput" name="outcome" />
    <dataInput id="block99_oggetto_protocolloInput" name="oggetto_protocollo" />
    <dataInput id="block99_registrazioneInput" name="registrazione" />
    <dataInput id="block99_fascicoliSecondariInput" name="fascicoliSecondari" />
    <dataInput id="block99_systemTokenInput" name="systemToken" />
    <dataInput id="block99_mittentiInput" name="mittenti" />
    <dataInput id="block99_firmatari_registrazioneInput" name="firmatari_registrazione" />
    <dataInput id="block99_assegnazione_registroInput" name="assegnazione_registro" />
    <dataInput id="block99_descrizioneInput" name="descrizione" />
    <dataInput id="block99_firmatariInput" name="firmatari" />
    <dataInput id="block99_protocollazioneInput" name="protocollazione" />
    <dataInput id="block99_fascicolo_fissoInput" name="fascicolo_fisso" />
    <dataInput id="block99_canalePECInput" name="canalePEC" />
    <dataInput id="block99_mittenti_registrazioneInput" name="mittenti_registrazione" />
    <dataInput id="block99_lista_registriInput" name="lista_registri" />
    <dataInput id="block99_docnum_principaleInput" name="docnum_principale" />
    <dataInput id="block99_figura_professionaleInput" name="figura_professionale" />
    <dataInput id="block99_reg_autoInput" name="reg_auto" />
    <dataInput id="block99_assegnazioneInput" name="assegnazione" />
    <dataInput id="block99_nameInput" name="name" />
    <dataInput id="block99_descriptionInput" name="description" />
    <dataInput id="block99_waitForCompletionInput" name="waitForCompletion" />
    <dataInput id="block99_processNameInput" name="processName" />
    <dataOutput id="block99_principaleOutput" name="principale" />

    <inputSet>
        <dataInputRefs>block99_fascicoloPrimarioInput</dataInputRefs>
        <dataInputRefs>block99_tipo_firmaInput</dataInputRefs>
        <dataInputRefs>block99_proto_autoInput</dataInputRefs>
        <dataInputRefs>block99_instanceNameInput</dataInputRefs>
        <dataInputRefs>block99_destinatari_registrazioneInput</dataInputRefs>
        <dataInputRefs>block99_tipo_firma_registrazioneInput</dataInputRefs>
        <dataInputRefs>block99_humanTokenInput</dataInputRefs>
        <dataInputRefs>block99_fascicolazioneInput</dataInputRefs>
        <dataInputRefs>block99_instanceIdInput</dataInputRefs>
        <dataInputRefs>block99_oggetto_registroInput</dataInputRefs>
        <dataInputRefs>block99_destinatariInput</dataInputRefs>
        <dataInputRefs>block99_testo_attivitaInput</dataInputRefs>
        <dataInputRefs>block99_outcomeInput</dataInputRefs>
        <dataInputRefs>block99_oggetto_protocolloInput</dataInputRefs>
        <dataInputRefs>block99_registrazioneInput</dataInputRefs>
        <dataInputRefs>block99_fascicoliSecondariInput</dataInputRefs>
        <dataInputRefs>block99_systemTokenInput</dataInputRefs>
        <dataInputRefs>block99_mittentiInput</dataInputRefs>
        <dataInputRefs>block99_firmatari_registrazioneInput</dataInputRefs>
        <dataInputRefs>block99_assegnazione_registroInput</dataInputRefs>
        <dataInputRefs>block99_descrizioneInput</dataInputRefs>
        <dataInputRefs>block99_firmatariInput</dataInputRefs>
        <dataInputRefs>block99_protocollazioneInput</dataInputRefs>
        <dataInputRefs>block99_fascicolo_fissoInput</dataInputRefs>
        <dataInputRefs>block99_canalePECInput</dataInputRefs>
        <dataInputRefs>block99_mittenti_registrazioneInput</dataInputRefs>
        <dataInputRefs>block99_lista_registriInput</dataInputRefs>
        <dataInputRefs>block99_docnum_principaleInput</dataInputRefs>
        <dataInputRefs>block99_figura_professionaleInput</dataInputRefs>
        <dataInputRefs>block99_reg_autoInput</dataInputRefs>
        <dataInputRefs>block99_assegnazioneInput</dataInputRefs>
        <dataInputRefs>block99_nameInput</dataInputRefs>
        <dataInputRefs>block99_descriptionInput</dataInputRefs>
        <dataInputRefs>block99_waitForCompletionInput</dataInputRefs>
        <dataInputRefs>block99_processNameInput</dataInputRefs>
    </inputSet>

    <outputSet>
        <dataOutputRefs>block99_principaleOutput</dataOutputRefs>
    </outputSet>
</ioSpecification>

<!-- lista inputs -->
<dataInputAssociation><!-- k:fascicoloPrimario var type: fascicolo -->
        <sourceRef><![CDATA[fascicolo_annullamento]]></sourceRef>
        <targetRef>block99_fascicoloPrimarioInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:tipo_firma var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block99_tipo_firmaInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:proto_auto var type: script -->
        <sourceRef><![CDATA["si";]]></sourceRef>
        <targetRef>block99_proto_autoInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:instanceName var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block99_instanceNameInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:destinatari_registrazione var type: soggetto -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block99_destinatari_registrazioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:tipo_firma_registrazione var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block99_tipo_firma_registrazioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:humanToken var type: userToken -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block99_humanTokenInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:fascicolazione var type: script -->
        <sourceRef><![CDATA["si";]]></sourceRef>
        <targetRef>block99_fascicolazioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:instanceId var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block99_instanceIdInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:oggetto_registro var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block99_oggetto_registroInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:destinatari var type: soggetto -->
        <sourceRef><![CDATA[destinatari_registrazione]]></sourceRef>
        <targetRef>block99_destinatariInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:testo_attivita var type: script -->
        <sourceRef><![CDATA["Determina";]]></sourceRef>
        <targetRef>block99_testo_attivitaInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:outcome var type: object -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block99_outcomeInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:oggetto_protocollo var type: script -->
        <sourceRef><![CDATA["ANNULLATA_determina:"+org.apache.commons.lang.StringEscapeUtils.escapeHtml(variabili_determina.Intoggetto);]]></sourceRef>
        <targetRef>block99_oggetto_protocolloInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:registrazione var type: script -->
        <sourceRef><![CDATA["no";]]></sourceRef>
        <targetRef>block99_registrazioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:fascicoliSecondari var type: fascicolo -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block99_fascicoliSecondariInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:systemToken var type: userToken -->
        <sourceRef><![CDATA[systemToken]]></sourceRef>
        <targetRef>block99_systemTokenInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:mittenti var type: soggetto -->
        <sourceRef><![CDATA[mittenti_registrazione]]></sourceRef>
        <targetRef>block99_mittentiInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:firmatari_registrazione var type: soggetto -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block99_firmatari_registrazioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:assegnazione_registro var type: object -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block99_assegnazione_registroInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:descrizione var type: script -->
        <sourceRef><![CDATA["AMD Registrazione interna determina";]]></sourceRef>
        <targetRef>block99_descrizioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:firmatari var type: soggetto -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block99_firmatariInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:protocollazione var type: script -->
        <sourceRef><![CDATA["si";]]></sourceRef>
        <targetRef>block99_protocollazioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:fascicolo_fisso var type: script -->
        <sourceRef><![CDATA["si";]]></sourceRef>
        <targetRef>block99_fascicolo_fissoInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:canalePEC var type: channel -->
        <targetRef>block99_canalePECInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[]]></from>
            <to xsi:type="tFormalExpression">block99_canalePECInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- k:mittenti_registrazione var type: soggetto -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block99_mittenti_registrazioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:lista_registri var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block99_lista_registriInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:docnum_principale var type: script -->
        <sourceRef><![CDATA[doc_determina.DOCNUM;]]></sourceRef>
        <targetRef>block99_docnum_principaleInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:figura_professionale var type: textRef -->
        <sourceRef><![CDATA[figura_professionale2]]></sourceRef>
        <targetRef>block99_figura_professionaleInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:reg_auto var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block99_reg_autoInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:assegnazione var type: object -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block99_assegnazioneInput</targetRef>
</dataInputAssociation>

<!-- lista props -->
<dataInputAssociation><!-- var type: string -->
        <targetRef>block99_nameInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[AMD Registrazione interna - Protocollazione determina ]]></from>
            <to xsi:type="tFormalExpression">block99_nameInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: string -->
        <targetRef>block99_descriptionInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[note]]></from>
            <to xsi:type="tFormalExpression">block99_descriptionInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: bool -->
        <targetRef>block99_waitForCompletionInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[true]]></from>
            <to xsi:type="tFormalExpression">block99_waitForCompletionInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: string -->
        <targetRef>block99_processNameInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[AMD_RegistrazioneInternaUD1.0]]></from>
            <to xsi:type="tFormalExpression">block99_processNameInput</to>
        </assignment>
</dataInputAssociation>

<!-- lista outputs -->
<dataOutputAssociation>
        <sourceRef>block99_principaleOutput</sourceRef>
        <targetRef>doc_determina</targetRef>
</dataOutputAssociation>
    
</callActivity>





<callActivity id="block181" isForCompensation="false" independent="false" waitForCompletion="true" name="AMD Approvazione determina" calledElementByName="AMD_ApprovazioneUD2.6" >
<!-- ioSpecification -->
<ioSpecification>
    <dataInput id="block181_noteInput" name="note" />
    <dataInput id="block181_instanceNameInput" name="instanceName" />
    <dataInput id="block181_tipologiePrincipaleInput" name="tipologiePrincipale" />
    <dataInput id="block181_approvatoriInput" name="approvatori" />
    <dataInput id="block181_descrizioneTaskInput" name="descrizioneTask" />
    <dataInput id="block181_tipologieAnnotazioneInput" name="tipologieAnnotazione" />
    <dataInput id="block181_INSTANCE_AOOInput" name="INSTANCE_AOO" />
    <dataInput id="block181_humanTokenInput" name="humanToken" />
    <dataInput id="block181_invio_notificaInput" name="invio_notifica" />
    <dataInput id="block181_instanceIdInput" name="instanceId" />
    <dataInput id="block181_gestioneAggiuntaRelatedInput" name="gestioneAggiuntaRelated" />
    <dataInput id="block181_INSTANCE_ENTEInput" name="INSTANCE_ENTE" />
    <dataInput id="block181_lanesInput" name="lanes" />
    <dataInput id="block181_formatoDataPerNoteInput" name="formatoDataPerNote" />
    <dataInput id="block181_outcomeInput" name="outcome" />
    <dataInput id="block181_mittenteInput" name="mittente" />
    <dataInput id="block181_nomeHTApprovazioneInput" name="nomeHTApprovazione" />
    <dataInput id="block181_systemTokenInput" name="systemToken" />
    <dataInput id="block181_gestioneEliminaInput" name="gestioneElimina" />
    <dataInput id="block181_descrizioneInput" name="descrizione" />
    <dataInput id="block181_tipologieAnnessoInput" name="tipologieAnnesso" />
    <dataInput id="block181_canalePECInput" name="canalePEC" />
    <dataInput id="block181_filenameDinamicoInput" name="filenameDinamico" />
    <dataInput id="block181_tipologieAllegatoInput" name="tipologieAllegato" />
    <dataInput id="block181_docnum_principaleInput" name="docnum_principale" />
    <dataInput id="block181_figura_professionaleInput" name="figura_professionale" />
    <dataInput id="block181_userInput" name="user" />
    <dataInput id="block181_commitInput" name="commit" />
    <dataOutput id="block181_utente_approvatoreOutput" name="utente_approvatore" />
    <dataOutput id="block181_esitoOutput" name="esito" />
    <dataOutput id="block181_businessStateOutput" name="businessState" />
    <dataOutput id="block181_systemTokenOutput" name="systemToken" />
    <dataOutput id="block181_principaleOutput" name="principale" />
    <dataOutput id="block181_lanesOutput" name="lanes" />
    <dataOutput id="block181_richiesta_revisioneOutput" name="richiesta_revisione" />

    <inputSet>
        <dataInputRefs>block181_noteInput</dataInputRefs>
        <dataInputRefs>block181_instanceNameInput</dataInputRefs>
        <dataInputRefs>block181_tipologiePrincipaleInput</dataInputRefs>
        <dataInputRefs>block181_approvatoriInput</dataInputRefs>
        <dataInputRefs>block181_descrizioneTaskInput</dataInputRefs>
        <dataInputRefs>block181_tipologieAnnotazioneInput</dataInputRefs>
        <dataInputRefs>block181_INSTANCE_AOOInput</dataInputRefs>
        <dataInputRefs>block181_humanTokenInput</dataInputRefs>
        <dataInputRefs>block181_invio_notificaInput</dataInputRefs>
        <dataInputRefs>block181_instanceIdInput</dataInputRefs>
        <dataInputRefs>block181_gestioneAggiuntaRelatedInput</dataInputRefs>
        <dataInputRefs>block181_INSTANCE_ENTEInput</dataInputRefs>
        <dataInputRefs>block181_lanesInput</dataInputRefs>
        <dataInputRefs>block181_formatoDataPerNoteInput</dataInputRefs>
        <dataInputRefs>block181_outcomeInput</dataInputRefs>
        <dataInputRefs>block181_mittenteInput</dataInputRefs>
        <dataInputRefs>block181_nomeHTApprovazioneInput</dataInputRefs>
        <dataInputRefs>block181_systemTokenInput</dataInputRefs>
        <dataInputRefs>block181_gestioneEliminaInput</dataInputRefs>
        <dataInputRefs>block181_descrizioneInput</dataInputRefs>
        <dataInputRefs>block181_tipologieAnnessoInput</dataInputRefs>
        <dataInputRefs>block181_canalePECInput</dataInputRefs>
        <dataInputRefs>block181_filenameDinamicoInput</dataInputRefs>
        <dataInputRefs>block181_tipologieAllegatoInput</dataInputRefs>
        <dataInputRefs>block181_docnum_principaleInput</dataInputRefs>
        <dataInputRefs>block181_figura_professionaleInput</dataInputRefs>
        <dataInputRefs>block181_userInput</dataInputRefs>
        <dataInputRefs>block181_commitInput</dataInputRefs>
    </inputSet>

    <outputSet>
        <dataOutputRefs>block181_utente_approvatoreOutput</dataOutputRefs>
        <dataOutputRefs>block181_esitoOutput</dataOutputRefs>
        <dataOutputRefs>block181_businessStateOutput</dataOutputRefs>
        <dataOutputRefs>block181_systemTokenOutput</dataOutputRefs>
        <dataOutputRefs>block181_principaleOutput</dataOutputRefs>
        <dataOutputRefs>block181_lanesOutput</dataOutputRefs>
        <dataOutputRefs>block181_richiesta_revisioneOutput</dataOutputRefs>
    </outputSet>
</ioSpecification>

<!-- lista inputs -->
<dataInputAssociation><!-- k:note var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block181_noteInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:instanceName var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block181_instanceNameInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:tipologiePrincipale var type: textRef -->
        <sourceRef><![CDATA[tipologiePrincipale]]></sourceRef>
        <targetRef>block181_tipologiePrincipaleInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:approvatori var type: object -->
        <sourceRef><![CDATA[approvatori_proponente]]></sourceRef>
        <targetRef>block181_approvatoriInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:descrizioneTask var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block181_descrizioneTaskInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:tipologieAnnotazione var type: textRef -->
        <sourceRef><![CDATA[tipologieAnnotazione]]></sourceRef>
        <targetRef>block181_tipologieAnnotazioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:INSTANCE_AOO var type: textRef -->
        <sourceRef><![CDATA[INSTANCE_AOO]]></sourceRef>
        <targetRef>block181_INSTANCE_AOOInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:humanToken var type: userToken -->
        <sourceRef><![CDATA[humanToken]]></sourceRef>
        <targetRef>block181_humanTokenInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:invio_notifica var type: script -->
        <sourceRef><![CDATA["no"]]></sourceRef>
        <targetRef>block181_invio_notificaInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:instanceId var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block181_instanceIdInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:gestioneAggiuntaRelated var type: script -->
        <sourceRef><![CDATA["si"]]></sourceRef>
        <targetRef>block181_gestioneAggiuntaRelatedInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:INSTANCE_ENTE var type: textRef -->
        <sourceRef><![CDATA[INSTANCE_ENTE]]></sourceRef>
        <targetRef>block181_INSTANCE_ENTEInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:lanes var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block181_lanesInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:formatoDataPerNote var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block181_formatoDataPerNoteInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:outcome var type: object -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block181_outcomeInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:mittente var type: tempRef -->
        <sourceRef><![CDATA[mittente]]></sourceRef>
        <targetRef>block181_mittenteInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:nomeHTApprovazione var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block181_nomeHTApprovazioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:systemToken var type: userToken -->
        <sourceRef><![CDATA[systemToken]]></sourceRef>
        <targetRef>block181_systemTokenInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:gestioneElimina var type: script -->
        <sourceRef><![CDATA["si"]]></sourceRef>
        <targetRef>block181_gestioneEliminaInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:descrizione var type: script -->
        <sourceRef><![CDATA["Approvazione determina - Ufficio: "+descrizione_ufficioCompetenza]]></sourceRef>
        <targetRef>block181_descrizioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:tipologieAnnesso var type: textRef -->
        <sourceRef><![CDATA[tipologieAnnesso]]></sourceRef>
        <targetRef>block181_tipologieAnnessoInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:canalePEC var type: channel -->
        <targetRef>block181_canalePECInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[]]></from>
            <to xsi:type="tFormalExpression">block181_canalePECInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- k:filenameDinamico var type: script -->
        <sourceRef><![CDATA["si"]]></sourceRef>
        <targetRef>block181_filenameDinamicoInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:tipologieAllegato var type: textRef -->
        <sourceRef><![CDATA[tipologieAllegato]]></sourceRef>
        <targetRef>block181_tipologieAllegatoInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:docnum_principale var type: script -->
        <sourceRef><![CDATA[doc_determina.DOCNUM]]></sourceRef>
        <targetRef>block181_docnum_principaleInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:figura_professionale var type: textRef -->
        <sourceRef><![CDATA[figura_professionale]]></sourceRef>
        <targetRef>block181_figura_professionaleInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:user var type: object -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block181_userInput</targetRef>
</dataInputAssociation>

<!-- lista props -->
<dataInputAssociation><!-- var type: boolean -->
        <sourceRef>false</sourceRef>
        <targetRef>block181_commitInput</targetRef>
</dataInputAssociation>

<!-- lista outputs -->
<dataOutputAssociation>
        <sourceRef>block181_utente_approvatoreOutput</sourceRef>
        <targetRef></targetRef>
</dataOutputAssociation>
<dataOutputAssociation>
        <sourceRef>block181_esitoOutput</sourceRef>
        <targetRef>esito</targetRef>
</dataOutputAssociation>
<dataOutputAssociation>
        <sourceRef>block181_businessStateOutput</sourceRef>
        <targetRef></targetRef>
</dataOutputAssociation>
<dataOutputAssociation>
        <sourceRef>block181_systemTokenOutput</sourceRef>
        <targetRef>systemToken</targetRef>
</dataOutputAssociation>
<dataOutputAssociation>
        <sourceRef>block181_principaleOutput</sourceRef>
        <targetRef>doc_determina</targetRef>
</dataOutputAssociation>
<dataOutputAssociation>
        <sourceRef>block181_lanesOutput</sourceRef>
        <targetRef></targetRef>
</dataOutputAssociation>
<dataOutputAssociation>
        <sourceRef>block181_richiesta_revisioneOutput</sourceRef>
        <targetRef>note</targetRef>
</dataOutputAssociation>
    
</callActivity>




<sequenceFlow id="con_34365" sourceRef="block170" targetRef="block145">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[abilita_rest=="si"]]>
    </conditionExpression>
</sequenceFlow>


<callActivity id="block3" isForCompensation="false" independent="false" waitForCompletion="true" name="AMD Firma Determina" calledElementByName="AMD_FirmaUD2.1" >
<!-- ioSpecification -->
<ioSpecification>
    <dataInput id="block3_testo_notificaInput" name="testo_notifica" />
    <dataInput id="block3_versioningInput" name="versioning" />
    <dataInput id="block3_tipo_firmaInput" name="tipo_firma" />
    <dataInput id="block3_mittenteInput" name="mittente" />
    <dataInput id="block3_instanceNameInput" name="instanceName" />
    <dataInput id="block3_systemTokenInput" name="systemToken" />
    <dataInput id="block3_firmaInput" name="firma" />
    <dataInput id="block3_testoEmailErroreFirmaInput" name="testoEmailErroreFirma" />
    <dataInput id="block3_humanTokenInput" name="humanToken" />
    <dataInput id="block3_descrizioneInput" name="descrizione" />
    <dataInput id="block3_instanceIdInput" name="instanceId" />
    <dataInput id="block3_providerInput" name="provider" />
    <dataInput id="block3_canalePECInput" name="canalePEC" />
    <dataInput id="block3_urlDocerInput" name="urlDocer" />
    <dataInput id="block3_docnum_principaleInput" name="docnum_principale" />
    <dataInput id="block3_oggettoEmailErroreFirmaInput" name="oggettoEmailErroreFirma" />
    <dataInput id="block3_figura_professionaleInput" name="figura_professionale" />
    <dataInput id="block3_userInput" name="user" />
    <dataInput id="block3_outcomeInput" name="outcome" />
    <dataInput id="block3_nameInput" name="name" />
    <dataInput id="block3_descriptionInput" name="description" />
    <dataInput id="block3_processNameInput" name="processName" />
    <dataOutput id="block3_principale_nuova_udOutput" name="principale_nuova_ud" />

    <inputSet>
        <dataInputRefs>block3_testo_notificaInput</dataInputRefs>
        <dataInputRefs>block3_versioningInput</dataInputRefs>
        <dataInputRefs>block3_tipo_firmaInput</dataInputRefs>
        <dataInputRefs>block3_mittenteInput</dataInputRefs>
        <dataInputRefs>block3_instanceNameInput</dataInputRefs>
        <dataInputRefs>block3_systemTokenInput</dataInputRefs>
        <dataInputRefs>block3_firmaInput</dataInputRefs>
        <dataInputRefs>block3_testoEmailErroreFirmaInput</dataInputRefs>
        <dataInputRefs>block3_humanTokenInput</dataInputRefs>
        <dataInputRefs>block3_descrizioneInput</dataInputRefs>
        <dataInputRefs>block3_instanceIdInput</dataInputRefs>
        <dataInputRefs>block3_providerInput</dataInputRefs>
        <dataInputRefs>block3_canalePECInput</dataInputRefs>
        <dataInputRefs>block3_urlDocerInput</dataInputRefs>
        <dataInputRefs>block3_docnum_principaleInput</dataInputRefs>
        <dataInputRefs>block3_oggettoEmailErroreFirmaInput</dataInputRefs>
        <dataInputRefs>block3_figura_professionaleInput</dataInputRefs>
        <dataInputRefs>block3_userInput</dataInputRefs>
        <dataInputRefs>block3_outcomeInput</dataInputRefs>
        <dataInputRefs>block3_nameInput</dataInputRefs>
        <dataInputRefs>block3_descriptionInput</dataInputRefs>
        <dataInputRefs>block3_processNameInput</dataInputRefs>
    </inputSet>

    <outputSet>
        <dataOutputRefs>block3_principale_nuova_udOutput</dataOutputRefs>
    </outputSet>
</ioSpecification>

<!-- lista inputs -->
<dataInputAssociation><!-- k:testo_notifica var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block3_testo_notificaInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:versioning var type: script -->
        <sourceRef><![CDATA["si";]]></sourceRef>
        <targetRef>block3_versioningInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:tipo_firma var type: textRef -->
        <sourceRef><![CDATA[tipo_firma]]></sourceRef>
        <targetRef>block3_tipo_firmaInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:mittente var type: soggetto -->
        <sourceRef><![CDATA[mittente]]></sourceRef>
        <targetRef>block3_mittenteInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:instanceName var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block3_instanceNameInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:systemToken var type: userToken -->
        <sourceRef><![CDATA[systemToken]]></sourceRef>
        <targetRef>block3_systemTokenInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:firma var type: textRef -->
        <sourceRef><![CDATA[firma]]></sourceRef>
        <targetRef>block3_firmaInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:testoEmailErroreFirma var type: script -->
        <sourceRef><![CDATA["Si comunica che l'attivita' di firma per la determina avente oggetto "+variabili_determina.Intoggetto+" non e' terminata correttamente. L'attivita' di firma e' stata quindi rimessa in arrivo tra le Sue attivita'.";
]]></sourceRef>
        <targetRef>block3_testoEmailErroreFirmaInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:humanToken var type: userToken -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block3_humanTokenInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:descrizione var type: script -->
        <sourceRef><![CDATA["Firma determina - Dirigente ufficio "+descrizione_ufficioCompetenza;]]></sourceRef>
        <targetRef>block3_descrizioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:instanceId var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block3_instanceIdInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:provider var type: textRef -->
        <sourceRef><![CDATA[provider]]></sourceRef>
        <targetRef>block3_providerInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:canalePEC var type: channel -->
        <targetRef>block3_canalePECInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[]]></from>
            <to xsi:type="tFormalExpression">block3_canalePECInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- k:urlDocer var type: textRef -->
        <sourceRef><![CDATA[urlDocer]]></sourceRef>
        <targetRef>block3_urlDocerInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:docnum_principale var type: script -->
        <sourceRef><![CDATA[doc_determina.DOCNUM;]]></sourceRef>
        <targetRef>block3_docnum_principaleInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:oggettoEmailErroreFirma var type: script -->
        <sourceRef><![CDATA["Errore nell'attivita' di firma per la determina "+variabili_determina.Intoggetto;]]></sourceRef>
        <targetRef>block3_oggettoEmailErroreFirmaInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:figura_professionale var type: textRef -->
        <sourceRef><![CDATA[figura_professionale2]]></sourceRef>
        <targetRef>block3_figura_professionaleInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:user var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block3_userInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:outcome var type: object -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block3_outcomeInput</targetRef>
</dataInputAssociation>

<!-- lista props -->
<dataInputAssociation><!-- var type: string -->
        <targetRef>block3_nameInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[AMD Firma Determina]]></from>
            <to xsi:type="tFormalExpression">block3_nameInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: string -->
        <targetRef>block3_descriptionInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[note]]></from>
            <to xsi:type="tFormalExpression">block3_descriptionInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: string -->
        <targetRef>block3_processNameInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[AMD_FirmaUD2.1]]></from>
            <to xsi:type="tFormalExpression">block3_processNameInput</to>
        </assignment>
</dataInputAssociation>

<!-- lista outputs -->
<dataOutputAssociation>
        <sourceRef>block3_principale_nuova_udOutput</sourceRef>
        <targetRef>doc_determina</targetRef>
</dataOutputAssociation>
    
</callActivity>




<scriptTask id="block156" scriptFormat="http://www.mvel.org/2.0" name="Gestione notifica gruppo non esistente" isForCompensation="false" >
    <script>
        <![CDATA[



/************** start user script ***************/

java.lang.String oggettoMail = "";
java.lang.String corpoMail = "";

destinatario.put("IndirizzoTelematico",indirizzoDefault);
oggettoMail="Attenzione: gruppo non esistente per istanza con id. "+instanceId;
corpoMail="Si comunica che l'istanza di determina in oggetto e' in attesa di modifica dei gruppi proponente e/o dirigente poiche' quelli utilizzati potrebbero essere stati disabilitati";

oggettoNotifica=oggettoMail;
corpoNotifica=corpoMail;

/**************  end user script  ***************/



//[auto-insert]
kcontext.setVariable("destinatario",null);
kcontext.setVariable("destinatario",destinatario);
kcontext.setVariable("corpoNotifica",null);
kcontext.setVariable("corpoNotifica",corpoNotifica);
kcontext.setVariable("oggettoNotifica",null);
kcontext.setVariable("oggettoNotifica",oggettoNotifica);

        ]]>
    </script>
</scriptTask>



<sequenceFlow id="con_34185" sourceRef="block142" targetRef="block144">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<inclusiveGateway id="block80" name="gateway-branching" gatewayDirection="Diverging"></inclusiveGateway>
<sequenceFlow id="con_34017" sourceRef="block6" targetRef="block13">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[verifica_dirigente=="proponente"]]>
    </conditionExpression>
</sequenceFlow>

<scriptTask id="block187" scriptFormat="http://www.mvel.org/2.0" name="Gestione BS e timeline" isForCompensation="false" >
    <script>
        <![CDATA[



/************** start user script ***************/

businessState = "statoDetermina3";
timeline_state = 3;

/**************  end user script  ***************/

//[auto-insert]
//Business State (businessState), timeline_state
kcontext.setVariable("businessState",null);
kcontext.setVariable("businessState",businessState);
kcontext.setVariable("timeline_state",null);
kcontext.setVariable("timeline_state",timeline_state);



        ]]>
    </script>
</scriptTask>



<sequenceFlow id="con_33903" sourceRef="block7" targetRef="block96">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[esito=="si"]]>
    </conditionExpression>
</sequenceFlow>

<task id="block93" name="Aggiorna riferimenti" tns:taskName="DocerJMS" >
    <ioSpecification>

        <dataInput id="block93_TaskNameInput" name="TaskName" />
        <dataInput id="block93_GroupIdInput" name="GroupId" />
        <dataInput id="block93_Operation" name="operation" />

            <dataInput id="block93_userTokenInput" name="userToken" />
            <dataInput id="block93_referenceDocsInput" name="referenceDocs" />
            <dataInput id="block93_documentInput" name="document" />
        
            <dataOutput id="block93_deltaOutput" name="delta" />
            <dataOutput id="block93_userTokenOutput" name="userToken" />
            <dataOutput id="block93_resultsOutput" name="results" />
            <dataOutput id="block93_firstOutput" name="first" />
           

        <inputSet>
            <dataInputRefs>block93_TaskNameInput</dataInputRefs>
            <dataInputRefs>block93_GroupIdInput</dataInputRefs>
            <dataInputRefs>block93_Operation</dataInputRefs>
                <dataInputRefs>block93_userTokenInput</dataInputRefs>
                <dataInputRefs>block93_referenceDocsInput</dataInputRefs>
                <dataInputRefs>block93_documentInput</dataInputRefs>
        </inputSet>
        
        <outputSet>
                <dataOutputRefs>block93_deltaOutput</dataOutputRefs>
                <dataOutputRefs>block93_userTokenOutput</dataOutputRefs>
                <dataOutputRefs>block93_resultsOutput</dataOutputRefs>
                <dataOutputRefs>block93_firstOutput</dataOutputRefs>
                
         </outputSet>

    </ioSpecification>
                <dataInputAssociation>
                            <sourceRef>systemToken</sourceRef>
                            <targetRef>block93_userTokenInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef>lista_referenziati</sourceRef>
                            <targetRef>block93_referenceDocsInput</targetRef>

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef>doc_determina</sourceRef>
                            <targetRef>block93_documentInput</targetRef>

                </dataInputAssociation>

      <dataInputAssociation>
        <targetRef>block93_GroupIdInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression"></from>
           <to xsi:type="tFormalExpression">block93_GroupIdInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>block93_TaskNameInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">Aggiorna riferimenti</from>
           <to xsi:type="tFormalExpression">block93_TaskNameInput</to>
        </assignment>
      </dataInputAssociation>
    <dataInputAssociation>
        <targetRef>block93_Operation</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression">AggiornaRiferimenti</from>
            <to xsi:type="tFormalExpression">block93_Operation</to>
        </assignment>
    </dataInputAssociation>



            <dataOutputAssociation>
                            <sourceRef>block93_deltaOutput</sourceRef>
                            <targetRef></targetRef>
            </dataOutputAssociation>
            <dataOutputAssociation>
                            <sourceRef>block93_userTokenOutput</sourceRef>
                            <targetRef>systemToken</targetRef>
                            
            </dataOutputAssociation>
            <dataOutputAssociation>
                            <sourceRef>block93_resultsOutput</sourceRef>
                            <targetRef></targetRef>
            </dataOutputAssociation>
            <dataOutputAssociation>
                            <sourceRef>block93_firstOutput</sourceRef>
                            <targetRef></targetRef>
            </dataOutputAssociation>
           
      <potentialOwner>
        <resourceAssignmentExpression>
           <formalExpression></formalExpression>
        </resourceAssignmentExpression>
      </potentialOwner>
</task>

<scriptTask id="block162" scriptFormat="http://www.mvel.org/2.0" name="Gestione modifica oggetto determina" isForCompensation="false" >
    <script>
        <![CDATA[



//[auto-insert]
Descrizione=descrizione;

/************** start user script ***************/

System.out.println("importoLiquidazione in determinazioni dir 1.1"+importoLiquidazione);
java.lang.String oggetto = variabili_determina.Intoggetto;
Descrizione=instanceId+" - "+oggetto.toUpperCase();

//mittenti_registrazione = ...
mittenti_registrazione.get(0).CodiceAmministrazioneUo=variabili_determina.IntCodUffProp;
mittenti_registrazione.get(0).DenominazioneUo=variabili_determina.IntDescrUffProp;

//listaCorrelati_precedenti = ...
listaCorrelati_precedenti.clear();

/**************  end user script  ***************/

//[auto-insert]
//instanceId, mittenti_registrazione, listaCorrelati_precedenti
kcontext.setVariable("instanceId",null);
kcontext.setVariable("instanceId",instanceId);
kcontext.setVariable("mittenti_registrazione",null);
kcontext.setVariable("mittenti_registrazione",mittenti_registrazione);
kcontext.setVariable("listaCorrelati_precedenti",null);
kcontext.setVariable("listaCorrelati_precedenti",listaCorrelati_precedenti);



//[auto-insert]
kcontext.setVariable("descrizione",null);
kcontext.setVariable("descrizione",Descrizione);

        ]]>
    </script>
</scriptTask>



<sequenceFlow id="con_34359" sourceRef="block99" targetRef="block170">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<task id="block149" name="Recupera gruppi" tns:taskName="DocerJMS" >
    <ioSpecification>

        <dataInput id="block149_TaskNameInput" name="TaskName" />
        <dataInput id="block149_GroupIdInput" name="GroupId" />

        <dataInput id="block149_Operation" name="operation" />

            <dataInput id="block149_userTokenInput" name="userToken" />
            <dataInput id="block149_IdGruppoInput" name="IdGruppo" />
            <dataInput id="block149_IdUtenteInput" name="IdUtente" />
        
            <dataOutput id="block149_listaGruppiOutput" name="listaGruppi" />
            <dataOutput id="block149_userTokenOutput" name="userToken" />
           

        <inputSet>
            <dataInputRefs>block149_Operation</dataInputRefs>
            <dataInputRefs>block149_TaskNameInput</dataInputRefs>
            <dataInputRefs>block149_GroupIdInput</dataInputRefs>
                <dataInputRefs>block149_userTokenInput</dataInputRefs>
                <dataInputRefs>block149_IdGruppoInput</dataInputRefs>
                <dataInputRefs>block149_IdUtenteInput</dataInputRefs>
        </inputSet>
        
        <outputSet>
                <dataOutputRefs>block149_listaGruppiOutput</dataOutputRefs>
                <dataOutputRefs>block149_userTokenOutput</dataOutputRefs>
                
         </outputSet>

    </ioSpecification>
                <dataInputAssociation>
                            <sourceRef>systemToken</sourceRef>
                            <targetRef>block149_userTokenInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef>figura_professionale</sourceRef>
                            <targetRef>block149_IdGruppoInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef></sourceRef>
                            <targetRef>block149_IdUtenteInput</targetRef>
                            

                </dataInputAssociation>

      <dataInputAssociation>
        <targetRef>block149_GroupIdInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression"></from>
           <to xsi:type="tFormalExpression">block149_GroupIdInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>block149_TaskNameInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">Recupera gruppi</from>
           <to xsi:type="tFormalExpression">block149_TaskNameInput</to>
        </assignment>
      </dataInputAssociation>
    <dataInputAssociation>
        <targetRef>block149_Operation</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression">RecuperaGruppi</from>
            <to xsi:type="tFormalExpression">block149_Operation</to>
        </assignment>
    </dataInputAssociation>


            <dataOutputAssociation>
                            <sourceRef>block149_listaGruppiOutput</sourceRef>
                            <targetRef>gruppi_parent_proponente</targetRef>
                            
            </dataOutputAssociation>
            <dataOutputAssociation>
                            <sourceRef>block149_userTokenOutput</sourceRef>
                            <targetRef>systemToken</targetRef>
                            
            </dataOutputAssociation>
           
      <potentialOwner>
        <resourceAssignmentExpression>
           <formalExpression></formalExpression>
        </resourceAssignmentExpression>
      </potentialOwner>
</task>


<callActivity id="block106" isForCompensation="false" independent="false" waitForCompletion="true" name="Controllo finanziario" calledElementByName="Controllo Finanziario Base1.0" >
<!-- ioSpecification -->
<ioSpecification>
    <dataInput id="block106_tipo_firmaInput" name="tipo_firma" />
    <dataInput id="block106_mittenteInput" name="mittente" />
    <dataInput id="block106_instanceNameInput" name="instanceName" />
    <dataInput id="block106_tipologiePrincipaleInput" name="tipologiePrincipale" />
    <dataInput id="block106_tipo_controlloInput" name="tipo_controllo" />
    <dataInput id="block106_systemTokenInput" name="systemToken" />
    <dataInput id="block106_tipologieAnnotazioneInput" name="tipologieAnnotazione" />
    <dataInput id="block106_firmaInput" name="firma" />
    <dataInput id="block106_humanTokenInput" name="humanToken" />
    <dataInput id="block106_canaleMAILInput" name="canaleMAIL" />
    <dataInput id="block106_descrizioneInput" name="descrizione" />
    <dataInput id="block106_instanceIdInput" name="instanceId" />
    <dataInput id="block106_providerInput" name="provider" />
    <dataInput id="block106_valori_determinaInput" name="valori_determina" />
    <dataInput id="block106_tipologieAnnessoInput" name="tipologieAnnesso" />
    <dataInput id="block106_canalePECInput" name="canalePEC" />
    <dataInput id="block106_canaleJMSInput" name="canaleJMS" />
    <dataInput id="block106_tipologieAllegatoInput" name="tipologieAllegato" />
    <dataInput id="block106_urlDocerInput" name="urlDocer" />
    <dataInput id="block106_variabili_determinaInput" name="variabili_determina" />
    <dataInput id="block106_docnum_principaleInput" name="docnum_principale" />
    <dataInput id="block106_outcomeInput" name="outcome" />
    <dataInput id="block106_nameInput" name="name" />
    <dataInput id="block106_descriptionInput" name="description" />
    <dataInput id="block106_waitForCompletionInput" name="waitForCompletion" />
    <dataInput id="block106_processNameInput" name="processName" />
    <dataOutput id="block106_noteOutput" name="note" />
    <dataOutput id="block106_esitoOutput" name="esito" />
    <dataOutput id="block106_doc_vistoOutput" name="doc_visto" />

    <inputSet>
        <dataInputRefs>block106_tipo_firmaInput</dataInputRefs>
        <dataInputRefs>block106_mittenteInput</dataInputRefs>
        <dataInputRefs>block106_instanceNameInput</dataInputRefs>
        <dataInputRefs>block106_tipologiePrincipaleInput</dataInputRefs>
        <dataInputRefs>block106_tipo_controlloInput</dataInputRefs>
        <dataInputRefs>block106_systemTokenInput</dataInputRefs>
        <dataInputRefs>block106_tipologieAnnotazioneInput</dataInputRefs>
        <dataInputRefs>block106_firmaInput</dataInputRefs>
        <dataInputRefs>block106_humanTokenInput</dataInputRefs>
        <dataInputRefs>block106_canaleMAILInput</dataInputRefs>
        <dataInputRefs>block106_descrizioneInput</dataInputRefs>
        <dataInputRefs>block106_instanceIdInput</dataInputRefs>
        <dataInputRefs>block106_providerInput</dataInputRefs>
        <dataInputRefs>block106_valori_determinaInput</dataInputRefs>
        <dataInputRefs>block106_tipologieAnnessoInput</dataInputRefs>
        <dataInputRefs>block106_canalePECInput</dataInputRefs>
        <dataInputRefs>block106_canaleJMSInput</dataInputRefs>
        <dataInputRefs>block106_tipologieAllegatoInput</dataInputRefs>
        <dataInputRefs>block106_urlDocerInput</dataInputRefs>
        <dataInputRefs>block106_variabili_determinaInput</dataInputRefs>
        <dataInputRefs>block106_docnum_principaleInput</dataInputRefs>
        <dataInputRefs>block106_outcomeInput</dataInputRefs>
        <dataInputRefs>block106_nameInput</dataInputRefs>
        <dataInputRefs>block106_descriptionInput</dataInputRefs>
        <dataInputRefs>block106_waitForCompletionInput</dataInputRefs>
        <dataInputRefs>block106_processNameInput</dataInputRefs>
    </inputSet>

    <outputSet>
        <dataOutputRefs>block106_noteOutput</dataOutputRefs>
        <dataOutputRefs>block106_esitoOutput</dataOutputRefs>
        <dataOutputRefs>block106_doc_vistoOutput</dataOutputRefs>
    </outputSet>
</ioSpecification>

<!-- lista inputs -->
<dataInputAssociation><!-- k:tipo_firma var type: textRef -->
        <sourceRef><![CDATA[tipo_firma]]></sourceRef>
        <targetRef>block106_tipo_firmaInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:mittente var type: soggetto -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block106_mittenteInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:instanceName var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block106_instanceNameInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:tipologiePrincipale var type: textRef -->
        <sourceRef><![CDATA[tipologiePrincipale]]></sourceRef>
        <targetRef>block106_tipologiePrincipaleInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:tipo_controllo var type: textRef -->
        <sourceRef><![CDATA[tipo_determina]]></sourceRef>
        <targetRef>block106_tipo_controlloInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:systemToken var type: userToken -->
        <sourceRef><![CDATA[systemToken]]></sourceRef>
        <targetRef>block106_systemTokenInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:tipologieAnnotazione var type: textRef -->
        <sourceRef><![CDATA[tipologieAnnotazione]]></sourceRef>
        <targetRef>block106_tipologieAnnotazioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:firma var type: textRef -->
        <sourceRef><![CDATA[firma]]></sourceRef>
        <targetRef>block106_firmaInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:humanToken var type: userToken -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block106_humanTokenInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:canaleMAIL var type: channel -->
        <targetRef>block106_canaleMAILInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[]]></from>
            <to xsi:type="tFormalExpression">block106_canaleMAILInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- k:descrizione var type: script -->
        <sourceRef><![CDATA["Controllo finanziario determina - Ufficio: "+descrizione_ufficioCompetenza;]]></sourceRef>
        <targetRef>block106_descrizioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:instanceId var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block106_instanceIdInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:provider var type: textRef -->
        <sourceRef><![CDATA[provider]]></sourceRef>
        <targetRef>block106_providerInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:valori_determina var type: object -->
        <sourceRef><![CDATA[valori_determina]]></sourceRef>
        <targetRef>block106_valori_determinaInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:tipologieAnnesso var type: textRef -->
        <sourceRef><![CDATA[tipologieAnnesso]]></sourceRef>
        <targetRef>block106_tipologieAnnessoInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:canalePEC var type: channel -->
        <targetRef>block106_canalePECInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[]]></from>
            <to xsi:type="tFormalExpression">block106_canalePECInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- k:canaleJMS var type: channel -->
        <targetRef>block106_canaleJMSInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[]]></from>
            <to xsi:type="tFormalExpression">block106_canaleJMSInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- k:tipologieAllegato var type: textRef -->
        <sourceRef><![CDATA[tipologieAllegato]]></sourceRef>
        <targetRef>block106_tipologieAllegatoInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:urlDocer var type: textRef -->
        <sourceRef><![CDATA[urlDocer]]></sourceRef>
        <targetRef>block106_urlDocerInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:variabili_determina var type: object -->
        <sourceRef><![CDATA[variabili_determina]]></sourceRef>
        <targetRef>block106_variabili_determinaInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:docnum_principale var type: script -->
        <sourceRef><![CDATA[doc_determina.DOCNUM;]]></sourceRef>
        <targetRef>block106_docnum_principaleInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:outcome var type: object -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block106_outcomeInput</targetRef>
</dataInputAssociation>

<!-- lista props -->
<dataInputAssociation><!-- var type: string -->
        <targetRef>block106_nameInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[Controllo finanziario]]></from>
            <to xsi:type="tFormalExpression">block106_nameInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: string -->
        <targetRef>block106_descriptionInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[note]]></from>
            <to xsi:type="tFormalExpression">block106_descriptionInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: bool -->
        <targetRef>block106_waitForCompletionInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[true]]></from>
            <to xsi:type="tFormalExpression">block106_waitForCompletionInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: string -->
        <targetRef>block106_processNameInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[Controllo Finanziario Base1.0]]></from>
            <to xsi:type="tFormalExpression">block106_processNameInput</to>
        </assignment>
</dataInputAssociation>

<!-- lista outputs -->
<dataOutputAssociation>
        <sourceRef>block106_noteOutput</sourceRef>
        <targetRef>note</targetRef>
</dataOutputAssociation>
<dataOutputAssociation>
        <sourceRef>block106_esitoOutput</sourceRef>
        <targetRef>esito</targetRef>
</dataOutputAssociation>
<dataOutputAssociation>
        <sourceRef>block106_doc_vistoOutput</sourceRef>
        <targetRef>doc_visto</targetRef>
</dataOutputAssociation>
    
</callActivity>




<sequenceFlow id="con_33861" sourceRef="block89" targetRef="block88">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[determina_numerata=="si"]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34311" sourceRef="block134" targetRef="block165">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<scriptTask id="block114" scriptFormat="http://www.mvel.org/2.0" name="Gestione determina omissis come allegato" isForCompensation="false" >
    <script>
        <![CDATA[



//[auto-insert]
valori=valori_determina;

/************** start user script ***************/

java.util.HashMap doc = new java.util.HashMap();

doc.put("@structure","document");
doc.put("TIPO_COMPONENTE","ALLEGATO");
doc.put("DOCNAME","testo_determina-"+doc_testo_determina.DOCNAME);
doc.put("TYPE_ID",doc_determina.TYPE_ID);
doc.put("DOCNUM",doc_testo_determina.DOCNUM);
doc.put("STATO_BUSINESS","4");

doc_testo_determina=doc;
lista_allegati_omissis.clear();
lista_allegati_omissis.add(doc_testo_determina);

valori.put("docnumOmissis", doc_testo_determina.DOCNUM);

/**************  end user script  ***************/



//[auto-insert]
kcontext.setVariable("doc_testo_determina",null);
kcontext.setVariable("doc_testo_determina",doc_testo_determina);
kcontext.setVariable("lista_allegati_omissis",null);
kcontext.setVariable("lista_allegati_omissis",lista_allegati_omissis);
kcontext.setVariable("valori_determina",null);
kcontext.setVariable("valori_determina",valori);

        ]]>
    </script>
</scriptTask>



<sequenceFlow id="con_34167" sourceRef="block140" targetRef="block143">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_33909" sourceRef="block83" targetRef="block84">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[esito=="no" || esito=="rev"]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_33987" sourceRef="block111" targetRef="block112">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>


<callActivity id="block104" isForCompensation="false" independent="false" waitForCompletion="true" name="Creazione determina" calledElementByName="Creazione determina Base1.1" >
<!-- ioSpecification -->
<ioSpecification>
    <dataInput id="block104_valoriInput" name="valori" />
    <dataInput id="block104_noteInput" name="note" />
    <dataInput id="block104_systemTokenInput" name="systemToken" />
    <dataInput id="block104_nameHTInput" name="nameHT" />
    <dataInput id="block104_listaCorrelati_precedentiInput" name="listaCorrelati_precedenti" />
    <dataInput id="block104_tipologieInput" name="tipologie" />
    <dataInput id="block104_template_determinaInput" name="template_determina" />
    <dataInput id="block104_descrizioneInput" name="descrizione" />
    <dataInput id="block104_tipo_determinaInput" name="tipo_determina" />
    <dataInput id="block104_variabiliInput" name="variabili" />
    <dataInput id="block104_docnum_principaleInput" name="docnum_principale" />
    <dataInput id="block104_urlDocerInput" name="urlDocer" />
    <dataInput id="block104_figura_professionaleInput" name="figura_professionale" />
    <dataInput id="block104_abilita_restInput" name="abilita_rest" />
    <dataInput id="block104_nameInput" name="name" />
    <dataInput id="block104_descriptionInput" name="description" />
    <dataInput id="block104_waitForCompletionInput" name="waitForCompletion" />
    <dataInput id="block104_processNameInput" name="processName" />
    <dataOutput id="block104_valoriOutput" name="valori" />
    <dataOutput id="block104_fascicolo_anticorruzioneOutput" name="fascicolo_anticorruzione" />
    <dataOutput id="block104_istanceProvvedimentoOutput" name="istanceProvvedimento" />
    <dataOutput id="block104_tipo_determinaOutput" name="tipo_determina" />
    <dataOutput id="block104_lista_risposteOutput" name="lista_risposte" />
    <dataOutput id="block104_importoLiquidazioneOutput" name="importoLiquidazione" />
    <dataOutput id="block104_variabiliOutput" name="variabili" />
    <dataOutput id="block104_doc_determinaOutput" name="doc_determina" />
    <dataOutput id="block104_isRischioOutput" name="isRischio" />
    <dataOutput id="block104_docnum_principaleOutput" name="docnum_principale" />
    <dataOutput id="block104_lista_domandeOutput" name="lista_domande" />

    <inputSet>
        <dataInputRefs>block104_valoriInput</dataInputRefs>
        <dataInputRefs>block104_noteInput</dataInputRefs>
        <dataInputRefs>block104_systemTokenInput</dataInputRefs>
        <dataInputRefs>block104_nameHTInput</dataInputRefs>
        <dataInputRefs>block104_listaCorrelati_precedentiInput</dataInputRefs>
        <dataInputRefs>block104_tipologieInput</dataInputRefs>
        <dataInputRefs>block104_template_determinaInput</dataInputRefs>
        <dataInputRefs>block104_descrizioneInput</dataInputRefs>
        <dataInputRefs>block104_tipo_determinaInput</dataInputRefs>
        <dataInputRefs>block104_variabiliInput</dataInputRefs>
        <dataInputRefs>block104_docnum_principaleInput</dataInputRefs>
        <dataInputRefs>block104_urlDocerInput</dataInputRefs>
        <dataInputRefs>block104_figura_professionaleInput</dataInputRefs>
        <dataInputRefs>block104_abilita_restInput</dataInputRefs>
        <dataInputRefs>block104_nameInput</dataInputRefs>
        <dataInputRefs>block104_descriptionInput</dataInputRefs>
        <dataInputRefs>block104_waitForCompletionInput</dataInputRefs>
        <dataInputRefs>block104_processNameInput</dataInputRefs>
    </inputSet>

    <outputSet>
        <dataOutputRefs>block104_valoriOutput</dataOutputRefs>
        <dataOutputRefs>block104_fascicolo_anticorruzioneOutput</dataOutputRefs>
        <dataOutputRefs>block104_istanceProvvedimentoOutput</dataOutputRefs>
        <dataOutputRefs>block104_tipo_determinaOutput</dataOutputRefs>
        <dataOutputRefs>block104_lista_risposteOutput</dataOutputRefs>
        <dataOutputRefs>block104_importoLiquidazioneOutput</dataOutputRefs>
        <dataOutputRefs>block104_variabiliOutput</dataOutputRefs>
        <dataOutputRefs>block104_doc_determinaOutput</dataOutputRefs>
        <dataOutputRefs>block104_isRischioOutput</dataOutputRefs>
        <dataOutputRefs>block104_docnum_principaleOutput</dataOutputRefs>
        <dataOutputRefs>block104_lista_domandeOutput</dataOutputRefs>
    </outputSet>
</ioSpecification>

<!-- lista inputs -->
<dataInputAssociation><!-- k:valori var type: object -->
        <sourceRef><![CDATA[valori_determina]]></sourceRef>
        <targetRef>block104_valoriInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:note var type: textRef -->
        <sourceRef><![CDATA[note]]></sourceRef>
        <targetRef>block104_noteInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:systemToken var type: userToken -->
        <sourceRef><![CDATA[systemToken]]></sourceRef>
        <targetRef>block104_systemTokenInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:nameHT var type: object -->
        <sourceRef><![CDATA[nameHT]]></sourceRef>
        <targetRef>block104_nameHTInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:listaCorrelati_precedenti var type: document -->
        <sourceRef><![CDATA[listaCorrelati_precedenti]]></sourceRef>
        <targetRef>block104_listaCorrelati_precedentiInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:tipologie var type: textRef -->
        <sourceRef><![CDATA[tipologiePrincipale]]></sourceRef>
        <targetRef>block104_tipologieInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:template_determina var type: document -->
        <sourceRef><![CDATA[template_determina]]></sourceRef>
        <targetRef>block104_template_determinaInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:descrizione var type: script -->
        <sourceRef><![CDATA["Creazione determina - Ufficio: "+descrizione_ufficioCompetenza;]]></sourceRef>
        <targetRef>block104_descrizioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:tipo_determina var type: textRef -->
        <sourceRef><![CDATA[tipo_determina]]></sourceRef>
        <targetRef>block104_tipo_determinaInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:variabili var type: object -->
        <sourceRef><![CDATA[variabili_determina]]></sourceRef>
        <targetRef>block104_variabiliInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:docnum_principale var type: textRef -->
        <sourceRef><![CDATA[docnum_determina]]></sourceRef>
        <targetRef>block104_docnum_principaleInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:urlDocer var type: textRef -->
        <sourceRef><![CDATA[urlDocer]]></sourceRef>
        <targetRef>block104_urlDocerInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:figura_professionale var type: textRef -->
        <sourceRef><![CDATA[figura_professionale]]></sourceRef>
        <targetRef>block104_figura_professionaleInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:abilita_rest var type: textRef -->
        <sourceRef><![CDATA[abilita_rest]]></sourceRef>
        <targetRef>block104_abilita_restInput</targetRef>
</dataInputAssociation>

<!-- lista props -->
<dataInputAssociation><!-- var type: string -->
        <targetRef>block104_nameInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[Creazione determina]]></from>
            <to xsi:type="tFormalExpression">block104_nameInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: string -->
        <targetRef>block104_descriptionInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[note]]></from>
            <to xsi:type="tFormalExpression">block104_descriptionInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: bool -->
        <targetRef>block104_waitForCompletionInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[true]]></from>
            <to xsi:type="tFormalExpression">block104_waitForCompletionInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: string -->
        <targetRef>block104_processNameInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[Creazione determina Base1.1]]></from>
            <to xsi:type="tFormalExpression">block104_processNameInput</to>
        </assignment>
</dataInputAssociation>

<!-- lista outputs -->
<dataOutputAssociation>
        <sourceRef>block104_valoriOutput</sourceRef>
        <targetRef>valori_determina</targetRef>
</dataOutputAssociation>
<dataOutputAssociation>
        <sourceRef>block104_fascicolo_anticorruzioneOutput</sourceRef>
        <targetRef>fascicolo_anticorruzione</targetRef>
</dataOutputAssociation>
<dataOutputAssociation>
        <sourceRef>block104_istanceProvvedimentoOutput</sourceRef>
        <targetRef>istanceProvvedimento</targetRef>
</dataOutputAssociation>
<dataOutputAssociation>
        <sourceRef>block104_tipo_determinaOutput</sourceRef>
        <targetRef>tipo_determina</targetRef>
</dataOutputAssociation>
<dataOutputAssociation>
        <sourceRef>block104_lista_risposteOutput</sourceRef>
        <targetRef>lista_risposte</targetRef>
</dataOutputAssociation>
<dataOutputAssociation>
        <sourceRef>block104_importoLiquidazioneOutput</sourceRef>
        <targetRef>importoLiquidazione</targetRef>
</dataOutputAssociation>
<dataOutputAssociation>
        <sourceRef>block104_variabiliOutput</sourceRef>
        <targetRef>variabili_determina</targetRef>
</dataOutputAssociation>
<dataOutputAssociation>
        <sourceRef>block104_doc_determinaOutput</sourceRef>
        <targetRef>doc_determina</targetRef>
</dataOutputAssociation>
<dataOutputAssociation>
        <sourceRef>block104_isRischioOutput</sourceRef>
        <targetRef>isRischio</targetRef>
</dataOutputAssociation>
<dataOutputAssociation>
        <sourceRef>block104_docnum_principaleOutput</sourceRef>
        <targetRef>docnum_determina</targetRef>
</dataOutputAssociation>
<dataOutputAssociation>
        <sourceRef>block104_lista_domandeOutput</sourceRef>
        <targetRef>lista_domande</targetRef>
</dataOutputAssociation>
    
</callActivity>




<scriptTask id="block121" scriptFormat="http://www.mvel.org/2.0" name="Gestione fascicolo annullamento" isForCompensation="false" >
    <script>
        <![CDATA[



/************** start user script ***************/

java.util.Date date= new java.util.Date(); 
java.util.Calendar cal = java.util.Calendar.getInstance();
cal.setTime(date);
int year = cal.get(java.util.Calendar.YEAR);

java.lang.String anno = Integer.toString(year);

fascicolo_annullamento.ANNO_FASCICOLO=anno;

/**************  end user script  ***************/



//[auto-insert]
kcontext.setVariable("fascicolo",null);
kcontext.setVariable("fascicolo",fascicolo);
kcontext.setVariable("fascicolo_annullamento",null);
kcontext.setVariable("fascicolo_annullamento",fascicolo_annullamento);

        ]]>
    </script>
</scriptTask>



<scriptTask id="block119" scriptFormat="http://www.mvel.org/2.0" name="Gestione fascicolo e data esecutivita" isForCompensation="false" >
    <script>
        <![CDATA[



/************** start user script ***************/

java.util.Date date= new java.util.Date(); 
java.util.Calendar cal = java.util.Calendar.getInstance();
cal.setTime(date);
int year = cal.get(java.util.Calendar.YEAR);
int month = cal.get(java.util.Calendar.MONTH);
int day = cal.get(java.util.Calendar.DAY_OF_MONTH);

java.lang.String anno = Integer.toString(year);
java.lang.String mese = Integer.toString(month+1);

fascicolo_determina.ANNO_FASCICOLO=anno;

doc_determina_copy = new java.util.HashMap();

doc_determina_copy.put("DOCNUM",doc_determina.DOCNUM);
doc_determina_copy.put("DOCNAME",doc_determina.DOCNAME);
doc_determina_copy.put("TYPE_ID",doc_determina.TYPE_ID);
doc_determina_copy.put("TIPO_COMPONENTE",doc_determina.TIPO_COMPONENTE);

if(tipo_determina=="senza_impegno"){
	doc_determina_copy.put("data_esec_atto",doc_determina.D_REGISTRAZ);
}else{
	doc_determina_copy.put("data_esec_atto",doc_visto.CREATION_DATE);
}


/**************  end user script  ***************/



//[auto-insert]
kcontext.setVariable("fascicolo",null);
kcontext.setVariable("fascicolo",fascicolo);
kcontext.setVariable("fascicolo_determina",null);
kcontext.setVariable("fascicolo_determina",fascicolo_determina);
kcontext.setVariable("doc_determina_copy",null);
kcontext.setVariable("doc_determina_copy",doc_determina_copy);

        ]]>
    </script>
</scriptTask>



<scriptTask id="block163" scriptFormat="http://www.mvel.org/2.0" name="Gestione modifica oggetto determina" isForCompensation="false" >
    <script>
        <![CDATA[



//[auto-insert]
Descrizione=descrizione;

/************** start user script ***************/

java.lang.String oggetto = variabili_determina.Intoggetto;
Descrizione=instanceId+" - "+oggetto.toUpperCase();

//mittenti_registrazione = ...
mittenti_registrazione.get(0).CodiceAmministrazioneUo=variabili_determina.IntCodUffProp;
mittenti_registrazione.get(0).DenominazioneUo=variabili_determina.IntDescrUffProp;

//listaCorrelati_precedenti = ...
listaCorrelati_precedenti.clear();

/**************  end user script  ***************/

//[auto-insert]
//instanceId, mittenti_registrazione, listaCorrelati_precedenti
kcontext.setVariable("instanceId",null);
kcontext.setVariable("instanceId",instanceId);
kcontext.setVariable("mittenti_registrazione",null);
kcontext.setVariable("mittenti_registrazione",mittenti_registrazione);
kcontext.setVariable("listaCorrelati_precedenti",null);
kcontext.setVariable("listaCorrelati_precedenti",listaCorrelati_precedenti);



//[auto-insert]
kcontext.setVariable("descrizione",null);
kcontext.setVariable("descrizione",Descrizione);

        ]]>
    </script>
</scriptTask>



<sequenceFlow id="con_34599" sourceRef="block211" targetRef="block212">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[valori_determina.TipoDetermina=="Liquidazione Contributo"]]>
    </conditionExpression>
</sequenceFlow>

<inclusiveGateway id="block92" name="gateway-merge" gatewayDirection="Converging"></inclusiveGateway>
<sequenceFlow id="con_33993" sourceRef="block112" targetRef="block113">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34089" sourceRef="block110" targetRef="block131">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<inclusiveGateway id="block143" name="gateway-merge" gatewayDirection="Converging"></inclusiveGateway>
<sequenceFlow id="con_33951" sourceRef="block108" targetRef="block40">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<inclusiveGateway id="block7" name="gateway-branching" gatewayDirection="Diverging"></inclusiveGateway>
<sequenceFlow id="con_34401" sourceRef="block172" targetRef="block80">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34593" sourceRef="block210" targetRef="block25">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34467" sourceRef="block185" targetRef="block104">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_33819" sourceRef="block75" targetRef="block59">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<scriptTask id="block185" scriptFormat="http://www.mvel.org/2.0" name="Gestione BS e timeline" isForCompensation="false" >
    <script>
        <![CDATA[



/************** start user script ***************/

businessState = "statoDetermina1";
timeline_state = 1;

/**************  end user script  ***************/

//[auto-insert]
//Business State (businessState), timeline_state
kcontext.setVariable("businessState",null);
kcontext.setVariable("businessState",businessState);
kcontext.setVariable("timeline_state",null);
kcontext.setVariable("timeline_state",timeline_state);



        ]]>
    </script>
</scriptTask>



<task id="block160" name="Recupera gruppi" tns:taskName="DocerJMS" >
    <ioSpecification>

        <dataInput id="block160_TaskNameInput" name="TaskName" />
        <dataInput id="block160_GroupIdInput" name="GroupId" />

        <dataInput id="block160_Operation" name="operation" />

            <dataInput id="block160_userTokenInput" name="userToken" />
            <dataInput id="block160_IdGruppoInput" name="IdGruppo" />
            <dataInput id="block160_IdUtenteInput" name="IdUtente" />
        
            <dataOutput id="block160_listaGruppiOutput" name="listaGruppi" />
            <dataOutput id="block160_userTokenOutput" name="userToken" />
           

        <inputSet>
            <dataInputRefs>block160_Operation</dataInputRefs>
            <dataInputRefs>block160_TaskNameInput</dataInputRefs>
            <dataInputRefs>block160_GroupIdInput</dataInputRefs>
                <dataInputRefs>block160_userTokenInput</dataInputRefs>
                <dataInputRefs>block160_IdGruppoInput</dataInputRefs>
                <dataInputRefs>block160_IdUtenteInput</dataInputRefs>
        </inputSet>
        
        <outputSet>
                <dataOutputRefs>block160_listaGruppiOutput</dataOutputRefs>
                <dataOutputRefs>block160_userTokenOutput</dataOutputRefs>
                
         </outputSet>

    </ioSpecification>
                <dataInputAssociation>
                            <sourceRef>systemToken</sourceRef>
                            <targetRef>block160_userTokenInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef>figura_professionale</sourceRef>
                            <targetRef>block160_IdGruppoInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef></sourceRef>
                            <targetRef>block160_IdUtenteInput</targetRef>
                            

                </dataInputAssociation>

      <dataInputAssociation>
        <targetRef>block160_GroupIdInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression"></from>
           <to xsi:type="tFormalExpression">block160_GroupIdInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>block160_TaskNameInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">Recupera gruppi</from>
           <to xsi:type="tFormalExpression">block160_TaskNameInput</to>
        </assignment>
      </dataInputAssociation>
    <dataInputAssociation>
        <targetRef>block160_Operation</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression">RecuperaGruppi</from>
            <to xsi:type="tFormalExpression">block160_Operation</to>
        </assignment>
    </dataInputAssociation>


            <dataOutputAssociation>
                            <sourceRef>block160_listaGruppiOutput</sourceRef>
                            <targetRef>gruppi_parent_proponente</targetRef>
                            
            </dataOutputAssociation>
            <dataOutputAssociation>
                            <sourceRef>block160_userTokenOutput</sourceRef>
                            <targetRef>systemToken</targetRef>
                            
            </dataOutputAssociation>
           
      <potentialOwner>
        <resourceAssignmentExpression>
           <formalExpression></formalExpression>
        </resourceAssignmentExpression>
      </potentialOwner>
</task>

<task id="block173" name="UpdateDocument" tns:taskName="DocerJMS" >
    <ioSpecification>

        <dataInput id="block173_TaskNameInput" name="TaskName" />
        <dataInput id="block173_GroupIdInput" name="GroupId" />
        <dataInput id="block173_Operation" name="operation" />

            <dataInput id="block173_userTokenInput" name="userToken" />
            <dataInput id="block173_mittenteInput" name="mittente" />
            <dataInput id="block173_documentInput" name="document" />
            <dataInput id="block173_destinatarioInput" name="destinatario" />
        
            <dataOutput id="block173_userTokenOutput" name="userToken" />
            <dataOutput id="block173_documentOutput" name="document" />
           

        <inputSet>
            <dataInputRefs>block173_TaskNameInput</dataInputRefs>
            <dataInputRefs>block173_GroupIdInput</dataInputRefs>
            <dataInputRefs>block173_Operation</dataInputRefs>
                <dataInputRefs>block173_userTokenInput</dataInputRefs>
                <dataInputRefs>block173_mittenteInput</dataInputRefs>
                <dataInputRefs>block173_documentInput</dataInputRefs>
                <dataInputRefs>block173_destinatarioInput</dataInputRefs>
        </inputSet>
        
        <outputSet>
                <dataOutputRefs>block173_userTokenOutput</dataOutputRefs>
                <dataOutputRefs>block173_documentOutput</dataOutputRefs>
                
         </outputSet>

    </ioSpecification>
                <dataInputAssociation>
                            <sourceRef>systemToken</sourceRef>
                            <targetRef>block173_userTokenInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef></sourceRef>
                            <targetRef>block173_mittenteInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef>doc_determina_copy</sourceRef>
                            <targetRef>block173_documentInput</targetRef>

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef></sourceRef>
                            <targetRef>block173_destinatarioInput</targetRef>
                            

                </dataInputAssociation>

      <dataInputAssociation>
        <targetRef>block173_GroupIdInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression"></from>
           <to xsi:type="tFormalExpression">block173_GroupIdInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>block173_TaskNameInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">UpdateDocument</from>
           <to xsi:type="tFormalExpression">block173_TaskNameInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>block173_Operation</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">AggiornaDocumento</from>
           <to xsi:type="tFormalExpression">block173_Operation</to>
        </assignment>
      </dataInputAssociation>


            <dataOutputAssociation>
                            <sourceRef>block173_userTokenOutput</sourceRef>
                            <targetRef>systemToken</targetRef>
                            
            </dataOutputAssociation>
            <dataOutputAssociation>
                            <sourceRef>block173_documentOutput</sourceRef>
                            <targetRef>doc_determina</targetRef>
            </dataOutputAssociation>
           
      <potentialOwner>
        <resourceAssignmentExpression>
           <formalExpression></formalExpression>
        </resourceAssignmentExpression>
      </potentialOwner>
</task>

<sequenceFlow id="con_34197" sourceRef="block146" targetRef="block147">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_33783" sourceRef="block48" targetRef="block49">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[determina_numerata=="si"]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34137" sourceRef="block132" targetRef="block133">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[gestione_omissis=="no"]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34191" sourceRef="block145" targetRef="block146">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34233" sourceRef="block151" targetRef="block155">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[gruppi_parent_proponente.size()==0]]>
    </conditionExpression>
</sequenceFlow>

<scriptTask id="block188" scriptFormat="http://www.mvel.org/2.0" name="Gestione BS e timeline" isForCompensation="false" >
    <script>
        <![CDATA[



/************** start user script ***************/

businessState = "statoDetermina4";
timeline_state = 4;


aclFascicolo=new java.util.HashMap();
aclFascicolo.put("@structure","role");
aclFascicolo.put("identity",figura_professionale2);
_tmp2_=aclFascicolo;

/**************  end user script  ***************/

//[auto-insert]
//Business State (businessState), timeline_state, _tmp2_
kcontext.setVariable("businessState",null);
kcontext.setVariable("businessState",businessState);
kcontext.setVariable("timeline_state",null);
kcontext.setVariable("timeline_state",timeline_state);
kcontext.setVariable("_tmp2_",null);
kcontext.setVariable("_tmp2_",_tmp2_);



        ]]>
    </script>
</scriptTask>



<inclusiveGateway id="block98" name="gateway-merge" gatewayDirection="Converging"></inclusiveGateway>
<sequenceFlow id="con_33939" sourceRef="block67" targetRef="block107">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34077" sourceRef="block129" targetRef="block46">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<scriptTask id="block192" scriptFormat="http://www.mvel.org/2.0" name="Gestione BS e timeline" isForCompensation="false" >
    <script>
        <![CDATA[



/************** start user script ***************/

businessState = "statoDetermina7";
timeline_state = 7;

/**************  end user script  ***************/

//[auto-insert]
//Business State (businessState), timeline_state
kcontext.setVariable("businessState",null);
kcontext.setVariable("businessState",businessState);
kcontext.setVariable("timeline_state",null);
kcontext.setVariable("timeline_state",timeline_state);



        ]]>
    </script>
</scriptTask>



<sequenceFlow id="con_34389" sourceRef="block79" targetRef="block171">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<inclusiveGateway id="block83" name="gateway-branching" gatewayDirection="Diverging"></inclusiveGateway>
<sequenceFlow id="con_33873" sourceRef="block3" targetRef="block17">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<scriptTask id="block111" scriptFormat="http://www.mvel.org/2.0" name="Script-task gestione degli omissis" isForCompensation="false" >
    <script>
        <![CDATA[



/************** start user script ***************/

System.out.println("XXXXX "+omissis);
java.util.HashMap variabili_determina_omissis = new java.util.HashMap(variabili_determina);
java.util.List oms = new java.util.ArrayList();
if(omissis.contains(",")){
	String[] parts =omissis.split(",");
	String s = new java.lang.Object();
	foreach (s : parts) {
		oms.add(s);
	}
}else if(omissis!=""){
        oms.add(omissis);
}

System.out.println("XXXXX "+oms.toString());
java.lang.String ele = new java.lang.String();
foreach(ele : oms){
		if(ele=="AttoStakehold"){
         	variabili_determina_omissis[ele]="Dato atto che risulta necessario/utile dare informazione del presente provvedimento ai seguenti soggetti: OMISSIS";
		}else if(ele=="DispDispBenef"){
			variabili_determina_omissis[ele]="Di dare atto che i beneficiari del presente atto sono i seguenti: OMISSIS";
		}else if(ele=="DispDispContr"){
			variabili_determina_omissis[ele]="Di dare atto che i contraenti del presente atto sono i seguenti soggetti: OMISSIS";
		}else if(ele=="DispDispDestin"){
			variabili_determina_omissis[ele]="Di dare atto che i destinatari del presente atto sono i seguenti soggetti: OMISSIS";
		}else{
			variabili_determina_omissis[ele]="OMISSIS";
		}		
}
System.out.println("XXXXX "+variabili_determina_omissis.toString());

/**************  end user script  ***************/



//[auto-insert]
kcontext.setVariable("variabili_determina_omissis",null);
kcontext.setVariable("variabili_determina_omissis",variabili_determina_omissis);

        ]]>
    </script>
</scriptTask>



<sequenceFlow id="con_34209" sourceRef="block149" targetRef="block151">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34395" sourceRef="block171" targetRef="block172">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<scriptTask id="block142" scriptFormat="http://www.mvel.org/2.0" name="Gestione indice destinatari" isForCompensation="false" >
    <script>
        <![CDATA[



/************** start user script ***************/

exit="no";
int i = Integer.parseInt(indice_destinatari);

if(destinatari_notifica.size()==i){
     exit="si";
}else{
     destinatario = destinatari_notifica.get(i);
     i=i+1;
     indice_destinatari=Integer.toString(i);
}

/**************  end user script  ***************/



//[auto-insert]
kcontext.setVariable("destinatario",null);
kcontext.setVariable("destinatario",destinatario);
kcontext.setVariable("exit",null);
kcontext.setVariable("exit",exit);
kcontext.setVariable("indice_destinatari",null);
kcontext.setVariable("indice_destinatari",indice_destinatari);

        ]]>
    </script>
</scriptTask>



<inclusiveGateway id="block167" name="gateway-merge" gatewayDirection="Converging"></inclusiveGateway>
<userTask id="block158" name="HT-Generico_block158" >


    <ioSpecification>

        <dataInput id="block158_TaskNameInput" name="TaskName" />
        <dataInput id="block158_GroupIdInput" name="GroupId" />
        <dataInput id="block158_SwimlaneActorIdInput" name="SwimlaneActorId" />

            <dataInput id="block158_commentInput" name="comment" />
            <dataInput id="block158_figura_professionaleInput" name="figura_professionale" />
            <dataInput id="block158_descrizione_ufficioCompetenzaInput" name="descrizione_ufficioCompetenza" />
            <dataInput id="block158_doc_determinaInput" name="doc_determina" />
        
            <dataOutput id="block158_reasonOutput" name="reason" />
            <dataOutput id="block158_userTokenOutput" name="userToken" />
            <dataOutput id="block158_figura_professionaleOutput" name="figura_professionale" />
            <dataOutput id="block158_descrizione_ufficioCompetenzaOutput" name="descrizione_ufficioCompetenza" />
           

        <inputSet>
            <dataInputRefs>block158_SwimlaneActorIdInput</dataInputRefs>
            <dataInputRefs>block158_TaskNameInput</dataInputRefs>
            <dataInputRefs>block158_GroupIdInput</dataInputRefs>
                <dataInputRefs>block158_commentInput</dataInputRefs>
                <dataInputRefs>block158_figura_professionaleInput</dataInputRefs>
                <dataInputRefs>block158_descrizione_ufficioCompetenzaInput</dataInputRefs>
                <dataInputRefs>block158_doc_determinaInput</dataInputRefs>
        </inputSet>
        
        <outputSet>
                <dataOutputRefs>block158_reasonOutput</dataOutputRefs>
                <dataOutputRefs>block158_userTokenOutput</dataOutputRefs>
                <dataOutputRefs>block158_figura_professionaleOutput</dataOutputRefs>
                <dataOutputRefs>block158_descrizione_ufficioCompetenzaOutput</dataOutputRefs>
                
         </outputSet>

    </ioSpecification>
                <dataInputAssociation>
                                <targetRef>block158_commentInput</targetRef>
                                <assignment>
                                <from xsi:type="tFormalExpression"><![CDATA[]]></from>
                                <to xsi:type="tFormalExpression">block158_commentInput</to>
                                </assignment>

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef>figura_professionale</sourceRef>
                            <targetRef>block158_figura_professionaleInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef>descrizione_ufficioCompetenza</sourceRef>
                            <targetRef>block158_descrizione_ufficioCompetenzaInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef>doc_determina</sourceRef>
                            <targetRef>block158_doc_determinaInput</targetRef>

                </dataInputAssociation>

      <dataInputAssociation>
          <sourceRef>Amministratori.identity</sourceRef>
          <targetRef>block158_GroupIdInput</targetRef>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>block158_TaskNameInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression">"Modifica gruppi non esistenti"</from>
           <to xsi:type="tFormalExpression">block158_TaskNameInput</to>
        </assignment>
      </dataInputAssociation>
            <dataOutputAssociation>
                    <sourceRef>block158_reasonOutput</sourceRef>
                    <targetRef></targetRef>
            </dataOutputAssociation>
            <dataOutputAssociation>
                    <sourceRef>block158_userTokenOutput</sourceRef>
                    <targetRef>humanToken</targetRef>
            </dataOutputAssociation>
            <dataOutputAssociation>
                    <sourceRef>block158_figura_professionaleOutput</sourceRef>
                    <targetRef>figura_professionale</targetRef>
            </dataOutputAssociation>
            <dataOutputAssociation>
                    <sourceRef>block158_descrizione_ufficioCompetenzaOutput</sourceRef>
                    <targetRef>descrizione_ufficioCompetenza</targetRef>
            </dataOutputAssociation>
           
      <potentialOwner>
        <resourceAssignmentExpression>
           <formalExpression></formalExpression>
        </resourceAssignmentExpression>
      </potentialOwner>
</userTask>

<sequenceFlow id="con_33975" sourceRef="block6" targetRef="block50">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[verifica_dirigente=="annulla"]]>
    </conditionExpression>
</sequenceFlow>

<task id="block66" name="UpdateDocument" tns:taskName="DocerJMS" >
    <ioSpecification>

        <dataInput id="block66_TaskNameInput" name="TaskName" />
        <dataInput id="block66_GroupIdInput" name="GroupId" />
        <dataInput id="block66_Operation" name="operation" />

            <dataInput id="block66_userTokenInput" name="userToken" />
            <dataInput id="block66_mittenteInput" name="mittente" />
            <dataInput id="block66_documentInput" name="document" />
            <dataInput id="block66_destinatarioInput" name="destinatario" />
        
            <dataOutput id="block66_userTokenOutput" name="userToken" />
            <dataOutput id="block66_documentOutput" name="document" />
           

        <inputSet>
            <dataInputRefs>block66_TaskNameInput</dataInputRefs>
            <dataInputRefs>block66_GroupIdInput</dataInputRefs>
            <dataInputRefs>block66_Operation</dataInputRefs>
                <dataInputRefs>block66_userTokenInput</dataInputRefs>
                <dataInputRefs>block66_mittenteInput</dataInputRefs>
                <dataInputRefs>block66_documentInput</dataInputRefs>
                <dataInputRefs>block66_destinatarioInput</dataInputRefs>
        </inputSet>
        
        <outputSet>
                <dataOutputRefs>block66_userTokenOutput</dataOutputRefs>
                <dataOutputRefs>block66_documentOutput</dataOutputRefs>
                
         </outputSet>

    </ioSpecification>
                <dataInputAssociation>
                            <sourceRef>systemToken</sourceRef>
                            <targetRef>block66_userTokenInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef></sourceRef>
                            <targetRef>block66_mittenteInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef>doc_determina_copy</sourceRef>
                            <targetRef>block66_documentInput</targetRef>

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef></sourceRef>
                            <targetRef>block66_destinatarioInput</targetRef>
                            

                </dataInputAssociation>

      <dataInputAssociation>
        <targetRef>block66_GroupIdInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression"></from>
           <to xsi:type="tFormalExpression">block66_GroupIdInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>block66_TaskNameInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">UpdateDocument</from>
           <to xsi:type="tFormalExpression">block66_TaskNameInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>block66_Operation</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">AggiornaDocumento</from>
           <to xsi:type="tFormalExpression">block66_Operation</to>
        </assignment>
      </dataInputAssociation>


            <dataOutputAssociation>
                            <sourceRef>block66_userTokenOutput</sourceRef>
                            <targetRef>systemToken</targetRef>
                            
            </dataOutputAssociation>
            <dataOutputAssociation>
                            <sourceRef>block66_documentOutput</sourceRef>
                            <targetRef>doc_determina</targetRef>
            </dataOutputAssociation>
           
      <potentialOwner>
        <resourceAssignmentExpression>
           <formalExpression></formalExpression>
        </resourceAssignmentExpression>
      </potentialOwner>
</task>

<task id="block213" name="Fascicolazione Secondaria Determina" tns:taskName="DocerJMS" >
    <ioSpecification>

        <dataInput id="block213_TaskNameInput" name="TaskName" />
        <dataInput id="block213_GroupIdInput" name="GroupId" />
        <dataInput id="block213_Operation" name="operation" />

            <dataInput id="block213_userTokenInput" name="userToken" />
            <dataInput id="block213_fascicoliSecondariInput" name="fascicoliSecondari" />
            <dataInput id="block213_fascicoloInput" name="fascicolo" />
            <dataInput id="block213_documentInput" name="document" />
        
            <dataOutput id="block213_userTokenOutput" name="userToken" />
            <dataOutput id="block213_documentOutput" name="document" />
           

        <inputSet>
            <dataInputRefs>block213_TaskNameInput</dataInputRefs>
            <dataInputRefs>block213_GroupIdInput</dataInputRefs>
            <dataInputRefs>block213_Operation</dataInputRefs>
                <dataInputRefs>block213_userTokenInput</dataInputRefs>
                <dataInputRefs>block213_fascicoliSecondariInput</dataInputRefs>
                <dataInputRefs>block213_fascicoloInput</dataInputRefs>
                <dataInputRefs>block213_documentInput</dataInputRefs>
        </inputSet>
        
        <outputSet>
                <dataOutputRefs>block213_userTokenOutput</dataOutputRefs>
                <dataOutputRefs>block213_documentOutput</dataOutputRefs>
                
         </outputSet>

    </ioSpecification>
                <dataInputAssociation>
                            <sourceRef>systemToken</sourceRef>
                            <targetRef>block213_userTokenInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef>fascicoli_secondari</sourceRef>
                            <targetRef>block213_fascicoliSecondariInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef>fascicolo_determina</sourceRef>
                            <targetRef>block213_fascicoloInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef>doc_determina</sourceRef>
                            <targetRef>block213_documentInput</targetRef>

                </dataInputAssociation>

      <dataInputAssociation>
        <targetRef>block213_GroupIdInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression"></from>
           <to xsi:type="tFormalExpression">block213_GroupIdInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>block213_TaskNameInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">Fascicolazione Secondaria Determina</from>
           <to xsi:type="tFormalExpression">block213_TaskNameInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>block213_Operation</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">FascicolaDocumento</from>
           <to xsi:type="tFormalExpression">block213_Operation</to>
        </assignment>
      </dataInputAssociation>


            <dataOutputAssociation>
                            <sourceRef>block213_userTokenOutput</sourceRef>
                            <targetRef>systemToken</targetRef>
                            
            </dataOutputAssociation>
            <dataOutputAssociation>
                            <sourceRef>block213_documentOutput</sourceRef>
                            <targetRef>doc_determina</targetRef>
            </dataOutputAssociation>
           
      <potentialOwner>
        <resourceAssignmentExpression>
           <formalExpression></formalExpression>
        </resourceAssignmentExpression>
      </potentialOwner>
</task>

<task id="block88" name="Aggiorna riferimenti" tns:taskName="DocerJMS" >
    <ioSpecification>

        <dataInput id="block88_TaskNameInput" name="TaskName" />
        <dataInput id="block88_GroupIdInput" name="GroupId" />
        <dataInput id="block88_Operation" name="operation" />

            <dataInput id="block88_userTokenInput" name="userToken" />
            <dataInput id="block88_referenceDocsInput" name="referenceDocs" />
            <dataInput id="block88_documentInput" name="document" />
        
            <dataOutput id="block88_deltaOutput" name="delta" />
            <dataOutput id="block88_userTokenOutput" name="userToken" />
            <dataOutput id="block88_resultsOutput" name="results" />
            <dataOutput id="block88_firstOutput" name="first" />
           

        <inputSet>
            <dataInputRefs>block88_TaskNameInput</dataInputRefs>
            <dataInputRefs>block88_GroupIdInput</dataInputRefs>
            <dataInputRefs>block88_Operation</dataInputRefs>
                <dataInputRefs>block88_userTokenInput</dataInputRefs>
                <dataInputRefs>block88_referenceDocsInput</dataInputRefs>
                <dataInputRefs>block88_documentInput</dataInputRefs>
        </inputSet>
        
        <outputSet>
                <dataOutputRefs>block88_deltaOutput</dataOutputRefs>
                <dataOutputRefs>block88_userTokenOutput</dataOutputRefs>
                <dataOutputRefs>block88_resultsOutput</dataOutputRefs>
                <dataOutputRefs>block88_firstOutput</dataOutputRefs>
                
         </outputSet>

    </ioSpecification>
                <dataInputAssociation>
                            <sourceRef>systemToken</sourceRef>
                            <targetRef>block88_userTokenInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef>lista_referenziati</sourceRef>
                            <targetRef>block88_referenceDocsInput</targetRef>

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef>doc_determina</sourceRef>
                            <targetRef>block88_documentInput</targetRef>

                </dataInputAssociation>

      <dataInputAssociation>
        <targetRef>block88_GroupIdInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression"></from>
           <to xsi:type="tFormalExpression">block88_GroupIdInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>block88_TaskNameInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">Aggiorna riferimenti</from>
           <to xsi:type="tFormalExpression">block88_TaskNameInput</to>
        </assignment>
      </dataInputAssociation>
    <dataInputAssociation>
        <targetRef>block88_Operation</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression">AggiornaRiferimenti</from>
            <to xsi:type="tFormalExpression">block88_Operation</to>
        </assignment>
    </dataInputAssociation>



            <dataOutputAssociation>
                            <sourceRef>block88_deltaOutput</sourceRef>
                            <targetRef></targetRef>
            </dataOutputAssociation>
            <dataOutputAssociation>
                            <sourceRef>block88_userTokenOutput</sourceRef>
                            <targetRef>systemToken</targetRef>
                            
            </dataOutputAssociation>
            <dataOutputAssociation>
                            <sourceRef>block88_resultsOutput</sourceRef>
                            <targetRef></targetRef>
            </dataOutputAssociation>
            <dataOutputAssociation>
                            <sourceRef>block88_firstOutput</sourceRef>
                            <targetRef></targetRef>
            </dataOutputAssociation>
           
      <potentialOwner>
        <resourceAssignmentExpression>
           <formalExpression></formalExpression>
        </resourceAssignmentExpression>
      </potentialOwner>
</task>

<sequenceFlow id="con_34407" sourceRef="block173" targetRef="block97">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34551" sourceRef="block193" targetRef="block183">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34011" sourceRef="block115" targetRef="block116">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34383" sourceRef="block100" targetRef="block119">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34587" sourceRef="block167" targetRef="block211">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_33789" sourceRef="block49" targetRef="block51">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34521" sourceRef="block6" targetRef="block191">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[verifica_dirigente=="dirigente"]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34617" sourceRef="block116" targetRef="block46">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<inclusiveGateway id="block89" name="gateway-branching" gatewayDirection="Diverging"></inclusiveGateway>

<callActivity id="block17" isForCompensation="false" independent="false" waitForCompletion="true" name="AMD Registrazione UD Determina (automatica)" calledElementByName="AMD_RegistrazioneInternaUD2.1" >
<!-- ioSpecification -->
<ioSpecification>
    <dataInput id="block17_fascicoloPrimarioInput" name="fascicoloPrimario" />
    <dataInput id="block17_tipo_firmaInput" name="tipo_firma" />
    <dataInput id="block17_proto_autoInput" name="proto_auto" />
    <dataInput id="block17_instanceNameInput" name="instanceName" />
    <dataInput id="block17_registro_sceltoInput" name="registro_scelto" />
    <dataInput id="block17_destinatari_registrazioneInput" name="destinatari_registrazione" />
    <dataInput id="block17_tipo_firma_registrazioneInput" name="tipo_firma_registrazione" />
    <dataInput id="block17_humanTokenInput" name="humanToken" />
    <dataInput id="block17_fascicolazioneInput" name="fascicolazione" />
    <dataInput id="block17_instanceIdInput" name="instanceId" />
    <dataInput id="block17_oggetto_registroInput" name="oggetto_registro" />
    <dataInput id="block17_destinatariInput" name="destinatari" />
    <dataInput id="block17_testo_attivitaInput" name="testo_attivita" />
    <dataInput id="block17_outcomeInput" name="outcome" />
    <dataInput id="block17_oggetto_protocolloInput" name="oggetto_protocollo" />
    <dataInput id="block17_registrazioneInput" name="registrazione" />
    <dataInput id="block17_fascicoliSecondariInput" name="fascicoliSecondari" />
    <dataInput id="block17_systemTokenInput" name="systemToken" />
    <dataInput id="block17_mittentiInput" name="mittenti" />
    <dataInput id="block17_firmatari_registrazioneInput" name="firmatari_registrazione" />
    <dataInput id="block17_assegnazione_registroInput" name="assegnazione_registro" />
    <dataInput id="block17_descrizioneInput" name="descrizione" />
    <dataInput id="block17_firmatariInput" name="firmatari" />
    <dataInput id="block17_protocollazioneInput" name="protocollazione" />
    <dataInput id="block17_fascicolo_fissoInput" name="fascicolo_fisso" />
    <dataInput id="block17_canalePECInput" name="canalePEC" />
    <dataInput id="block17_mittenti_registrazioneInput" name="mittenti_registrazione" />
    <dataInput id="block17_lista_registriInput" name="lista_registri" />
    <dataInput id="block17_docnum_principaleInput" name="docnum_principale" />
    <dataInput id="block17_figura_professionaleInput" name="figura_professionale" />
    <dataInput id="block17_reg_autoInput" name="reg_auto" />
    <dataInput id="block17_assegnazioneInput" name="assegnazione" />
    <dataInput id="block17_nameInput" name="name" />
    <dataInput id="block17_descriptionInput" name="description" />
    <dataInput id="block17_processNameInput" name="processName" />
    <dataOutput id="block17_principaleOutput" name="principale" />

    <inputSet>
        <dataInputRefs>block17_fascicoloPrimarioInput</dataInputRefs>
        <dataInputRefs>block17_tipo_firmaInput</dataInputRefs>
        <dataInputRefs>block17_proto_autoInput</dataInputRefs>
        <dataInputRefs>block17_instanceNameInput</dataInputRefs>
        <dataInputRefs>block17_registro_sceltoInput</dataInputRefs>
        <dataInputRefs>block17_destinatari_registrazioneInput</dataInputRefs>
        <dataInputRefs>block17_tipo_firma_registrazioneInput</dataInputRefs>
        <dataInputRefs>block17_humanTokenInput</dataInputRefs>
        <dataInputRefs>block17_fascicolazioneInput</dataInputRefs>
        <dataInputRefs>block17_instanceIdInput</dataInputRefs>
        <dataInputRefs>block17_oggetto_registroInput</dataInputRefs>
        <dataInputRefs>block17_destinatariInput</dataInputRefs>
        <dataInputRefs>block17_testo_attivitaInput</dataInputRefs>
        <dataInputRefs>block17_outcomeInput</dataInputRefs>
        <dataInputRefs>block17_oggetto_protocolloInput</dataInputRefs>
        <dataInputRefs>block17_registrazioneInput</dataInputRefs>
        <dataInputRefs>block17_fascicoliSecondariInput</dataInputRefs>
        <dataInputRefs>block17_systemTokenInput</dataInputRefs>
        <dataInputRefs>block17_mittentiInput</dataInputRefs>
        <dataInputRefs>block17_firmatari_registrazioneInput</dataInputRefs>
        <dataInputRefs>block17_assegnazione_registroInput</dataInputRefs>
        <dataInputRefs>block17_descrizioneInput</dataInputRefs>
        <dataInputRefs>block17_firmatariInput</dataInputRefs>
        <dataInputRefs>block17_protocollazioneInput</dataInputRefs>
        <dataInputRefs>block17_fascicolo_fissoInput</dataInputRefs>
        <dataInputRefs>block17_canalePECInput</dataInputRefs>
        <dataInputRefs>block17_mittenti_registrazioneInput</dataInputRefs>
        <dataInputRefs>block17_lista_registriInput</dataInputRefs>
        <dataInputRefs>block17_docnum_principaleInput</dataInputRefs>
        <dataInputRefs>block17_figura_professionaleInput</dataInputRefs>
        <dataInputRefs>block17_reg_autoInput</dataInputRefs>
        <dataInputRefs>block17_assegnazioneInput</dataInputRefs>
        <dataInputRefs>block17_nameInput</dataInputRefs>
        <dataInputRefs>block17_descriptionInput</dataInputRefs>
        <dataInputRefs>block17_processNameInput</dataInputRefs>
    </inputSet>

    <outputSet>
        <dataOutputRefs>block17_principaleOutput</dataOutputRefs>
    </outputSet>
</ioSpecification>

<!-- lista inputs -->
<dataInputAssociation><!-- k:fascicoloPrimario var type: fascicolo -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block17_fascicoloPrimarioInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:tipo_firma var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block17_tipo_firmaInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:proto_auto var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block17_proto_autoInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:instanceName var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block17_instanceNameInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:registro_scelto var type: registro -->
        <sourceRef><![CDATA[registro_determina]]></sourceRef>
        <targetRef>block17_registro_sceltoInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:destinatari_registrazione var type: soggetto -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block17_destinatari_registrazioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:tipo_firma_registrazione var type: textRef -->
        <sourceRef><![CDATA[tipo_firma_registrazione]]></sourceRef>
        <targetRef>block17_tipo_firma_registrazioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:humanToken var type: userToken -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block17_humanTokenInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:fascicolazione var type: script -->
        <sourceRef><![CDATA["no";]]></sourceRef>
        <targetRef>block17_fascicolazioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:instanceId var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block17_instanceIdInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:oggetto_registro var type: script -->
        <sourceRef><![CDATA[org.apache.commons.lang.StringEscapeUtils.escapeHtml(variabili_determina.Intoggetto);]]></sourceRef>
        <targetRef>block17_oggetto_registroInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:destinatari var type: soggetto -->
        <sourceRef><![CDATA[destinatari_registrazione]]></sourceRef>
        <targetRef>block17_destinatariInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:testo_attivita var type: script -->
        <sourceRef><![CDATA["Determina";]]></sourceRef>
        <targetRef>block17_testo_attivitaInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:outcome var type: object -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block17_outcomeInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:oggetto_protocollo var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block17_oggetto_protocolloInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:registrazione var type: script -->
        <sourceRef><![CDATA["si";]]></sourceRef>
        <targetRef>block17_registrazioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:fascicoliSecondari var type: fascicolo -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block17_fascicoliSecondariInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:systemToken var type: userToken -->
        <sourceRef><![CDATA[systemToken]]></sourceRef>
        <targetRef>block17_systemTokenInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:mittenti var type: soggetto -->
        <sourceRef><![CDATA[mittenti_registrazione]]></sourceRef>
        <targetRef>block17_mittentiInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:firmatari_registrazione var type: soggetto -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block17_firmatari_registrazioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:assegnazione_registro var type: object -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block17_assegnazione_registroInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:descrizione var type: script -->
        <sourceRef><![CDATA["Registrazione UD Determina";]]></sourceRef>
        <targetRef>block17_descrizioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:firmatari var type: soggetto -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block17_firmatariInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:protocollazione var type: script -->
        <sourceRef><![CDATA["no";]]></sourceRef>
        <targetRef>block17_protocollazioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:fascicolo_fisso var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block17_fascicolo_fissoInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:canalePEC var type: channel -->
        <targetRef>block17_canalePECInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[]]></from>
            <to xsi:type="tFormalExpression">block17_canalePECInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- k:mittenti_registrazione var type: soggetto -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block17_mittenti_registrazioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:lista_registri var type: textRef -->
        <sourceRef><![CDATA[lista_registri]]></sourceRef>
        <targetRef>block17_lista_registriInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:docnum_principale var type: script -->
        <sourceRef><![CDATA[doc_determina.DOCNUM;]]></sourceRef>
        <targetRef>block17_docnum_principaleInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:figura_professionale var type: textRef -->
        <sourceRef><![CDATA[figura_professionale2]]></sourceRef>
        <targetRef>block17_figura_professionaleInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:reg_auto var type: script -->
        <sourceRef><![CDATA["si";]]></sourceRef>
        <targetRef>block17_reg_autoInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:assegnazione var type: object -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block17_assegnazioneInput</targetRef>
</dataInputAssociation>

<!-- lista props -->
<dataInputAssociation><!-- var type: string -->
        <targetRef>block17_nameInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[AMD Registrazione UD Determina (automatica)]]></from>
            <to xsi:type="tFormalExpression">block17_nameInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: string -->
        <targetRef>block17_descriptionInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[note]]></from>
            <to xsi:type="tFormalExpression">block17_descriptionInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: string -->
        <targetRef>block17_processNameInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[AMD_RegistrazioneInternaUD2.1]]></from>
            <to xsi:type="tFormalExpression">block17_processNameInput</to>
        </assignment>
</dataInputAssociation>

<!-- lista outputs -->
<dataOutputAssociation>
        <sourceRef>block17_principaleOutput</sourceRef>
        <targetRef>doc_determina</targetRef>
</dataOutputAssociation>
    
</callActivity>




<scriptTask id="block140" scriptFormat="http://www.mvel.org/2.0" name="Gestione mail e destinatari notifica" isForCompensation="false" >
    <script>
        <![CDATA[



/************** start user script ***************/

org.joda.time.format.DateTimeFormatter fm = null;
org.joda.time.DateTime date = null;
java.lang.String isoDate = doc_determina.D_REGISTRAZ;
if (!isoDate.matches(".*T.*[Z+-].*")) { //altrimenti considera locale
    System.out.println("XXXXX 1: "+isoDate);
    fm = org.joda.time.format.ISODateTimeFormat.localDateOptionalTimeParser();
    date = fm.parseDateTime(isoDate);
    int x = org.joda.time.DateTimeZone.getDefault().getOffset(date.getMillis());
    date = date.minusMillis(x);
} else {
    System.out.println("XXXXX 2: "+isoDate);
    fm = org.joda.time.format.ISODateTimeFormat.dateTimeParser();
    date = fm.parseDateTime(isoDate);
}
date = date.toDateTime(org.joda.time.DateTimeZone.forID("Europe/Rome"));
System.out.println("XXXXX FINAL: "+org.joda.time.format.ISODateTimeFormat.dateTime().print(date));

java.text.DateFormat df = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss",java.util.Locale.ITALIAN);
java.text.DateFormat df2 = new java.text.SimpleDateFormat("yyyy-MM-dd");
java.util.Date dataRegistrazione = df.parse(org.joda.time.format.ISODateTimeFormat.dateTime().print(date));
java.lang.String OLD_FORMAT = "yyyy-MM-dd";
java.lang.String NEW_FORMAT = "dd/MM/yyyy";
java.lang.String oldDateString = df2.format(dataRegistrazione);
java.text.SimpleDateFormat sdf = new java.text.SimpleDateFormat(OLD_FORMAT);
java.util.Date d = sdf.parse(oldDateString);
sdf.applyPattern(NEW_FORMAT);
java.lang.String dReg = sdf.format(d);
System.out.println("XXXXX FINAL dReg: "+dReg);

org.joda.time.format.DateTimeFormatter fm2 = null;
org.joda.time.DateTime date2 = null;
java.lang.String isoDate2 = doc_determina.DATA_ESEC_ATTO;
if (!isoDate2.matches(".*T.*[Z+-].*")) { //altrimenti considera locale
    System.out.println("XXXXX 1: "+isoDate2);
    fm2 = org.joda.time.format.ISODateTimeFormat.localDateOptionalTimeParser();
    date2 = fm2.parseDateTime(isoDate2);
    int x = org.joda.time.DateTimeZone.getDefault().getOffset(date2.getMillis());
    date2 = date2.minusMillis(x);
} else {
    System.out.println("XXXXX 2: "+isoDate2);
    fm2 = org.joda.time.format.ISODateTimeFormat.dateTimeParser();
    date2 = fm2.parseDateTime(isoDate2);
}
date2 = date2.toDateTime(org.joda.time.DateTimeZone.forID("Europe/Rome"));
System.out.println("XXXXX FINAL: "+org.joda.time.format.ISODateTimeFormat.dateTime().print(date2));

java.util.Date dataProtocollazione = df.parse(org.joda.time.format.ISODateTimeFormat.dateTime().print(date2));
java.lang.String OLD_FORMAT = "yyyy-MM-dd";
java.lang.String NEW_FORMAT = "dd/MM/yyyy";
java.lang.String oldDateString2 = df2.format(dataProtocollazione);
java.text.SimpleDateFormat sdf2 = new java.text.SimpleDateFormat(OLD_FORMAT);
java.util.Date d2 = sdf2.parse(oldDateString2);
sdf2.applyPattern(NEW_FORMAT);
java.lang.String dProt = sdf2.format(d2);
System.out.println("XXXXX FINAL dProt: "+dProt);


java.lang.String oggettoMail = "";
java.lang.String corpoMail = "";

oggettoMail="Esecutivita' della determina "+doc_determina.N_REGISTRAZ+" del "+dReg;
corpoMail="Si comunica che la determina "+doc_determina.N_REGISTRAZ+" del "+dReg+" recante oggetto "+doc_determina.INTOGGETTO+" e' divenuta esecutiva in data "+dProt+" e sara' pubblicata all'albo pretorio per 15 giorni.";

oggettoNotifica=oggettoMail;
corpoNotifica=corpoMail;

java.util.ArrayList destinatari = new java.util.ArrayList();

if(valori_determina.stakeholder!=null){
     java.util.HashMap dest = new java.util.HashMap();
     foreach(dest : valori_determina.stakeholder){
          if(dest.IndirizzoTelematico!=""){
               destinatari.add(dest);
          }
     }
}
if(valori_determina.destinatari!=null){
     java.util.HashMap dest = new java.util.HashMap();
     foreach(dest : valori_determina.destinatari){
          if(dest.IndirizzoTelematico!=""){
               destinatari.add(dest);
          }
     }
}
if(valori_determina.beneficiari!=null){
     java.util.HashMap dest = new java.util.HashMap();
     foreach(dest : valori_determina.beneficiari){
          if(dest.IndirizzoTelematico!=""){
               destinatari.add(dest);
          }
     }
}
if(valori_determina.contraenti!=null){
     java.util.HashMap dest = new java.util.HashMap();
     foreach(dest : valori_determina.contraenti){
          if(dest.IndirizzoTelematico!=""){
               destinatari.add(dest);
          }
     }
}
destinatari_notifica=destinatari;

/**************  end user script  ***************/



//[auto-insert]
kcontext.setVariable("oggettoNotifica",null);
kcontext.setVariable("oggettoNotifica",oggettoNotifica);
kcontext.setVariable("corpoNotifica",null);
kcontext.setVariable("corpoNotifica",corpoNotifica);
kcontext.setVariable("destinatari_notifica",null);
kcontext.setVariable("destinatari_notifica",destinatari_notifica);

        ]]>
    </script>
</scriptTask>



<sequenceFlow id="con_33855" sourceRef="block90" targetRef="block65">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34299" sourceRef="block162" targetRef="block91">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34605" sourceRef="block212" targetRef="block213">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<inclusiveGateway id="block100" name="gateway-merge" gatewayDirection="Converging"></inclusiveGateway>
<scriptTask id="block159" scriptFormat="http://www.mvel.org/2.0" name="Gestione nuova figura professionale" isForCompensation="false" >
    <script>
        <![CDATA[



//[auto-insert]
mittenti=mittenti_registrazione;
destinatari=destinatari_registrazione;

/************** start user script ***************/

if(!java.lang.String.class.isInstance(figura_professionale)) {
    String str = Integer.toString(figura_professionale);
    figura_professionale=str;
}

figura_professionale_responsabile=figura_professionale;

mittenti.get(0).CodiceAmministrazioneUo=figura_professionale;
mittenti.get(0).DenominazioneUo=descrizione_ufficioCompetenza;

destinatari.get(0).CodiceAmministrazioneUo=figura_professionale;
destinatari.get(0).DenominazioneUo=descrizione_ufficioCompetenza;

/**************  end user script  ***************/



//[auto-insert]
kcontext.setVariable("figura_professionale",null);
kcontext.setVariable("figura_professionale",figura_professionale);
kcontext.setVariable("figura_professionale_responsabile",null);
kcontext.setVariable("figura_professionale_responsabile",figura_professionale_responsabile);
kcontext.setVariable("mittenti_registrazione",null);
kcontext.setVariable("mittenti_registrazione",mittenti);
kcontext.setVariable("destinatari_registrazione",null);
kcontext.setVariable("destinatari_registrazione",destinatari);

        ]]>
    </script>
</scriptTask>



<sequenceFlow id="con_34575" sourceRef="block208" targetRef="block210">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<inclusiveGateway id="block81" name="gateway-merge" gatewayDirection="Converging"></inclusiveGateway>
<scriptTask id="block49" scriptFormat="http://www.mvel.org/2.0" name="Tale metadato contiene le motivazioni dell'annullamento esplicitate dal dirigente" isForCompensation="false" >
    <script>
        <![CDATA[



/************** start user script ***************/

java.util.HashMap doc = new java.util.HashMap();
doc.put("DOCNUM",doc_determina.DOCNUM);
doc.put("DOCNAME",doc_determina.DOCNAME);
doc.put("TYPE_ID",doc_determina.TYPE_ID);
doc.put("TIPO_COMPONENTE",doc_determina.TIPO_COMPONENTE);

doc.put("annullamento","Annullata");

doc_determina_copy=doc;

/**************  end user script  ***************/



//[auto-insert]
kcontext.setVariable("doc_determina_copy",null);
kcontext.setVariable("doc_determina_copy",doc_determina_copy);

        ]]>
    </script>
</scriptTask>



<sequenceFlow id="con_34149" sourceRef="block136" targetRef="block134">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<scriptTask id="block161" scriptFormat="http://www.mvel.org/2.0" name="Gestione dei nuovi Default" isForCompensation="false" >
    <script>
        <![CDATA[



/************** start user script ***************/

Default.identity=figura_professionale;
approvatori_proponente.get(0).gruppo=figura_professionale;


java.lang.Integer myLevel=gruppi_parent_proponente.size() - 1;
java.lang.Integer i = myLevel;

java.lang.String trovato = "false";
java.lang.String grp = "";
java.lang.String test = "";
figura_professionale2 = "";
nomeGruppo_dirigente = "";

for (i =myLevel; i >= 0; i--) { 
   System.out.println("XXXXX "+i);
   java.util.HashMap group = new java.util.HashMap();
   foreach(group : gruppi_parent_proponente){
          if(group.get("livello")==i){
                System.out.println("XXXXX "+group.get("idGruppo"));
                grp = group.get("idGruppo");
                test = grp.substring(grp.length() - 2);
                System.out.println("XXXXX "+test);
                if(test=="00" && trovato=="false"){
                      System.out.println("XXXXX trovato "+grp);
                      trovato="true";
                      figura_professionale2=grp;
                      nomeGruppo_dirigente=group.get("nomeGruppo");
                }
          }
   }
}
if(figura_professionale2==""){
  figura_professionale2=gruppoDirigenteDefault;
  nomeGruppo_dirigente=nome_gruppoDirigenteDefault;
}

Default2.identity=figura_professionale2;
variabili_determina.IntCodSett=figura_professionale2;
variabili_determina.IntDescrSett=nomeGruppo_dirigente;

approvatori_dirigente.get(0).gruppo=figura_professionale2;
approvatori_responsabile.get(0).gruppo=figura_professionale_responsabile;

/**************  end user script  ***************/



//[auto-insert]
kcontext.setVariable("Default",null);
kcontext.setVariable("Default",Default);
kcontext.setVariable("approvatori_proponente",null);
kcontext.setVariable("approvatori_proponente",approvatori_proponente);
kcontext.setVariable("figura_professionale2",null);
kcontext.setVariable("figura_professionale2",figura_professionale2);
kcontext.setVariable("Default2",null);
kcontext.setVariable("Default2",Default2);
kcontext.setVariable("variabili_determina",null);
kcontext.setVariable("variabili_determina",variabili_determina);
kcontext.setVariable("approvatori_dirigente",null);
kcontext.setVariable("approvatori_dirigente",approvatori_dirigente);
kcontext.setVariable("approvatori_responsabile",null);
kcontext.setVariable("approvatori_responsabile",approvatori_responsabile);

        ]]>
    </script>
</scriptTask>



<sequenceFlow id="con_33897" sourceRef="block93" targetRef="block92">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_33957" sourceRef="block109" targetRef="block108">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34143" sourceRef="block135" targetRef="block136">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>


<callActivity id="block217" isForCompensation="false" independent="false" waitForCompletion="true" name="Creazione determina" calledElementByName="Creazione determina Base1.1" >
<!-- ioSpecification -->
<ioSpecification>
    <dataInput id="block217_valoriInput" name="valori" />
    <dataInput id="block217_noteInput" name="note" />
    <dataInput id="block217_systemTokenInput" name="systemToken" />
    <dataInput id="block217_nameHTInput" name="nameHT" />
    <dataInput id="block217_listaCorrelati_precedentiInput" name="listaCorrelati_precedenti" />
    <dataInput id="block217_tipologieInput" name="tipologie" />
    <dataInput id="block217_template_determinaInput" name="template_determina" />
    <dataInput id="block217_descrizioneInput" name="descrizione" />
    <dataInput id="block217_tipo_determinaInput" name="tipo_determina" />
    <dataInput id="block217_variabiliInput" name="variabili" />
    <dataInput id="block217_docnum_principaleInput" name="docnum_principale" />
    <dataInput id="block217_urlDocerInput" name="urlDocer" />
    <dataInput id="block217_figura_professionaleInput" name="figura_professionale" />
    <dataInput id="block217_abilita_restInput" name="abilita_rest" />
    <dataInput id="block217_nameInput" name="name" />
    <dataInput id="block217_descriptionInput" name="description" />
    <dataInput id="block217_waitForCompletionInput" name="waitForCompletion" />
    <dataInput id="block217_processNameInput" name="processName" />
    <dataOutput id="block217_valoriOutput" name="valori" />
    <dataOutput id="block217_fascicolo_anticorruzioneOutput" name="fascicolo_anticorruzione" />
    <dataOutput id="block217_istanceProvvedimentoOutput" name="istanceProvvedimento" />
    <dataOutput id="block217_tipo_determinaOutput" name="tipo_determina" />
    <dataOutput id="block217_lista_risposteOutput" name="lista_risposte" />
    <dataOutput id="block217_importoLiquidazioneOutput" name="importoLiquidazione" />
    <dataOutput id="block217_variabiliOutput" name="variabili" />
    <dataOutput id="block217_doc_determinaOutput" name="doc_determina" />
    <dataOutput id="block217_isRischioOutput" name="isRischio" />
    <dataOutput id="block217_docnum_principaleOutput" name="docnum_principale" />
    <dataOutput id="block217_lista_domandeOutput" name="lista_domande" />

    <inputSet>
        <dataInputRefs>block217_valoriInput</dataInputRefs>
        <dataInputRefs>block217_noteInput</dataInputRefs>
        <dataInputRefs>block217_systemTokenInput</dataInputRefs>
        <dataInputRefs>block217_nameHTInput</dataInputRefs>
        <dataInputRefs>block217_listaCorrelati_precedentiInput</dataInputRefs>
        <dataInputRefs>block217_tipologieInput</dataInputRefs>
        <dataInputRefs>block217_template_determinaInput</dataInputRefs>
        <dataInputRefs>block217_descrizioneInput</dataInputRefs>
        <dataInputRefs>block217_tipo_determinaInput</dataInputRefs>
        <dataInputRefs>block217_variabiliInput</dataInputRefs>
        <dataInputRefs>block217_docnum_principaleInput</dataInputRefs>
        <dataInputRefs>block217_urlDocerInput</dataInputRefs>
        <dataInputRefs>block217_figura_professionaleInput</dataInputRefs>
        <dataInputRefs>block217_abilita_restInput</dataInputRefs>
        <dataInputRefs>block217_nameInput</dataInputRefs>
        <dataInputRefs>block217_descriptionInput</dataInputRefs>
        <dataInputRefs>block217_waitForCompletionInput</dataInputRefs>
        <dataInputRefs>block217_processNameInput</dataInputRefs>
    </inputSet>

    <outputSet>
        <dataOutputRefs>block217_valoriOutput</dataOutputRefs>
        <dataOutputRefs>block217_fascicolo_anticorruzioneOutput</dataOutputRefs>
        <dataOutputRefs>block217_istanceProvvedimentoOutput</dataOutputRefs>
        <dataOutputRefs>block217_tipo_determinaOutput</dataOutputRefs>
        <dataOutputRefs>block217_lista_risposteOutput</dataOutputRefs>
        <dataOutputRefs>block217_importoLiquidazioneOutput</dataOutputRefs>
        <dataOutputRefs>block217_variabiliOutput</dataOutputRefs>
        <dataOutputRefs>block217_doc_determinaOutput</dataOutputRefs>
        <dataOutputRefs>block217_isRischioOutput</dataOutputRefs>
        <dataOutputRefs>block217_docnum_principaleOutput</dataOutputRefs>
        <dataOutputRefs>block217_lista_domandeOutput</dataOutputRefs>
    </outputSet>
</ioSpecification>

<!-- lista inputs -->
<dataInputAssociation><!-- k:valori var type: object -->
        <sourceRef><![CDATA[valori_determina]]></sourceRef>
        <targetRef>block217_valoriInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:note var type: textRef -->
        <sourceRef><![CDATA[note]]></sourceRef>
        <targetRef>block217_noteInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:systemToken var type: userToken -->
        <sourceRef><![CDATA[systemToken]]></sourceRef>
        <targetRef>block217_systemTokenInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:nameHT var type: object -->
        <sourceRef><![CDATA[nameHT]]></sourceRef>
        <targetRef>block217_nameHTInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:listaCorrelati_precedenti var type: document -->
        <sourceRef><![CDATA[listaCorrelati_precedenti]]></sourceRef>
        <targetRef>block217_listaCorrelati_precedentiInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:tipologie var type: textRef -->
        <sourceRef><![CDATA[tipologiePrincipale]]></sourceRef>
        <targetRef>block217_tipologieInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:template_determina var type: document -->
        <sourceRef><![CDATA[template_determina]]></sourceRef>
        <targetRef>block217_template_determinaInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:descrizione var type: script -->
        <sourceRef><![CDATA["Creazione determina - Ufficio: "+descrizione_ufficioCompetenza;]]></sourceRef>
        <targetRef>block217_descrizioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:tipo_determina var type: textRef -->
        <sourceRef><![CDATA[tipo_determina]]></sourceRef>
        <targetRef>block217_tipo_determinaInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:variabili var type: object -->
        <sourceRef><![CDATA[variabili_determina]]></sourceRef>
        <targetRef>block217_variabiliInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:docnum_principale var type: textRef -->
        <sourceRef><![CDATA[docnum_determina]]></sourceRef>
        <targetRef>block217_docnum_principaleInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:urlDocer var type: textRef -->
        <sourceRef><![CDATA[urlDocer]]></sourceRef>
        <targetRef>block217_urlDocerInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:figura_professionale var type: textRef -->
        <sourceRef><![CDATA[figura_professionale]]></sourceRef>
        <targetRef>block217_figura_professionaleInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:abilita_rest var type: textRef -->
        <sourceRef><![CDATA[abilita_rest]]></sourceRef>
        <targetRef>block217_abilita_restInput</targetRef>
</dataInputAssociation>

<!-- lista props -->
<dataInputAssociation><!-- var type: string -->
        <targetRef>block217_nameInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[Creazione determina]]></from>
            <to xsi:type="tFormalExpression">block217_nameInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: string -->
        <targetRef>block217_descriptionInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[note]]></from>
            <to xsi:type="tFormalExpression">block217_descriptionInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: bool -->
        <targetRef>block217_waitForCompletionInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[true]]></from>
            <to xsi:type="tFormalExpression">block217_waitForCompletionInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: string -->
        <targetRef>block217_processNameInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[Creazione determina Base1.1]]></from>
            <to xsi:type="tFormalExpression">block217_processNameInput</to>
        </assignment>
</dataInputAssociation>

<!-- lista outputs -->
<dataOutputAssociation>
        <sourceRef>block217_valoriOutput</sourceRef>
        <targetRef>valori_determina</targetRef>
</dataOutputAssociation>
<dataOutputAssociation>
        <sourceRef>block217_fascicolo_anticorruzioneOutput</sourceRef>
        <targetRef>fascicolo_anticorruzione</targetRef>
</dataOutputAssociation>
<dataOutputAssociation>
        <sourceRef>block217_istanceProvvedimentoOutput</sourceRef>
        <targetRef>istanceProvvedimento</targetRef>
</dataOutputAssociation>
<dataOutputAssociation>
        <sourceRef>block217_tipo_determinaOutput</sourceRef>
        <targetRef>tipo_determina</targetRef>
</dataOutputAssociation>
<dataOutputAssociation>
        <sourceRef>block217_lista_risposteOutput</sourceRef>
        <targetRef>lista_risposte</targetRef>
</dataOutputAssociation>
<dataOutputAssociation>
        <sourceRef>block217_importoLiquidazioneOutput</sourceRef>
        <targetRef>importoLiquidazione</targetRef>
</dataOutputAssociation>
<dataOutputAssociation>
        <sourceRef>block217_variabiliOutput</sourceRef>
        <targetRef>variabili_determina</targetRef>
</dataOutputAssociation>
<dataOutputAssociation>
        <sourceRef>block217_doc_determinaOutput</sourceRef>
        <targetRef>doc_determina</targetRef>
</dataOutputAssociation>
<dataOutputAssociation>
        <sourceRef>block217_isRischioOutput</sourceRef>
        <targetRef>isRischio</targetRef>
</dataOutputAssociation>
<dataOutputAssociation>
        <sourceRef>block217_docnum_principaleOutput</sourceRef>
        <targetRef>docnum_determina</targetRef>
</dataOutputAssociation>
<dataOutputAssociation>
        <sourceRef>block217_lista_domandeOutput</sourceRef>
        <targetRef>lista_domande</targetRef>
</dataOutputAssociation>
    
</callActivity>




<inclusiveGateway id="block166" name="gateway-branching" gatewayDirection="Diverging"></inclusiveGateway>
<scriptTask id="block136" scriptFormat="http://www.mvel.org/2.0" name="Gestione response organigramma" isForCompensation="false" >
    <script>
        <![CDATA[



/************** start user script ***************/

org.joda.time.format.DateTimeFormatter fm = null;
org.joda.time.DateTime date = null;
java.lang.String isoDate = doc_determina.D_REGISTRAZ;
if (!isoDate.matches(".*T.*[Z+-].*")) { //altrimenti considera locale
    System.out.println("XXXXX 1: "+isoDate);
    fm = org.joda.time.format.ISODateTimeFormat.localDateOptionalTimeParser();
    date = fm.parseDateTime(isoDate);
    int x = org.joda.time.DateTimeZone.getDefault().getOffset(date.getMillis());
    date = date.minusMillis(x);
} else {
    System.out.println("XXXXX 2: "+isoDate);
    fm = org.joda.time.format.ISODateTimeFormat.dateTimeParser();
    date = fm.parseDateTime(isoDate);
}
date = date.toDateTime(org.joda.time.DateTimeZone.forID("Europe/Rome"));
System.out.println("XXXXX FINAL: "+org.joda.time.format.ISODateTimeFormat.dateTime().print(date));

java.text.DateFormat df = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss",java.util.Locale.ITALIAN);
java.text.DateFormat df2 = new java.text.SimpleDateFormat("yyyy-MM-dd");
java.util.Date dataRegistrazione = df.parse(org.joda.time.format.ISODateTimeFormat.dateTime().print(date));
java.lang.String OLD_FORMAT = "yyyy-MM-dd";
java.lang.String NEW_FORMAT = "dd/MM/yyyy";
java.lang.String oldDateString = df2.format(dataRegistrazione);
java.text.SimpleDateFormat sdf = new java.text.SimpleDateFormat(OLD_FORMAT);
java.util.Date d = sdf.parse(oldDateString);
sdf.applyPattern(NEW_FORMAT);
java.lang.String dReg = sdf.format(d);

java.lang.String indirizzoUfficio = responseArray.get(0).EmailUO;
java.lang.String urlDoc = "http://"+urlDocer+"/docer/XForms?action=viewprofile&amp;docnum="+doc_determina.DOCNUM;
java.lang.String oggettoMail = "";
java.lang.String corpoMail = "";

if(indirizzoUfficio!=""){
	destinatario.put("IndirizzoTelematico",indirizzoUfficio);
	oggettoMail="Numerazione della determina "+doc_determina.INTOGGETTO;
	corpoMail="Si comunica che alla determina avente oggetto "+doc_determina.INTOGGETTO+" e' stato attribuito il numero "+doc_determina.N_REGISTRAZ+" in data "+dReg+".";
}else{
	destinatario.put("IndirizzoTelematico",indirizzoDefault);
	oggettoMail="Mancato recapito notifica istanza con id. "+instanceId+" e oggetto "+doc_determina.INTOGGETTO;
	corpoMail="Si comunica che l'invio di notifica non e' andato a buon fine in quanto il gruppo "+responseArray.get(0).CodiceUO+" non ha associato alcun indirizzo email.";
}

oggettoNotifica=oggettoMail;
corpoNotifica=corpoMail;

/**************  end user script  ***************/



//[auto-insert]
kcontext.setVariable("oggettoNotifica",null);
kcontext.setVariable("oggettoNotifica",oggettoNotifica);
kcontext.setVariable("corpoNotifica",null);
kcontext.setVariable("corpoNotifica",corpoNotifica);
kcontext.setVariable("destinatario",null);
kcontext.setVariable("destinatario",destinatario);

        ]]>
    </script>
</scriptTask>



<sequenceFlow id="con_34221" sourceRef="block153" targetRef="block154">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<inclusiveGateway id="block84" name="gateway-merge" gatewayDirection="Converging"></inclusiveGateway>
<scriptTask id="block138" scriptFormat="http://www.mvel.org/2.0" name="Gestione response organigramma" isForCompensation="false" >
    <script>
        <![CDATA[



/************** start user script ***************/

org.joda.time.format.DateTimeFormatter fm = null;
org.joda.time.DateTime date = null;
java.lang.String isoDate = doc_determina.D_REGISTRAZ;
if (!isoDate.matches(".*T.*[Z+-].*")) { //altrimenti considera locale
    System.out.println("XXXXX 1: "+isoDate);
    fm = org.joda.time.format.ISODateTimeFormat.localDateOptionalTimeParser();
    date = fm.parseDateTime(isoDate);
    int x = org.joda.time.DateTimeZone.getDefault().getOffset(date.getMillis());
    date = date.minusMillis(x);
} else {
    System.out.println("XXXXX 2: "+isoDate);
    fm = org.joda.time.format.ISODateTimeFormat.dateTimeParser();
    date = fm.parseDateTime(isoDate);
}
date = date.toDateTime(org.joda.time.DateTimeZone.forID("Europe/Rome"));
System.out.println("XXXXX FINAL: "+org.joda.time.format.ISODateTimeFormat.dateTime().print(date));

java.text.DateFormat df = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss",java.util.Locale.ITALIAN);
java.text.DateFormat df2 = new java.text.SimpleDateFormat("yyyy-MM-dd");
java.util.Date dataRegistrazione = df.parse(org.joda.time.format.ISODateTimeFormat.dateTime().print(date));
java.lang.String OLD_FORMAT = "yyyy-MM-dd";
java.lang.String NEW_FORMAT = "dd/MM/yyyy";
java.lang.String oldDateString = df2.format(dataRegistrazione);
java.text.SimpleDateFormat sdf = new java.text.SimpleDateFormat(OLD_FORMAT);
java.util.Date d = sdf.parse(oldDateString);
sdf.applyPattern(NEW_FORMAT);
java.lang.String dReg = sdf.format(d);
System.out.println("XXXXX FINAL dReg: "+dReg);

org.joda.time.format.DateTimeFormatter fm2 = null;
org.joda.time.DateTime date2 = null;
java.lang.String isoDate2 = doc_determina.DATA_ESEC_ATTO;
if (!isoDate2.matches(".*T.*[Z+-].*")) { //altrimenti considera locale
    System.out.println("XXXXX 1: "+isoDate2);
    fm2 = org.joda.time.format.ISODateTimeFormat.localDateOptionalTimeParser();
    date2 = fm2.parseDateTime(isoDate2);
    int x = org.joda.time.DateTimeZone.getDefault().getOffset(date2.getMillis());
    date2 = date2.minusMillis(x);
} else {
    System.out.println("XXXXX 2: "+isoDate2);
    fm2 = org.joda.time.format.ISODateTimeFormat.dateTimeParser();
    date2 = fm2.parseDateTime(isoDate2);
}
date2 = date2.toDateTime(org.joda.time.DateTimeZone.forID("Europe/Rome"));
System.out.println("XXXXX FINAL: "+org.joda.time.format.ISODateTimeFormat.dateTime().print(date2));

java.util.Date dataProtocollazione = df.parse(org.joda.time.format.ISODateTimeFormat.dateTime().print(date2));
java.lang.String OLD_FORMAT = "yyyy-MM-dd";
java.lang.String NEW_FORMAT = "dd/MM/yyyy";
java.lang.String oldDateString2 = df2.format(dataProtocollazione);
java.text.SimpleDateFormat sdf2 = new java.text.SimpleDateFormat(OLD_FORMAT);
java.util.Date d2 = sdf2.parse(oldDateString2);
sdf2.applyPattern(NEW_FORMAT);
java.lang.String dProt = sdf2.format(d2);
System.out.println("XXXXX FINAL dProt: "+dProt);

java.lang.String indirizzoUfficio = responseArray.get(0).EmailUO;
java.lang.String urlDoc = "http://"+urlDocer+"/docer/XForms?action=viewprofile&amp;docnum="+doc_determina.DOCNUM;
java.lang.String oggettoMail = "";
java.lang.String corpoMail = "";

if(indirizzoUfficio!=""){
     destinatario.put("IndirizzoTelematico",indirizzoUfficio);
     oggettoMail="Esecutivita' della determina "+doc_determina.N_REGISTRAZ+" del "+dReg;
     corpoMail="Si comunica che la determina "+doc_determina.N_REGISTRAZ+" del "+dReg+" recante oggetto "+doc_determina.INTOGGETTO+" e' divenuta esecutiva in data "+dProt+".";
}else{
     destinatario.put("IndirizzoTelematico",indirizzoDefault);
     oggettoMail="Mancato recapito notifica istanza con id. "+instanceId+" e oggetto "+doc_determina.INTOGGETTO;
     corpoMail="Si comunica che l'invio di notifica non e' andato a buon fine in quanto il gruppo "+responseArray.get(0).CodiceUO+" non ha associato alcun indirizzo email.";
}

oggettoNotifica=oggettoMail;
corpoNotifica=corpoMail;

/**************  end user script  ***************/



//[auto-insert]
kcontext.setVariable("destinatario",null);
kcontext.setVariable("destinatario",destinatario);
kcontext.setVariable("oggettoNotifica",null);
kcontext.setVariable("oggettoNotifica",oggettoNotifica);
kcontext.setVariable("corpoNotifica",null);
kcontext.setVariable("corpoNotifica",corpoNotifica);

        ]]>
    </script>
</scriptTask>



<sequenceFlow id="con_34293" sourceRef="block104" targetRef="block162">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<scriptTask id="block65" scriptFormat="http://www.mvel.org/2.0" name="Set metadata determina e set determina numerata no" isForCompensation="false" >
    <script>
        <![CDATA[



/************** start user script ***************/

java.util.HashMap doc = new java.util.HashMap();
doc.put("DOCNUM",doc_determina.DOCNUM);
doc.put("DOCNAME",doc_determina.DOCNAME);
doc.put("TYPE_ID",doc_determina.TYPE_ID);
doc.put("TIPO_COMPONENTE",doc_determina.TIPO_COMPONENTE);

if(tipo_determina=="con_impegno_spese"){
       doc.put("TIPO_DETERMINA","Con impegno di spesa (Spese)");
}
if(tipo_determina=="con_impegno_investimenti"){
       doc.put("TIPO_DETERMINA","Con impegno di spesa (Investimenti)");
}
if(tipo_determina=="senza_impegno"){
       doc.put("TIPO_DETERMINA","Senza impegno di spesa");
}
if(tipo_determina=="entrate_spese"){
       doc.put("TIPO_DETERMINA","Con entrate e spese");
}
if(tipo_determina=="solo_entrate"){
       doc.put("TIPO_DETERMINA","Con entrate");
}
if(tipo_determina=="entrate_investimenti"){
       doc.put("TIPO_DETERMINA","Con entrate e investimenti");
}

doc_determina_copy = doc;

determina_numerata="no";

docnum_determina=doc_determina.DOCNUM;

/**************  end user script  ***************/



//[auto-insert]
kcontext.setVariable("doc_determina_copy",null);
kcontext.setVariable("doc_determina_copy",doc_determina_copy);
kcontext.setVariable("determina_numerata",null);
kcontext.setVariable("determina_numerata",determina_numerata);
kcontext.setVariable("docnum_determina",null);
kcontext.setVariable("docnum_determina",docnum_determina);

        ]]>
    </script>
</scriptTask>



<scriptTask id="block109" scriptFormat="http://www.mvel.org/2.0" name="Script-task gestione figura professionale" isForCompensation="false" >
    <script>
        <![CDATA[



//[auto-insert]
mittenti=mittenti_registrazione;
destinatari=destinatari_registrazione;

/************** start user script ***************/

if(!java.lang.String.class.isInstance(figura_professionale)) {
    System.out.println("XXXXX object is not a String");
    String str = Integer.toString(figura_professionale);
    figura_professionale=str;
}

System.out.println(figura_professionale);
figura_professionale_responsabile=figura_professionale;

mittenti.get(0).CodiceAmministrazioneUo=figura_professionale;
mittenti.get(0).DenominazioneUo=descrizione_ufficioCompetenza;

destinatari.get(0).CodiceAmministrazioneUo=figura_professionale;
destinatari.get(0).DenominazioneUo=descrizione_ufficioCompetenza;

Amministratori.identity=figura_professionale_amministratori;

/**************  end user script  ***************/



//[auto-insert]
kcontext.setVariable("figura_professionale",null);
kcontext.setVariable("figura_professionale",figura_professionale);
kcontext.setVariable("figura_professionale_responsabile",null);
kcontext.setVariable("figura_professionale_responsabile",figura_professionale_responsabile);
kcontext.setVariable("mittenti_registrazione",null);
kcontext.setVariable("mittenti_registrazione",mittenti);
kcontext.setVariable("figura_professionale_amministratori",null);
kcontext.setVariable("figura_professionale_amministratori",figura_professionale_amministratori);
kcontext.setVariable("Amministratori",null);
kcontext.setVariable("Amministratori",Amministratori);
kcontext.setVariable("destinatari_registrazione",null);
kcontext.setVariable("destinatari_registrazione",destinatari);

        ]]>
    </script>
</scriptTask>



<sequenceFlow id="con_33915" sourceRef="block48" targetRef="block98">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[determina_numerata=="no"]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_33963" sourceRef="block5" targetRef="block48">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<userTask id="block79" name="HT-Generico_block79" >


    <ioSpecification>

        <dataInput id="block79_TaskNameInput" name="TaskName" />
        <dataInput id="block79_GroupIdInput" name="GroupId" />
        <dataInput id="block79_SwimlaneActorIdInput" name="SwimlaneActorId" />

            <dataInput id="block79_controllo_responsabileInput" name="controllo_responsabile" />
            <dataInput id="block79_commentInput" name="comment" />
        
            <dataOutput id="block79_reasonOutput" name="reason" />
            <dataOutput id="block79_userTokenOutput" name="userToken" />
            <dataOutput id="block79_controllo_responsabileOutput" name="controllo_responsabile" />
           

        <inputSet>
            <dataInputRefs>block79_SwimlaneActorIdInput</dataInputRefs>
            <dataInputRefs>block79_TaskNameInput</dataInputRefs>
            <dataInputRefs>block79_GroupIdInput</dataInputRefs>
                <dataInputRefs>block79_controllo_responsabileInput</dataInputRefs>
                <dataInputRefs>block79_commentInput</dataInputRefs>
        </inputSet>
        
        <outputSet>
                <dataOutputRefs>block79_reasonOutput</dataOutputRefs>
                <dataOutputRefs>block79_userTokenOutput</dataOutputRefs>
                <dataOutputRefs>block79_controllo_responsabileOutput</dataOutputRefs>
                
         </outputSet>

    </ioSpecification>
                <dataInputAssociation>
                            <sourceRef>controllo_responsabile</sourceRef>
                            <targetRef>block79_controllo_responsabileInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                                <targetRef>block79_commentInput</targetRef>
                                <assignment>
                                <from xsi:type="tFormalExpression"><![CDATA[]]></from>
                                <to xsi:type="tFormalExpression">block79_commentInput</to>
                                </assignment>

                </dataInputAssociation>

      <dataInputAssociation>
          <sourceRef>Default.identity</sourceRef>
          <targetRef>block79_GroupIdInput</targetRef>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>block79_TaskNameInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression">"Gestione controllo del responsabile"</from>
           <to xsi:type="tFormalExpression">block79_TaskNameInput</to>
        </assignment>
      </dataInputAssociation>
            <dataOutputAssociation>
                    <sourceRef>block79_reasonOutput</sourceRef>
                    <targetRef></targetRef>
            </dataOutputAssociation>
            <dataOutputAssociation>
                    <sourceRef>block79_userTokenOutput</sourceRef>
                    <targetRef>humanToken</targetRef>
            </dataOutputAssociation>
            <dataOutputAssociation>
                    <sourceRef>block79_controllo_responsabileOutput</sourceRef>
                    <targetRef>controllo_responsabile</targetRef>
            </dataOutputAssociation>
           
      <potentialOwner>
        <resourceAssignmentExpression>
           <formalExpression></formalExpression>
        </resourceAssignmentExpression>
      </potentialOwner>
</userTask>

<inclusiveGateway id="block152" name="gateway-merge" gatewayDirection="Converging"></inclusiveGateway>
<sequenceFlow id="con_34635" sourceRef="block217" targetRef="block163">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_33891" sourceRef="block91" targetRef="block93">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[determina_numerata=="si"]]>
    </conditionExpression>
</sequenceFlow>

<userTask id="block5" name="HT-Generico_block5" >


    <ioSpecification>

        <dataInput id="block5_TaskNameInput" name="TaskName" />
        <dataInput id="block5_GroupIdInput" name="GroupId" />
        <dataInput id="block5_SwimlaneActorIdInput" name="SwimlaneActorId" />

            <dataInput id="block5_noteInput" name="note" />
            <dataInput id="block5_commentInput" name="comment" />
            <dataInput id="block5_verifica_dirigenteInput" name="verifica_dirigente" />
            <dataInput id="block5_doc_determinaInput" name="doc_determina" />
        
            <dataOutput id="block5_reasonOutput" name="reason" />
            <dataOutput id="block5_userTokenOutput" name="userToken" />
            <dataOutput id="block5_noteOutput" name="note" />
            <dataOutput id="block5_verifica_dirigenteOutput" name="verifica_dirigente" />
           

        <inputSet>
            <dataInputRefs>block5_SwimlaneActorIdInput</dataInputRefs>
            <dataInputRefs>block5_TaskNameInput</dataInputRefs>
            <dataInputRefs>block5_GroupIdInput</dataInputRefs>
                <dataInputRefs>block5_noteInput</dataInputRefs>
                <dataInputRefs>block5_commentInput</dataInputRefs>
                <dataInputRefs>block5_verifica_dirigenteInput</dataInputRefs>
                <dataInputRefs>block5_doc_determinaInput</dataInputRefs>
        </inputSet>
        
        <outputSet>
                <dataOutputRefs>block5_reasonOutput</dataOutputRefs>
                <dataOutputRefs>block5_userTokenOutput</dataOutputRefs>
                <dataOutputRefs>block5_noteOutput</dataOutputRefs>
                <dataOutputRefs>block5_verifica_dirigenteOutput</dataOutputRefs>
                
         </outputSet>

    </ioSpecification>
                <dataInputAssociation>
                            <sourceRef>note</sourceRef>
                            <targetRef>block5_noteInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                                <targetRef>block5_commentInput</targetRef>
                                <assignment>
                                <from xsi:type="tFormalExpression"><![CDATA[]]></from>
                                <to xsi:type="tFormalExpression">block5_commentInput</to>
                                </assignment>

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef>verifica_dirigente</sourceRef>
                            <targetRef>block5_verifica_dirigenteInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef>doc_determina</sourceRef>
                            <targetRef>block5_doc_determinaInput</targetRef>

                </dataInputAssociation>

      <dataInputAssociation>
          <sourceRef>Default2.identity</sourceRef>
          <targetRef>block5_GroupIdInput</targetRef>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>block5_TaskNameInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression">"Gestione modifiche determina - Dirigente"</from>
           <to xsi:type="tFormalExpression">block5_TaskNameInput</to>
        </assignment>
      </dataInputAssociation>
            <dataOutputAssociation>
                    <sourceRef>block5_reasonOutput</sourceRef>
                    <targetRef></targetRef>
            </dataOutputAssociation>
            <dataOutputAssociation>
                    <sourceRef>block5_userTokenOutput</sourceRef>
                    <targetRef>humanToken</targetRef>
            </dataOutputAssociation>
            <dataOutputAssociation>
                    <sourceRef>block5_noteOutput</sourceRef>
                    <targetRef>note</targetRef>
            </dataOutputAssociation>
            <dataOutputAssociation>
                    <sourceRef>block5_verifica_dirigenteOutput</sourceRef>
                    <targetRef>verifica_dirigente</targetRef>
            </dataOutputAssociation>
           
      <potentialOwner>
        <resourceAssignmentExpression>
           <formalExpression></formalExpression>
        </resourceAssignmentExpression>
      </potentialOwner>
</userTask>

<task id="block128" name="UpdateDocument" tns:taskName="DocerJMS" >
    <ioSpecification>

        <dataInput id="block128_TaskNameInput" name="TaskName" />
        <dataInput id="block128_GroupIdInput" name="GroupId" />
        <dataInput id="block128_Operation" name="operation" />

            <dataInput id="block128_userTokenInput" name="userToken" />
            <dataInput id="block128_mittenteInput" name="mittente" />
            <dataInput id="block128_documentInput" name="document" />
            <dataInput id="block128_destinatarioInput" name="destinatario" />
        
            <dataOutput id="block128_userTokenOutput" name="userToken" />
            <dataOutput id="block128_documentOutput" name="document" />
           

        <inputSet>
            <dataInputRefs>block128_TaskNameInput</dataInputRefs>
            <dataInputRefs>block128_GroupIdInput</dataInputRefs>
            <dataInputRefs>block128_Operation</dataInputRefs>
                <dataInputRefs>block128_userTokenInput</dataInputRefs>
                <dataInputRefs>block128_mittenteInput</dataInputRefs>
                <dataInputRefs>block128_documentInput</dataInputRefs>
                <dataInputRefs>block128_destinatarioInput</dataInputRefs>
        </inputSet>
        
        <outputSet>
                <dataOutputRefs>block128_userTokenOutput</dataOutputRefs>
                <dataOutputRefs>block128_documentOutput</dataOutputRefs>
                
         </outputSet>

    </ioSpecification>
                <dataInputAssociation>
                            <sourceRef>systemToken</sourceRef>
                            <targetRef>block128_userTokenInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef></sourceRef>
                            <targetRef>block128_mittenteInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef>doc_testo_determina</sourceRef>
                            <targetRef>block128_documentInput</targetRef>

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef></sourceRef>
                            <targetRef>block128_destinatarioInput</targetRef>
                            

                </dataInputAssociation>

      <dataInputAssociation>
        <targetRef>block128_GroupIdInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression"></from>
           <to xsi:type="tFormalExpression">block128_GroupIdInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>block128_TaskNameInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">UpdateDocument</from>
           <to xsi:type="tFormalExpression">block128_TaskNameInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>block128_Operation</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">AggiornaDocumento</from>
           <to xsi:type="tFormalExpression">block128_Operation</to>
        </assignment>
      </dataInputAssociation>


            <dataOutputAssociation>
                            <sourceRef>block128_userTokenOutput</sourceRef>
                            <targetRef>systemToken</targetRef>
                            
            </dataOutputAssociation>
            <dataOutputAssociation>
                            <sourceRef>block128_documentOutput</sourceRef>
                            <targetRef>doc_testo_determina</targetRef>
            </dataOutputAssociation>
           
      <potentialOwner>
        <resourceAssignmentExpression>
           <formalExpression></formalExpression>
        </resourceAssignmentExpression>
      </potentialOwner>
</task>


<callActivity id="block139" isForCompensation="false" independent="false" waitForCompletion="true" name="Invio notifica esecutivita'" calledElementByName="Invio messaggio senza allegati1.0" >
<!-- ioSpecification -->
<ioSpecification>
    <dataInput id="block139_messaggioInput" name="messaggio" />
    <dataInput id="block139_mittenteInput" name="mittente" />
    <dataInput id="block139_instanceNameInput" name="instanceName" />
    <dataInput id="block139_systemTokenInput" name="systemToken" />
    <dataInput id="block139_oggettoInput" name="oggetto" />
    <dataInput id="block139_humanTokenInput" name="humanToken" />
    <dataInput id="block139_destinatarioInput" name="destinatario" />
    <dataInput id="block139_canaleMAILInput" name="canaleMAIL" />
    <dataInput id="block139_descrizioneInput" name="descrizione" />
    <dataInput id="block139_instanceIdInput" name="instanceId" />
    <dataInput id="block139___ckValueInput" name="__ckValue" />
    <dataInput id="block139_canalePECInput" name="canalePEC" />
    <dataInput id="block139_canaleJMSInput" name="canaleJMS" />
    <dataInput id="block139_outcomeInput" name="outcome" />
    <dataInput id="block139_nameInput" name="name" />
    <dataInput id="block139_descriptionInput" name="description" />
    <dataInput id="block139_waitForCompletionInput" name="waitForCompletion" />
    <dataInput id="block139_processNameInput" name="processName" />

    <inputSet>
        <dataInputRefs>block139_messaggioInput</dataInputRefs>
        <dataInputRefs>block139_mittenteInput</dataInputRefs>
        <dataInputRefs>block139_instanceNameInput</dataInputRefs>
        <dataInputRefs>block139_systemTokenInput</dataInputRefs>
        <dataInputRefs>block139_oggettoInput</dataInputRefs>
        <dataInputRefs>block139_humanTokenInput</dataInputRefs>
        <dataInputRefs>block139_destinatarioInput</dataInputRefs>
        <dataInputRefs>block139_canaleMAILInput</dataInputRefs>
        <dataInputRefs>block139_descrizioneInput</dataInputRefs>
        <dataInputRefs>block139_instanceIdInput</dataInputRefs>
        <dataInputRefs>block139___ckValueInput</dataInputRefs>
        <dataInputRefs>block139_canalePECInput</dataInputRefs>
        <dataInputRefs>block139_canaleJMSInput</dataInputRefs>
        <dataInputRefs>block139_outcomeInput</dataInputRefs>
        <dataInputRefs>block139_nameInput</dataInputRefs>
        <dataInputRefs>block139_descriptionInput</dataInputRefs>
        <dataInputRefs>block139_waitForCompletionInput</dataInputRefs>
        <dataInputRefs>block139_processNameInput</dataInputRefs>
    </inputSet>

    <outputSet>
    </outputSet>
</ioSpecification>

<!-- lista inputs -->
<dataInputAssociation><!-- k:messaggio var type: textRef -->
        <sourceRef><![CDATA[corpoNotifica]]></sourceRef>
        <targetRef>block139_messaggioInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:mittente var type: soggetto -->
        <sourceRef><![CDATA[mittente]]></sourceRef>
        <targetRef>block139_mittenteInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:instanceName var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block139_instanceNameInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:systemToken var type: userToken -->
        <sourceRef><![CDATA[systemToken]]></sourceRef>
        <targetRef>block139_systemTokenInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:oggetto var type: textRef -->
        <sourceRef><![CDATA[oggettoNotifica]]></sourceRef>
        <targetRef>block139_oggettoInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:humanToken var type: userToken -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block139_humanTokenInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:destinatario var type: soggetto -->
        <sourceRef><![CDATA[destinatario]]></sourceRef>
        <targetRef>block139_destinatarioInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:canaleMAIL var type: channel -->
        <targetRef>block139_canaleMAILInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[]]></from>
            <to xsi:type="tFormalExpression">block139_canaleMAILInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- k:descrizione var type: script -->
        <sourceRef><![CDATA["Invio notifica esecutivita'";]]></sourceRef>
        <targetRef>block139_descrizioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:instanceId var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block139_instanceIdInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:__ckValue var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block139___ckValueInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:canalePEC var type: channel -->
        <targetRef>block139_canalePECInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[]]></from>
            <to xsi:type="tFormalExpression">block139_canalePECInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- k:canaleJMS var type: channel -->
        <targetRef>block139_canaleJMSInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[]]></from>
            <to xsi:type="tFormalExpression">block139_canaleJMSInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- k:outcome var type: object -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block139_outcomeInput</targetRef>
</dataInputAssociation>

<!-- lista props -->
<dataInputAssociation><!-- var type: string -->
        <targetRef>block139_nameInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[Invio notifica esecutivita']]></from>
            <to xsi:type="tFormalExpression">block139_nameInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: string -->
        <targetRef>block139_descriptionInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[note]]></from>
            <to xsi:type="tFormalExpression">block139_descriptionInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: bool -->
        <targetRef>block139_waitForCompletionInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[true]]></from>
            <to xsi:type="tFormalExpression">block139_waitForCompletionInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: string -->
        <targetRef>block139_processNameInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[Invio messaggio senza allegati1.0]]></from>
            <to xsi:type="tFormalExpression">block139_processNameInput</to>
        </assignment>
</dataInputAssociation>

<!-- lista outputs -->
    
</callActivity>




<inclusiveGateway id="block57" name="gateway-merge" gatewayDirection="Converging"></inclusiveGateway>
<sequenceFlow id="con_34461" sourceRef="block84" targetRef="block185">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34173" sourceRef="block144" targetRef="block141">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[exit=="no"]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_33933" sourceRef="block106" targetRef="block24">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34029" sourceRef="block121" targetRef="block99">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<task id="block122" name="getRelatedDocument" tns:taskName="DocerJMS" >
    <ioSpecification>

        <dataInput id="block122_TaskNameInput" name="TaskName" />
        <dataInput id="block122_GroupIdInput" name="GroupId" />
        <dataInput id="block122_Operation" name="operation" />

            <dataInput id="block122_userTokenInput" name="userToken" />
            <dataInput id="block122_documentInput" name="document" />
        
            <dataOutput id="block122_userTokenOutput" name="userToken" />
            <dataOutput id="block122_annessiOutput" name="annessi" />
            <dataOutput id="block122_annotazioniOutput" name="annotazioni" />
            <dataOutput id="block122_allegatiOutput" name="allegati" />
            <dataOutput id="block122_documentOutput" name="document" />
           

        <inputSet>
            <dataInputRefs>block122_TaskNameInput</dataInputRefs>
            <dataInputRefs>block122_GroupIdInput</dataInputRefs>
            <dataInputRefs>block122_Operation</dataInputRefs>
                <dataInputRefs>block122_userTokenInput</dataInputRefs>
                <dataInputRefs>block122_documentInput</dataInputRefs>
        </inputSet>
        
        <outputSet>
                <dataOutputRefs>block122_userTokenOutput</dataOutputRefs>
                <dataOutputRefs>block122_annessiOutput</dataOutputRefs>
                <dataOutputRefs>block122_annotazioniOutput</dataOutputRefs>
                <dataOutputRefs>block122_allegatiOutput</dataOutputRefs>
                <dataOutputRefs>block122_documentOutput</dataOutputRefs>
                
         </outputSet>

    </ioSpecification>
                <dataInputAssociation>
                            <sourceRef>systemToken</sourceRef>
                            <targetRef>block122_userTokenInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef>doc_determina</sourceRef>
                            <targetRef>block122_documentInput</targetRef>

                </dataInputAssociation>

      <dataInputAssociation>
        <targetRef>block122_GroupIdInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression"></from>
           <to xsi:type="tFormalExpression">block122_GroupIdInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>block122_TaskNameInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">getRelatedDocument</from>
           <to xsi:type="tFormalExpression">block122_TaskNameInput</to>
        </assignment>
      </dataInputAssociation>
	  <dataInputAssociation>
        <targetRef>block122_Operation</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">RecuperaUnitaDocumentaria</from>
           <to xsi:type="tFormalExpression">block122_Operation</to>
        </assignment>
      </dataInputAssociation>

            <dataOutputAssociation>
                            <sourceRef>block122_userTokenOutput</sourceRef>
                            <targetRef>systemToken</targetRef>
                            
            </dataOutputAssociation>
            <dataOutputAssociation>
                            <sourceRef>block122_annessiOutput</sourceRef>
                            <targetRef>listaAnnessi_precedenti</targetRef>
            </dataOutputAssociation>
            <dataOutputAssociation>
                            <sourceRef>block122_annotazioniOutput</sourceRef>
                            <targetRef></targetRef>
            </dataOutputAssociation>
            <dataOutputAssociation>
                            <sourceRef>block122_allegatiOutput</sourceRef>
                            <targetRef>listaAllegati_precedenti</targetRef>
            </dataOutputAssociation>
            <dataOutputAssociation>
                            <sourceRef>block122_documentOutput</sourceRef>
                            <targetRef></targetRef>
            </dataOutputAssociation>
           
      <potentialOwner>
        <resourceAssignmentExpression>
           <formalExpression></formalExpression>
        </resourceAssignmentExpression>
      </potentialOwner>
</task>

<sequenceFlow id="con_34491" sourceRef="block187" targetRef="block182">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34101" sourceRef="block131" targetRef="block111">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34629" sourceRef="block191" targetRef="block217">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_33771" sourceRef="block24" targetRef="block31">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[esito=="si"]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_33885" sourceRef="block91" targetRef="block92">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[determina_numerata=="no"]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34263" sourceRef="block151" targetRef="block153">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[gruppi_parent_proponente.size()>0]]>
    </conditionExpression>
</sequenceFlow>


<callActivity id="block113" isForCompensation="false" independent="false" waitForCompletion="true" name="AMD Conversione UD omissis" calledElementByName="AMD_ConversioneUD2.0" >
<!-- ioSpecification -->
<ioSpecification>
    <dataInput id="block113_instanceNameInput" name="instanceName" />
    <dataInput id="block113_systemTokenInput" name="systemToken" />
    <dataInput id="block113_conversione_manualeInput" name="conversione_manuale" />
    <dataInput id="block113_humanTokenInput" name="humanToken" />
    <dataInput id="block113_abilita_ht_verificaInput" name="abilita_ht_verifica" />
    <dataInput id="block113_descrizioneInput" name="descrizione" />
    <dataInput id="block113_instanceIdInput" name="instanceId" />
    <dataInput id="block113_canalePECInput" name="canalePEC" />
    <dataInput id="block113_docnum_principaleInput" name="docnum_principale" />
    <dataInput id="block113_figura_professionaleInput" name="figura_professionale" />
    <dataInput id="block113_userInput" name="user" />
    <dataInput id="block113_outcomeInput" name="outcome" />
    <dataInput id="block113_nameInput" name="name" />
    <dataInput id="block113_descriptionInput" name="description" />
    <dataInput id="block113_waitForCompletionInput" name="waitForCompletion" />
    <dataInput id="block113_processNameInput" name="processName" />
    <dataOutput id="block113_principale_nuova_udOutput" name="principale_nuova_ud" />

    <inputSet>
        <dataInputRefs>block113_instanceNameInput</dataInputRefs>
        <dataInputRefs>block113_systemTokenInput</dataInputRefs>
        <dataInputRefs>block113_conversione_manualeInput</dataInputRefs>
        <dataInputRefs>block113_humanTokenInput</dataInputRefs>
        <dataInputRefs>block113_abilita_ht_verificaInput</dataInputRefs>
        <dataInputRefs>block113_descrizioneInput</dataInputRefs>
        <dataInputRefs>block113_instanceIdInput</dataInputRefs>
        <dataInputRefs>block113_canalePECInput</dataInputRefs>
        <dataInputRefs>block113_docnum_principaleInput</dataInputRefs>
        <dataInputRefs>block113_figura_professionaleInput</dataInputRefs>
        <dataInputRefs>block113_userInput</dataInputRefs>
        <dataInputRefs>block113_outcomeInput</dataInputRefs>
        <dataInputRefs>block113_nameInput</dataInputRefs>
        <dataInputRefs>block113_descriptionInput</dataInputRefs>
        <dataInputRefs>block113_waitForCompletionInput</dataInputRefs>
        <dataInputRefs>block113_processNameInput</dataInputRefs>
    </inputSet>

    <outputSet>
        <dataOutputRefs>block113_principale_nuova_udOutput</dataOutputRefs>
    </outputSet>
</ioSpecification>

<!-- lista inputs -->
<dataInputAssociation><!-- k:instanceName var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block113_instanceNameInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:systemToken var type: userToken -->
        <sourceRef><![CDATA[systemToken]]></sourceRef>
        <targetRef>block113_systemTokenInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:conversione_manuale var type: script -->
        <sourceRef><![CDATA["no";]]></sourceRef>
        <targetRef>block113_conversione_manualeInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:humanToken var type: userToken -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block113_humanTokenInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:abilita_ht_verifica var type: script -->
        <sourceRef><![CDATA["no";]]></sourceRef>
        <targetRef>block113_abilita_ht_verificaInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:descrizione var type: script -->
        <sourceRef><![CDATA["Conversione documento omissis";]]></sourceRef>
        <targetRef>block113_descrizioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:instanceId var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block113_instanceIdInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:canalePEC var type: channel -->
        <targetRef>block113_canalePECInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[]]></from>
            <to xsi:type="tFormalExpression">block113_canalePECInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- k:docnum_principale var type: script -->
        <sourceRef><![CDATA[doc_testo_determina.DOCNUM;]]></sourceRef>
        <targetRef>block113_docnum_principaleInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:figura_professionale var type: textRef -->
        <sourceRef><![CDATA[figura_professionale]]></sourceRef>
        <targetRef>block113_figura_professionaleInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:user var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block113_userInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:outcome var type: object -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block113_outcomeInput</targetRef>
</dataInputAssociation>

<!-- lista props -->
<dataInputAssociation><!-- var type: string -->
        <targetRef>block113_nameInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[AMD Conversione UD omissis]]></from>
            <to xsi:type="tFormalExpression">block113_nameInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: string -->
        <targetRef>block113_descriptionInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[note]]></from>
            <to xsi:type="tFormalExpression">block113_descriptionInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: bool -->
        <targetRef>block113_waitForCompletionInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[true]]></from>
            <to xsi:type="tFormalExpression">block113_waitForCompletionInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: string -->
        <targetRef>block113_processNameInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[AMD_ConversioneUD2.0]]></from>
            <to xsi:type="tFormalExpression">block113_processNameInput</to>
        </assignment>
</dataInputAssociation>

<!-- lista outputs -->
<dataOutputAssociation>
        <sourceRef>block113_principale_nuova_udOutput</sourceRef>
        <targetRef>doc_testo_determina</targetRef>
</dataOutputAssociation>
    
</callActivity>




<sequenceFlow id="con_34305" sourceRef="block163" targetRef="block89">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>


<callActivity id="block112" isForCompensation="false" independent="false" waitForCompletion="true" name="AMD Redazione omissis determina" calledElementByName="AMD_RedazioneUD_Base1.0" >
<!-- ioSpecification -->
<ioSpecification>
    <dataInput id="block112_instanceNameInput" name="instanceName" />
    <dataInput id="block112_tipologiePrincipaleInput" name="tipologiePrincipale" />
    <dataInput id="block112_tipologieAnnotazioniInput" name="tipologieAnnotazioni" />
    <dataInput id="block112_humanTokenInput" name="humanToken" />
    <dataInput id="block112_variabili_template_correlatiInput" name="variabili_template_correlati" />
    <dataInput id="block112_instanceIdInput" name="instanceId" />
    <dataInput id="block112_template_annotazioniInput" name="template_annotazioni" />
    <dataInput id="block112_template_allegatiInput" name="template_allegati" />
    <dataInput id="block112_metadati_annessoInput" name="metadati_annesso" />
    <dataInput id="block112_modificaInput" name="modifica" />
    <dataInput id="block112_outcomeInput" name="outcome" />
    <dataInput id="block112_mittenteInput" name="mittente" />
    <dataInput id="block112_systemTokenInput" name="systemToken" />
    <dataInput id="block112_template_annessiInput" name="template_annessi" />
    <dataInput id="block112_creazioneInput" name="creazione" />
    <dataInput id="block112_descrizioneInput" name="descrizione" />
    <dataInput id="block112_metadati_annotazioneInput" name="metadati_annotazione" />
    <dataInput id="block112_metadati_allegatoInput" name="metadati_allegato" />
    <dataInput id="block112_tipologieAnnessoInput" name="tipologieAnnesso" />
    <dataInput id="block112_template_principaleInput" name="template_principale" />
    <dataInput id="block112_canalePECInput" name="canalePEC" />
    <dataInput id="block112_tipologieAllegatoInput" name="tipologieAllegato" />
    <dataInput id="block112_variabili_template_principaleInput" name="variabili_template_principale" />
    <dataInput id="block112_docnum_principaleInput" name="docnum_principale" />
    <dataInput id="block112_figura_professionaleInput" name="figura_professionale" />
    <dataInput id="block112_userInput" name="user" />
    <dataInput id="block112_metadati_principaleInput" name="metadati_principale" />
    <dataInput id="block112_nameInput" name="name" />
    <dataInput id="block112_descriptionInput" name="description" />
    <dataInput id="block112_waitForCompletionInput" name="waitForCompletion" />
    <dataInput id="block112_processNameInput" name="processName" />
    <dataOutput id="block112_principaleOutput" name="principale" />

    <inputSet>
        <dataInputRefs>block112_instanceNameInput</dataInputRefs>
        <dataInputRefs>block112_tipologiePrincipaleInput</dataInputRefs>
        <dataInputRefs>block112_tipologieAnnotazioniInput</dataInputRefs>
        <dataInputRefs>block112_humanTokenInput</dataInputRefs>
        <dataInputRefs>block112_variabili_template_correlatiInput</dataInputRefs>
        <dataInputRefs>block112_instanceIdInput</dataInputRefs>
        <dataInputRefs>block112_template_annotazioniInput</dataInputRefs>
        <dataInputRefs>block112_template_allegatiInput</dataInputRefs>
        <dataInputRefs>block112_metadati_annessoInput</dataInputRefs>
        <dataInputRefs>block112_modificaInput</dataInputRefs>
        <dataInputRefs>block112_outcomeInput</dataInputRefs>
        <dataInputRefs>block112_mittenteInput</dataInputRefs>
        <dataInputRefs>block112_systemTokenInput</dataInputRefs>
        <dataInputRefs>block112_template_annessiInput</dataInputRefs>
        <dataInputRefs>block112_creazioneInput</dataInputRefs>
        <dataInputRefs>block112_descrizioneInput</dataInputRefs>
        <dataInputRefs>block112_metadati_annotazioneInput</dataInputRefs>
        <dataInputRefs>block112_metadati_allegatoInput</dataInputRefs>
        <dataInputRefs>block112_tipologieAnnessoInput</dataInputRefs>
        <dataInputRefs>block112_template_principaleInput</dataInputRefs>
        <dataInputRefs>block112_canalePECInput</dataInputRefs>
        <dataInputRefs>block112_tipologieAllegatoInput</dataInputRefs>
        <dataInputRefs>block112_variabili_template_principaleInput</dataInputRefs>
        <dataInputRefs>block112_docnum_principaleInput</dataInputRefs>
        <dataInputRefs>block112_figura_professionaleInput</dataInputRefs>
        <dataInputRefs>block112_userInput</dataInputRefs>
        <dataInputRefs>block112_metadati_principaleInput</dataInputRefs>
        <dataInputRefs>block112_nameInput</dataInputRefs>
        <dataInputRefs>block112_descriptionInput</dataInputRefs>
        <dataInputRefs>block112_waitForCompletionInput</dataInputRefs>
        <dataInputRefs>block112_processNameInput</dataInputRefs>
    </inputSet>

    <outputSet>
        <dataOutputRefs>block112_principaleOutput</dataOutputRefs>
    </outputSet>
</ioSpecification>

<!-- lista inputs -->
<dataInputAssociation><!-- k:instanceName var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block112_instanceNameInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:tipologiePrincipale var type: textRef -->
        <sourceRef><![CDATA[tipologiePrincipale]]></sourceRef>
        <targetRef>block112_tipologiePrincipaleInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:tipologieAnnotazioni var type: textRef -->
        <sourceRef><![CDATA[tipologieAnnotazione]]></sourceRef>
        <targetRef>block112_tipologieAnnotazioniInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:humanToken var type: userToken -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block112_humanTokenInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:variabili_template_correlati var type: object -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block112_variabili_template_correlatiInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:instanceId var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block112_instanceIdInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:template_annotazioni var type: document -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block112_template_annotazioniInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:template_allegati var type: document -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block112_template_allegatiInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:metadati_annesso var type: object -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block112_metadati_annessoInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:modifica var type: script -->
        <sourceRef><![CDATA["no";]]></sourceRef>
        <targetRef>block112_modificaInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:outcome var type: object -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block112_outcomeInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:mittente var type: soggetto -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block112_mittenteInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:systemToken var type: userToken -->
        <sourceRef><![CDATA[systemToken]]></sourceRef>
        <targetRef>block112_systemTokenInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:template_annessi var type: document -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block112_template_annessiInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:creazione var type: script -->
        <sourceRef><![CDATA["template";]]></sourceRef>
        <targetRef>block112_creazioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:descrizione var type: script -->
        <sourceRef><![CDATA["AMD Redazione documento omissis";]]></sourceRef>
        <targetRef>block112_descrizioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:metadati_annotazione var type: object -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block112_metadati_annotazioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:metadati_allegato var type: object -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block112_metadati_allegatoInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:tipologieAnnesso var type: textRef -->
        <sourceRef><![CDATA[tipologieAnnesso]]></sourceRef>
        <targetRef>block112_tipologieAnnessoInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:template_principale var type: document -->
        <sourceRef><![CDATA[template_determina]]></sourceRef>
        <targetRef>block112_template_principaleInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:canalePEC var type: channel -->
        <targetRef>block112_canalePECInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[]]></from>
            <to xsi:type="tFormalExpression">block112_canalePECInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- k:tipologieAllegato var type: textRef -->
        <sourceRef><![CDATA[tipologieAllegato]]></sourceRef>
        <targetRef>block112_tipologieAllegatoInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:variabili_template_principale var type: object -->
        <sourceRef><![CDATA[variabili_determina_omissis]]></sourceRef>
        <targetRef>block112_variabili_template_principaleInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:docnum_principale var type: script -->
        <sourceRef><![CDATA["";]]></sourceRef>
        <targetRef>block112_docnum_principaleInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:figura_professionale var type: textRef -->
        <sourceRef><![CDATA[figura_professionale]]></sourceRef>
        <targetRef>block112_figura_professionaleInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:user var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block112_userInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:metadati_principale var type: object -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block112_metadati_principaleInput</targetRef>
</dataInputAssociation>

<!-- lista props -->
<dataInputAssociation><!-- var type: string -->
        <targetRef>block112_nameInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[AMD Redazione omissis determina]]></from>
            <to xsi:type="tFormalExpression">block112_nameInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: string -->
        <targetRef>block112_descriptionInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[note]]></from>
            <to xsi:type="tFormalExpression">block112_descriptionInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: bool -->
        <targetRef>block112_waitForCompletionInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[true]]></from>
            <to xsi:type="tFormalExpression">block112_waitForCompletionInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: string -->
        <targetRef>block112_processNameInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[AMD_RedazioneUD_Base1.0]]></from>
            <to xsi:type="tFormalExpression">block112_processNameInput</to>
        </assignment>
</dataInputAssociation>

<!-- lista outputs -->
<dataOutputAssociation>
        <sourceRef>block112_principaleOutput</sourceRef>
        <targetRef>doc_testo_determina</targetRef>
</dataOutputAssociation>
    
</callActivity>




<task id="block172" name="UpdateDocument" tns:taskName="DocerJMS" >
    <ioSpecification>

        <dataInput id="block172_TaskNameInput" name="TaskName" />
        <dataInput id="block172_GroupIdInput" name="GroupId" />
        <dataInput id="block172_Operation" name="operation" />

            <dataInput id="block172_userTokenInput" name="userToken" />
            <dataInput id="block172_mittenteInput" name="mittente" />
            <dataInput id="block172_documentInput" name="document" />
            <dataInput id="block172_destinatarioInput" name="destinatario" />
        
            <dataOutput id="block172_userTokenOutput" name="userToken" />
            <dataOutput id="block172_documentOutput" name="document" />
           

        <inputSet>
            <dataInputRefs>block172_TaskNameInput</dataInputRefs>
            <dataInputRefs>block172_GroupIdInput</dataInputRefs>
            <dataInputRefs>block172_Operation</dataInputRefs>
                <dataInputRefs>block172_userTokenInput</dataInputRefs>
                <dataInputRefs>block172_mittenteInput</dataInputRefs>
                <dataInputRefs>block172_documentInput</dataInputRefs>
                <dataInputRefs>block172_destinatarioInput</dataInputRefs>
        </inputSet>
        
        <outputSet>
                <dataOutputRefs>block172_userTokenOutput</dataOutputRefs>
                <dataOutputRefs>block172_documentOutput</dataOutputRefs>
                
         </outputSet>

    </ioSpecification>
                <dataInputAssociation>
                            <sourceRef>systemToken</sourceRef>
                            <targetRef>block172_userTokenInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef></sourceRef>
                            <targetRef>block172_mittenteInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef>doc_determina_copy</sourceRef>
                            <targetRef>block172_documentInput</targetRef>

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef></sourceRef>
                            <targetRef>block172_destinatarioInput</targetRef>
                            

                </dataInputAssociation>

      <dataInputAssociation>
        <targetRef>block172_GroupIdInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression"></from>
           <to xsi:type="tFormalExpression">block172_GroupIdInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>block172_TaskNameInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">UpdateDocument</from>
           <to xsi:type="tFormalExpression">block172_TaskNameInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>block172_Operation</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">AggiornaDocumento</from>
           <to xsi:type="tFormalExpression">block172_Operation</to>
        </assignment>
      </dataInputAssociation>


            <dataOutputAssociation>
                            <sourceRef>block172_userTokenOutput</sourceRef>
                            <targetRef>systemToken</targetRef>
                            
            </dataOutputAssociation>
            <dataOutputAssociation>
                            <sourceRef>block172_documentOutput</sourceRef>
                            <targetRef>doc_determina</targetRef>
            </dataOutputAssociation>
           
      <potentialOwner>
        <resourceAssignmentExpression>
           <formalExpression></formalExpression>
        </resourceAssignmentExpression>
      </potentialOwner>
</task>

<endEvent id="block50" name="end">

</endEvent>

<sequenceFlow id="con_34203" sourceRef="block57" targetRef="block149">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34563" sourceRef="block175" targetRef="block164">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>


<callActivity id="block96" isForCompensation="false" independent="false" waitForCompletion="true" name="AMD Conversione Determina" calledElementByName="AMD_ConversioneUD2.0" >
<!-- ioSpecification -->
<ioSpecification>
    <dataInput id="block96_instanceNameInput" name="instanceName" />
    <dataInput id="block96_systemTokenInput" name="systemToken" />
    <dataInput id="block96_conversione_manualeInput" name="conversione_manuale" />
    <dataInput id="block96_humanTokenInput" name="humanToken" />
    <dataInput id="block96_abilita_ht_verificaInput" name="abilita_ht_verifica" />
    <dataInput id="block96_descrizioneInput" name="descrizione" />
    <dataInput id="block96_instanceIdInput" name="instanceId" />
    <dataInput id="block96_canalePECInput" name="canalePEC" />
    <dataInput id="block96_docnum_principaleInput" name="docnum_principale" />
    <dataInput id="block96_figura_professionaleInput" name="figura_professionale" />
    <dataInput id="block96_userInput" name="user" />
    <dataInput id="block96_outcomeInput" name="outcome" />
    <dataInput id="block96_nameInput" name="name" />
    <dataInput id="block96_descriptionInput" name="description" />
    <dataInput id="block96_waitForCompletionInput" name="waitForCompletion" />
    <dataInput id="block96_processNameInput" name="processName" />
    <dataOutput id="block96_principale_nuova_udOutput" name="principale_nuova_ud" />

    <inputSet>
        <dataInputRefs>block96_instanceNameInput</dataInputRefs>
        <dataInputRefs>block96_systemTokenInput</dataInputRefs>
        <dataInputRefs>block96_conversione_manualeInput</dataInputRefs>
        <dataInputRefs>block96_humanTokenInput</dataInputRefs>
        <dataInputRefs>block96_abilita_ht_verificaInput</dataInputRefs>
        <dataInputRefs>block96_descrizioneInput</dataInputRefs>
        <dataInputRefs>block96_instanceIdInput</dataInputRefs>
        <dataInputRefs>block96_canalePECInput</dataInputRefs>
        <dataInputRefs>block96_docnum_principaleInput</dataInputRefs>
        <dataInputRefs>block96_figura_professionaleInput</dataInputRefs>
        <dataInputRefs>block96_userInput</dataInputRefs>
        <dataInputRefs>block96_outcomeInput</dataInputRefs>
        <dataInputRefs>block96_nameInput</dataInputRefs>
        <dataInputRefs>block96_descriptionInput</dataInputRefs>
        <dataInputRefs>block96_waitForCompletionInput</dataInputRefs>
        <dataInputRefs>block96_processNameInput</dataInputRefs>
    </inputSet>

    <outputSet>
        <dataOutputRefs>block96_principale_nuova_udOutput</dataOutputRefs>
    </outputSet>
</ioSpecification>

<!-- lista inputs -->
<dataInputAssociation><!-- k:instanceName var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block96_instanceNameInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:systemToken var type: userToken -->
        <sourceRef><![CDATA[systemToken]]></sourceRef>
        <targetRef>block96_systemTokenInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:conversione_manuale var type: script -->
        <sourceRef><![CDATA["no";]]></sourceRef>
        <targetRef>block96_conversione_manualeInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:humanToken var type: userToken -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block96_humanTokenInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:abilita_ht_verifica var type: script -->
        <sourceRef><![CDATA["no";]]></sourceRef>
        <targetRef>block96_abilita_ht_verificaInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:descrizione var type: script -->
        <sourceRef><![CDATA["AMD Conversione Determina";]]></sourceRef>
        <targetRef>block96_descrizioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:instanceId var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block96_instanceIdInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:canalePEC var type: channel -->
        <targetRef>block96_canalePECInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[]]></from>
            <to xsi:type="tFormalExpression">block96_canalePECInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- k:docnum_principale var type: script -->
        <sourceRef><![CDATA[doc_determina.DOCNUM;]]></sourceRef>
        <targetRef>block96_docnum_principaleInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:figura_professionale var type: textRef -->
        <sourceRef><![CDATA[figura_professionale2]]></sourceRef>
        <targetRef>block96_figura_professionaleInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:user var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block96_userInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:outcome var type: object -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block96_outcomeInput</targetRef>
</dataInputAssociation>

<!-- lista props -->
<dataInputAssociation><!-- var type: string -->
        <targetRef>block96_nameInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[AMD Conversione Determina]]></from>
            <to xsi:type="tFormalExpression">block96_nameInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: string -->
        <targetRef>block96_descriptionInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[note]]></from>
            <to xsi:type="tFormalExpression">block96_descriptionInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: bool -->
        <targetRef>block96_waitForCompletionInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[true]]></from>
            <to xsi:type="tFormalExpression">block96_waitForCompletionInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: string -->
        <targetRef>block96_processNameInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[AMD_ConversioneUD2.0]]></from>
            <to xsi:type="tFormalExpression">block96_processNameInput</to>
        </assignment>
</dataInputAssociation>

<!-- lista outputs -->
<dataOutputAssociation>
        <sourceRef>block96_principale_nuova_udOutput</sourceRef>
        <targetRef>doc_determina</targetRef>
</dataOutputAssociation>
    
</callActivity>




<inclusiveGateway id="block91" name="gateway-branching" gatewayDirection="Diverging"></inclusiveGateway>
<inclusiveGateway id="block151" name="gateway-branching" gatewayDirection="Diverging"></inclusiveGateway>
<task id="block108" name="Recupera gruppi" tns:taskName="DocerJMS" >
    <ioSpecification>

        <dataInput id="block108_TaskNameInput" name="TaskName" />
        <dataInput id="block108_GroupIdInput" name="GroupId" />

        <dataInput id="block108_Operation" name="operation" />

            <dataInput id="block108_userTokenInput" name="userToken" />
            <dataInput id="block108_IdGruppoInput" name="IdGruppo" />
            <dataInput id="block108_IdUtenteInput" name="IdUtente" />
        
            <dataOutput id="block108_listaGruppiOutput" name="listaGruppi" />
            <dataOutput id="block108_userTokenOutput" name="userToken" />
           

        <inputSet>
            <dataInputRefs>block108_Operation</dataInputRefs>
            <dataInputRefs>block108_TaskNameInput</dataInputRefs>
            <dataInputRefs>block108_GroupIdInput</dataInputRefs>
                <dataInputRefs>block108_userTokenInput</dataInputRefs>
                <dataInputRefs>block108_IdGruppoInput</dataInputRefs>
                <dataInputRefs>block108_IdUtenteInput</dataInputRefs>
        </inputSet>
        
        <outputSet>
                <dataOutputRefs>block108_listaGruppiOutput</dataOutputRefs>
                <dataOutputRefs>block108_userTokenOutput</dataOutputRefs>
                
         </outputSet>

    </ioSpecification>
                <dataInputAssociation>
                            <sourceRef>systemToken</sourceRef>
                            <targetRef>block108_userTokenInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef>figura_professionale</sourceRef>
                            <targetRef>block108_IdGruppoInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef></sourceRef>
                            <targetRef>block108_IdUtenteInput</targetRef>
                            

                </dataInputAssociation>

      <dataInputAssociation>
        <targetRef>block108_GroupIdInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression"></from>
           <to xsi:type="tFormalExpression">block108_GroupIdInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>block108_TaskNameInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">Recupera gruppi</from>
           <to xsi:type="tFormalExpression">block108_TaskNameInput</to>
        </assignment>
      </dataInputAssociation>
    <dataInputAssociation>
        <targetRef>block108_Operation</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression">RecuperaGruppi</from>
            <to xsi:type="tFormalExpression">block108_Operation</to>
        </assignment>
    </dataInputAssociation>


            <dataOutputAssociation>
                            <sourceRef>block108_listaGruppiOutput</sourceRef>
                            <targetRef>gruppi_parent_proponente</targetRef>
                            
            </dataOutputAssociation>
            <dataOutputAssociation>
                            <sourceRef>block108_userTokenOutput</sourceRef>
                            <targetRef>systemToken</targetRef>
                            
            </dataOutputAssociation>
           
      <potentialOwner>
        <resourceAssignmentExpression>
           <formalExpression></formalExpression>
        </resourceAssignmentExpression>
      </potentialOwner>
</task>

<sequenceFlow id="con_33981" sourceRef="block87" targetRef="block57">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<inclusiveGateway id="block169" name="gateway-merge" gatewayDirection="Converging"></inclusiveGateway>
<scriptTask id="block212" scriptFormat="http://www.mvel.org/2.0" name="Imposta fascicolo secondario" isForCompensation="false" >
    <script>
        <![CDATA[



/************** start user script ***************/

fascicoli_secondari.add(fascicolo_anticorruzione);

/**************  end user script  ***************/



        ]]>
    </script>
</scriptTask>



<inclusiveGateway id="block133" name="gateway-merge" gatewayDirection="Converging"></inclusiveGateway>
<sequenceFlow id="con_34581" sourceRef="block211" targetRef="block210">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[valori_determina.TipoDetermina!="Liquidazione Contributo"]]>
    </conditionExpression>
</sequenceFlow>


<callActivity id="block182" isForCompensation="false" independent="false" waitForCompletion="true" name="AMD Approvazione determina responsabile" calledElementByName="AMD_ApprovazioneUD2.6" >
<!-- ioSpecification -->
<ioSpecification>
    <dataInput id="block182_noteInput" name="note" />
    <dataInput id="block182_instanceNameInput" name="instanceName" />
    <dataInput id="block182_tipologiePrincipaleInput" name="tipologiePrincipale" />
    <dataInput id="block182_approvatoriInput" name="approvatori" />
    <dataInput id="block182_descrizioneTaskInput" name="descrizioneTask" />
    <dataInput id="block182_tipologieAnnotazioneInput" name="tipologieAnnotazione" />
    <dataInput id="block182_INSTANCE_AOOInput" name="INSTANCE_AOO" />
    <dataInput id="block182_humanTokenInput" name="humanToken" />
    <dataInput id="block182_invio_notificaInput" name="invio_notifica" />
    <dataInput id="block182_instanceIdInput" name="instanceId" />
    <dataInput id="block182_gestioneAggiuntaRelatedInput" name="gestioneAggiuntaRelated" />
    <dataInput id="block182_INSTANCE_ENTEInput" name="INSTANCE_ENTE" />
    <dataInput id="block182_lanesInput" name="lanes" />
    <dataInput id="block182_formatoDataPerNoteInput" name="formatoDataPerNote" />
    <dataInput id="block182_outcomeInput" name="outcome" />
    <dataInput id="block182_mittenteInput" name="mittente" />
    <dataInput id="block182_nomeHTApprovazioneInput" name="nomeHTApprovazione" />
    <dataInput id="block182_systemTokenInput" name="systemToken" />
    <dataInput id="block182_gestioneEliminaInput" name="gestioneElimina" />
    <dataInput id="block182_descrizioneInput" name="descrizione" />
    <dataInput id="block182_tipologieAnnessoInput" name="tipologieAnnesso" />
    <dataInput id="block182_canalePECInput" name="canalePEC" />
    <dataInput id="block182_filenameDinamicoInput" name="filenameDinamico" />
    <dataInput id="block182_tipologieAllegatoInput" name="tipologieAllegato" />
    <dataInput id="block182_docnum_principaleInput" name="docnum_principale" />
    <dataInput id="block182_figura_professionaleInput" name="figura_professionale" />
    <dataInput id="block182_userInput" name="user" />
    <dataInput id="block182_commitInput" name="commit" />
    <dataOutput id="block182_utente_approvatoreOutput" name="utente_approvatore" />
    <dataOutput id="block182_esitoOutput" name="esito" />
    <dataOutput id="block182_businessStateOutput" name="businessState" />
    <dataOutput id="block182_systemTokenOutput" name="systemToken" />
    <dataOutput id="block182_principaleOutput" name="principale" />
    <dataOutput id="block182_lanesOutput" name="lanes" />
    <dataOutput id="block182_richiesta_revisioneOutput" name="richiesta_revisione" />

    <inputSet>
        <dataInputRefs>block182_noteInput</dataInputRefs>
        <dataInputRefs>block182_instanceNameInput</dataInputRefs>
        <dataInputRefs>block182_tipologiePrincipaleInput</dataInputRefs>
        <dataInputRefs>block182_approvatoriInput</dataInputRefs>
        <dataInputRefs>block182_descrizioneTaskInput</dataInputRefs>
        <dataInputRefs>block182_tipologieAnnotazioneInput</dataInputRefs>
        <dataInputRefs>block182_INSTANCE_AOOInput</dataInputRefs>
        <dataInputRefs>block182_humanTokenInput</dataInputRefs>
        <dataInputRefs>block182_invio_notificaInput</dataInputRefs>
        <dataInputRefs>block182_instanceIdInput</dataInputRefs>
        <dataInputRefs>block182_gestioneAggiuntaRelatedInput</dataInputRefs>
        <dataInputRefs>block182_INSTANCE_ENTEInput</dataInputRefs>
        <dataInputRefs>block182_lanesInput</dataInputRefs>
        <dataInputRefs>block182_formatoDataPerNoteInput</dataInputRefs>
        <dataInputRefs>block182_outcomeInput</dataInputRefs>
        <dataInputRefs>block182_mittenteInput</dataInputRefs>
        <dataInputRefs>block182_nomeHTApprovazioneInput</dataInputRefs>
        <dataInputRefs>block182_systemTokenInput</dataInputRefs>
        <dataInputRefs>block182_gestioneEliminaInput</dataInputRefs>
        <dataInputRefs>block182_descrizioneInput</dataInputRefs>
        <dataInputRefs>block182_tipologieAnnessoInput</dataInputRefs>
        <dataInputRefs>block182_canalePECInput</dataInputRefs>
        <dataInputRefs>block182_filenameDinamicoInput</dataInputRefs>
        <dataInputRefs>block182_tipologieAllegatoInput</dataInputRefs>
        <dataInputRefs>block182_docnum_principaleInput</dataInputRefs>
        <dataInputRefs>block182_figura_professionaleInput</dataInputRefs>
        <dataInputRefs>block182_userInput</dataInputRefs>
        <dataInputRefs>block182_commitInput</dataInputRefs>
    </inputSet>

    <outputSet>
        <dataOutputRefs>block182_utente_approvatoreOutput</dataOutputRefs>
        <dataOutputRefs>block182_esitoOutput</dataOutputRefs>
        <dataOutputRefs>block182_businessStateOutput</dataOutputRefs>
        <dataOutputRefs>block182_systemTokenOutput</dataOutputRefs>
        <dataOutputRefs>block182_principaleOutput</dataOutputRefs>
        <dataOutputRefs>block182_lanesOutput</dataOutputRefs>
        <dataOutputRefs>block182_richiesta_revisioneOutput</dataOutputRefs>
    </outputSet>
</ioSpecification>

<!-- lista inputs -->
<dataInputAssociation><!-- k:note var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block182_noteInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:instanceName var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block182_instanceNameInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:tipologiePrincipale var type: textRef -->
        <sourceRef><![CDATA[tipologiePrincipale]]></sourceRef>
        <targetRef>block182_tipologiePrincipaleInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:approvatori var type: object -->
        <sourceRef><![CDATA[approvatori_responsabile]]></sourceRef>
        <targetRef>block182_approvatoriInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:descrizioneTask var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block182_descrizioneTaskInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:tipologieAnnotazione var type: textRef -->
        <sourceRef><![CDATA[tipologieAnnotazione]]></sourceRef>
        <targetRef>block182_tipologieAnnotazioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:INSTANCE_AOO var type: textRef -->
        <sourceRef><![CDATA[INSTANCE_AOO]]></sourceRef>
        <targetRef>block182_INSTANCE_AOOInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:humanToken var type: userToken -->
        <sourceRef><![CDATA[humanToken]]></sourceRef>
        <targetRef>block182_humanTokenInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:invio_notifica var type: script -->
        <sourceRef><![CDATA["no"]]></sourceRef>
        <targetRef>block182_invio_notificaInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:instanceId var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block182_instanceIdInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:gestioneAggiuntaRelated var type: script -->
        <sourceRef><![CDATA["si"]]></sourceRef>
        <targetRef>block182_gestioneAggiuntaRelatedInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:INSTANCE_ENTE var type: textRef -->
        <sourceRef><![CDATA[INSTANCE_ENTE]]></sourceRef>
        <targetRef>block182_INSTANCE_ENTEInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:lanes var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block182_lanesInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:formatoDataPerNote var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block182_formatoDataPerNoteInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:outcome var type: object -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block182_outcomeInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:mittente var type: tempRef -->
        <sourceRef><![CDATA[mittente]]></sourceRef>
        <targetRef>block182_mittenteInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:nomeHTApprovazione var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block182_nomeHTApprovazioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:systemToken var type: userToken -->
        <sourceRef><![CDATA[systemToken]]></sourceRef>
        <targetRef>block182_systemTokenInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:gestioneElimina var type: script -->
        <sourceRef><![CDATA["si"]]></sourceRef>
        <targetRef>block182_gestioneEliminaInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:descrizione var type: script -->
        <sourceRef><![CDATA["Approvazione determina - Responsabile ufficio "+descrizione_ufficioCompetenza]]></sourceRef>
        <targetRef>block182_descrizioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:tipologieAnnesso var type: textRef -->
        <sourceRef><![CDATA[tipologieAnnesso]]></sourceRef>
        <targetRef>block182_tipologieAnnessoInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:canalePEC var type: channel -->
        <targetRef>block182_canalePECInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[]]></from>
            <to xsi:type="tFormalExpression">block182_canalePECInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- k:filenameDinamico var type: script -->
        <sourceRef><![CDATA["si"]]></sourceRef>
        <targetRef>block182_filenameDinamicoInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:tipologieAllegato var type: textRef -->
        <sourceRef><![CDATA[tipologieAllegato]]></sourceRef>
        <targetRef>block182_tipologieAllegatoInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:docnum_principale var type: script -->
        <sourceRef><![CDATA[doc_determina.DOCNUM]]></sourceRef>
        <targetRef>block182_docnum_principaleInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:figura_professionale var type: textRef -->
        <sourceRef><![CDATA[figura_professionale_responsabile]]></sourceRef>
        <targetRef>block182_figura_professionaleInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:user var type: object -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block182_userInput</targetRef>
</dataInputAssociation>

<!-- lista props -->
<dataInputAssociation><!-- var type: boolean -->
        <sourceRef>false</sourceRef>
        <targetRef>block182_commitInput</targetRef>
</dataInputAssociation>

<!-- lista outputs -->
<dataOutputAssociation>
        <sourceRef>block182_utente_approvatoreOutput</sourceRef>
        <targetRef></targetRef>
</dataOutputAssociation>
<dataOutputAssociation>
        <sourceRef>block182_esitoOutput</sourceRef>
        <targetRef>esito</targetRef>
</dataOutputAssociation>
<dataOutputAssociation>
        <sourceRef>block182_businessStateOutput</sourceRef>
        <targetRef></targetRef>
</dataOutputAssociation>
<dataOutputAssociation>
        <sourceRef>block182_systemTokenOutput</sourceRef>
        <targetRef>systemToken</targetRef>
</dataOutputAssociation>
<dataOutputAssociation>
        <sourceRef>block182_principaleOutput</sourceRef>
        <targetRef>doc_determina</targetRef>
</dataOutputAssociation>
<dataOutputAssociation>
        <sourceRef>block182_lanesOutput</sourceRef>
        <targetRef></targetRef>
</dataOutputAssociation>
<dataOutputAssociation>
        <sourceRef>block182_richiesta_revisioneOutput</sourceRef>
        <targetRef>note</targetRef>
</dataOutputAssociation>
    
</callActivity>




<sequenceFlow id="con_34239" sourceRef="block154" targetRef="block155">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[gruppi_parent_proponente.size()==0]]>
    </conditionExpression>
</sequenceFlow>

<inclusiveGateway id="block13" name="gateway-merge" gatewayDirection="Converging"></inclusiveGateway>
<task id="block153" name="Recupera gruppi" tns:taskName="DocerJMS" >
    <ioSpecification>

        <dataInput id="block153_TaskNameInput" name="TaskName" />
        <dataInput id="block153_GroupIdInput" name="GroupId" />

        <dataInput id="block153_Operation" name="operation" />

            <dataInput id="block153_userTokenInput" name="userToken" />
            <dataInput id="block153_IdGruppoInput" name="IdGruppo" />
            <dataInput id="block153_IdUtenteInput" name="IdUtente" />
        
            <dataOutput id="block153_listaGruppiOutput" name="listaGruppi" />
            <dataOutput id="block153_userTokenOutput" name="userToken" />
           

        <inputSet>
            <dataInputRefs>block153_Operation</dataInputRefs>
            <dataInputRefs>block153_TaskNameInput</dataInputRefs>
            <dataInputRefs>block153_GroupIdInput</dataInputRefs>
                <dataInputRefs>block153_userTokenInput</dataInputRefs>
                <dataInputRefs>block153_IdGruppoInput</dataInputRefs>
                <dataInputRefs>block153_IdUtenteInput</dataInputRefs>
        </inputSet>
        
        <outputSet>
                <dataOutputRefs>block153_listaGruppiOutput</dataOutputRefs>
                <dataOutputRefs>block153_userTokenOutput</dataOutputRefs>
                
         </outputSet>

    </ioSpecification>
                <dataInputAssociation>
                            <sourceRef>systemToken</sourceRef>
                            <targetRef>block153_userTokenInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef>figura_professionale2</sourceRef>
                            <targetRef>block153_IdGruppoInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef></sourceRef>
                            <targetRef>block153_IdUtenteInput</targetRef>
                            

                </dataInputAssociation>

      <dataInputAssociation>
        <targetRef>block153_GroupIdInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression"></from>
           <to xsi:type="tFormalExpression">block153_GroupIdInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>block153_TaskNameInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">Recupera gruppi</from>
           <to xsi:type="tFormalExpression">block153_TaskNameInput</to>
        </assignment>
      </dataInputAssociation>
    <dataInputAssociation>
        <targetRef>block153_Operation</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression">RecuperaGruppi</from>
            <to xsi:type="tFormalExpression">block153_Operation</to>
        </assignment>
    </dataInputAssociation>


            <dataOutputAssociation>
                            <sourceRef>block153_listaGruppiOutput</sourceRef>
                            <targetRef>gruppi_parent_proponente</targetRef>
                            
            </dataOutputAssociation>
            <dataOutputAssociation>
                            <sourceRef>block153_userTokenOutput</sourceRef>
                            <targetRef>systemToken</targetRef>
                            
            </dataOutputAssociation>
           
      <potentialOwner>
        <resourceAssignmentExpression>
           <formalExpression></formalExpression>
        </resourceAssignmentExpression>
      </potentialOwner>
</task>

<sequenceFlow id="con_34527" sourceRef="block97" targetRef="block192">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>


<!-- ********************************************************************* -->
<!-- START NEW EXPORT task -->
<!-- ********************************************************************* -->
<task id="block203" isForCompensation="false" name="Insert record determina provvedimento" tns:taskName="DBIntegration" >
<extensionElements>
        <tns:metaData name="customAsync">
            <tns:metaValue>true</tns:metaValue>
        </tns:metaData>
        <tns:onEntry-script scriptFormat="http://www.mvel.org/2.0" >
            <tns:script><![CDATA[
            
//input declarations
object=record_determina_provvedimento;

            
record_determina_provvedimento.put("@entity", table_determina_provvedimento);
record_determina_provvedimento.id_provvedimento = istanceProvvedimento;
record_determina_provvedimento.id = instanceId;
java.util.HashMap dati_custom = new java.util.HashMap();
dati_custom.put("importo", importoLiquidazione);

com.fasterxml.jackson.databind.ObjectMapper mapper = new com.fasterxml.jackson.databind.ObjectMapper();
record_determina_provvedimento.put("dati_custom", mapper.writeValueAsString(dati_custom));

record_determina_provvedimento.num_anno_determina = doc_determina.N_REGISTRAZ+"/"+doc_determina.A_REGISTRAZ;
System.out.println("record_determina_provvedimento postJSON "+record_determina_provvedimento);
            
//[auto-insert]
//record_determina_provvedimento, record_determina_provvedimento, record_determina_provvedimento, doc_determina
kcontext.setVariable("record_determina_provvedimento",null);
kcontext.setVariable("record_determina_provvedimento",record_determina_provvedimento);
kcontext.setVariable("record_determina_provvedimento",null);
kcontext.setVariable("record_determina_provvedimento",record_determina_provvedimento);
kcontext.setVariable("record_determina_provvedimento",null);
kcontext.setVariable("record_determina_provvedimento",record_determina_provvedimento);
kcontext.setVariable("doc_determina",null);
kcontext.setVariable("doc_determina",doc_determina);

                ]]></tns:script>
        </tns:onEntry-script>
</extensionElements>
<!-- ioSpecification -->
<ioSpecification>
    <dataInput id="block203_collectionInput" name="collection" />
    <dataInput id="block203_objectInput" name="object" />
    <dataInput id="block203_throw_on_emptyInput" name="throw_on_empty" />
    <dataInput id="block203_asyncInput" name="async" />
    <dataInput id="block203_nameInput" name="name" />
    <dataInput id="block203_commitInput" name="commit" />
    <dataInput id="block203_descriptionInput" name="description" />
    <dataInput id="block203_cmd_typeInput" name="cmd_type" />
    <dataOutput id="block203_collectionOutput" name="collection" />
    <dataOutput id="block203_rowsOutput" name="rows" />
    <dataOutput id="block203_objectOutput" name="object" />

    <inputSet>
        <dataInputRefs>block203_collectionInput</dataInputRefs>
        <dataInputRefs>block203_objectInput</dataInputRefs>
        <dataInputRefs>block203_throw_on_emptyInput</dataInputRefs>
        <dataInputRefs>block203_asyncInput</dataInputRefs>
        <dataInputRefs>block203_nameInput</dataInputRefs>
        <dataInputRefs>block203_commitInput</dataInputRefs>
        <dataInputRefs>block203_descriptionInput</dataInputRefs>
        <dataInputRefs>block203_cmd_typeInput</dataInputRefs>
    </inputSet>

    <outputSet>
        <dataOutputRefs>block203_collectionOutput</dataOutputRefs>
        <dataOutputRefs>block203_rowsOutput</dataOutputRefs>
        <dataOutputRefs>block203_objectOutput</dataOutputRefs>
    </outputSet>
</ioSpecification>

<!-- lista inputs -->
<dataInputAssociation><!-- k:collection var type: entityRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block203_collectionInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:object var type: entityRef -->
        <sourceRef><![CDATA[record_determina_provvedimento]]></sourceRef>
        <targetRef>block203_objectInput</targetRef>
</dataInputAssociation>

<!-- lista props -->
<dataInputAssociation><!-- var type: boolean -->
        <sourceRef>true</sourceRef>
        <targetRef>block203_throw_on_emptyInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- var type: boolean -->
        <sourceRef>true</sourceRef>
        <targetRef>block203_asyncInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- var type: text -->
        <targetRef>block203_nameInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[Insert record determina provvedimento]]></from>
            <to xsi:type="tFormalExpression">block203_nameInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: boolean -->
        <sourceRef>false</sourceRef>
        <targetRef>block203_commitInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- var type: text -->
        <targetRef>block203_descriptionInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[Insert record determina provvedimento]]></from>
            <to xsi:type="tFormalExpression">block203_descriptionInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: cmd_type -->
        <targetRef>block203_cmd_typeInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[INSERT_OR_UPDATE]]></from>
            <to xsi:type="tFormalExpression">block203_cmd_typeInput</to>
        </assignment>
</dataInputAssociation>

<!-- lista outputs -->
<dataOutputAssociation>
        <sourceRef>block203_collectionOutput</sourceRef>
        <targetRef></targetRef>
</dataOutputAssociation>
<dataOutputAssociation>
        <sourceRef>block203_rowsOutput</sourceRef>
        <targetRef></targetRef>
</dataOutputAssociation>
<dataOutputAssociation>
        <sourceRef>block203_objectOutput</sourceRef>
        <targetRef>record_determina_provvedimento</targetRef>
</dataOutputAssociation>
</task>


<!-- ********************************************************************* -->


<callActivity id="block208" isForCompensation="false" independent="false" waitForCompletion="true" name="Creazione documento anticorruzione1.0" calledElementByName="Creazione documento anticorruzione1.0" >
<!-- ioSpecification -->
<ioSpecification>
    <dataInput id="block208_descrizioneInput" name="descrizione" />
    <dataInput id="block208_istanceProvvedimentoInput" name="istanceProvvedimento" />
    <dataInput id="block208_fascicolo_anticorruzioneInput" name="fascicolo_anticorruzione" />
    <dataInput id="block208_lista_risposteInput" name="lista_risposte" />
    <dataInput id="block208_descReportInput" name="descReport" />
    <dataInput id="block208_lanesInput" name="lanes" />
    <dataInput id="block208_systemTokenInput" name="systemToken" />
    <dataInput id="block208_table_risposte_provvedimentoInput" name="table_risposte_provvedimento" />
    <dataInput id="block208_fig_profInput" name="fig_prof" />
    <dataInput id="block208_humanTokenInput" name="humanToken" />
    <dataInput id="block208_lista_domandeInput" name="lista_domande" />
    <dataInput id="block208_commitInput" name="commit" />
    <dataOutput id="block208_businessStateOutput" name="businessState" />
    <dataOutput id="block208_outcomeOutput" name="outcome" />

    <inputSet>
        <dataInputRefs>block208_descrizioneInput</dataInputRefs>
        <dataInputRefs>block208_istanceProvvedimentoInput</dataInputRefs>
        <dataInputRefs>block208_fascicolo_anticorruzioneInput</dataInputRefs>
        <dataInputRefs>block208_lista_risposteInput</dataInputRefs>
        <dataInputRefs>block208_descReportInput</dataInputRefs>
        <dataInputRefs>block208_lanesInput</dataInputRefs>
        <dataInputRefs>block208_systemTokenInput</dataInputRefs>
        <dataInputRefs>block208_table_risposte_provvedimentoInput</dataInputRefs>
        <dataInputRefs>block208_fig_profInput</dataInputRefs>
        <dataInputRefs>block208_humanTokenInput</dataInputRefs>
        <dataInputRefs>block208_lista_domandeInput</dataInputRefs>
        <dataInputRefs>block208_commitInput</dataInputRefs>
    </inputSet>

    <outputSet>
        <dataOutputRefs>block208_businessStateOutput</dataOutputRefs>
        <dataOutputRefs>block208_outcomeOutput</dataOutputRefs>
    </outputSet>
</ioSpecification>

<!-- lista inputs -->
<dataInputAssociation><!-- k:descrizione var type: script -->
        <sourceRef><![CDATA["Creazione documento anticorruzione"]]></sourceRef>
        <targetRef>block208_descrizioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:istanceProvvedimento var type: textRef -->
        <sourceRef><![CDATA[istanceProvvedimento]]></sourceRef>
        <targetRef>block208_istanceProvvedimentoInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:fascicolo_anticorruzione var type: fascicolo -->
        <sourceRef><![CDATA[fascicolo_anticorruzione]]></sourceRef>
        <targetRef>block208_fascicolo_anticorruzioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:lista_risposte var type: entity -->
        <sourceRef><![CDATA[lista_risposte]]></sourceRef>
        <targetRef>block208_lista_risposteInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:descReport var type: script -->
        <sourceRef><![CDATA["completo";]]></sourceRef>
        <targetRef>block208_descReportInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:lanes var type: textRef -->
        <sourceRef><![CDATA[lanes]]></sourceRef>
        <targetRef>block208_lanesInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:systemToken var type: userToken -->
        <sourceRef><![CDATA[systemToken]]></sourceRef>
        <targetRef>block208_systemTokenInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:table_risposte_provvedimento var type: textRef -->
        <sourceRef><![CDATA[table_risposte_provvedimento]]></sourceRef>
        <targetRef>block208_table_risposte_provvedimentoInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:fig_prof var type: textRef -->
        <sourceRef><![CDATA[figura_professionale2]]></sourceRef>
        <targetRef>block208_fig_profInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:humanToken var type: userToken -->
        <sourceRef><![CDATA[humanToken]]></sourceRef>
        <targetRef>block208_humanTokenInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:lista_domande var type: entity -->
        <sourceRef><![CDATA[lista_domande]]></sourceRef>
        <targetRef>block208_lista_domandeInput</targetRef>
</dataInputAssociation>

<!-- lista props -->
<dataInputAssociation><!-- var type: boolean -->
        <sourceRef>false</sourceRef>
        <targetRef>block208_commitInput</targetRef>
</dataInputAssociation>

<!-- lista outputs -->
<dataOutputAssociation>
        <sourceRef>block208_businessStateOutput</sourceRef>
        <targetRef></targetRef>
</dataOutputAssociation>
<dataOutputAssociation>
        <sourceRef>block208_outcomeOutput</sourceRef>
        <targetRef></targetRef>
</dataOutputAssociation>
    
</callActivity>




<sequenceFlow id="con_34473" sourceRef="block53" targetRef="block186">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34131" sourceRef="block132" targetRef="block123">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[gestione_omissis=="si"]]>
    </conditionExpression>
</sequenceFlow>

<scriptTask id="block31" scriptFormat="http://www.mvel.org/2.0" name="Gestione allegato Visto regolarita' contabile alla determina" isForCompensation="false" >
    <script>
        <![CDATA[



/************** start user script ***************/

doc_visto_copy.DOCNUM=doc_visto.DOCNUM;
doc_visto_copy.DOCNAME=doc_visto.DOCNAME;
doc_visto_copy.TYPE_ID=doc_visto.TYPE_ID;
doc_visto_copy.TIPO_COMPONENTE="ALLEGATO";

/**************  end user script  ***************/



//[auto-insert]
kcontext.setVariable("doc_visto_copy",null);
kcontext.setVariable("doc_visto_copy",doc_visto_copy);

        ]]>
    </script>
</scriptTask>



<sequenceFlow id="con_34023" sourceRef="block51" targetRef="block121">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_33831" sourceRef="block80" targetRef="block81">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[controllo_responsabile=="no"]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34155" sourceRef="block137" targetRef="block138">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<scriptTask id="block191" scriptFormat="http://www.mvel.org/2.0" name="Gestione BS e timeline" isForCompensation="false" >
    <script>
        <![CDATA[



/************** start user script ***************/

businessState = "statoDetermina1";
timeline_state = 1;

/**************  end user script  ***************/

//[auto-insert]
//Business State (businessState), timeline_state
kcontext.setVariable("businessState",null);
kcontext.setVariable("businessState",businessState);
kcontext.setVariable("timeline_state",null);
kcontext.setVariable("timeline_state",timeline_state);



        ]]>
    </script>
</scriptTask>



<inclusiveGateway id="block165" name="gateway-merge" gatewayDirection="Converging"></inclusiveGateway>
<sequenceFlow id="con_33777" sourceRef="block40" targetRef="block13">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34161" sourceRef="block138" targetRef="block139">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<scriptTask id="block190" scriptFormat="http://www.mvel.org/2.0" name="Gestione BS e timeline" isForCompensation="false" >
    <script>
        <![CDATA[



/************** start user script ***************/

businessState = "statoDetermina6";
timeline_state = 6;

/**************  end user script  ***************/

//[auto-insert]
//Business State (businessState), timeline_state
kcontext.setVariable("businessState",null);
kcontext.setVariable("businessState",businessState);
kcontext.setVariable("timeline_state",null);
kcontext.setVariable("timeline_state",timeline_state);



        ]]>
    </script>
</scriptTask>



<sequenceFlow id="con_34425" sourceRef="block139" targetRef="block174">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_33921" sourceRef="block59" targetRef="block100">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34113" sourceRef="block66" targetRef="block132">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<task id="block74" name="UpdateDocument" tns:taskName="DocerJMS" >
    <ioSpecification>

        <dataInput id="block74_TaskNameInput" name="TaskName" />
        <dataInput id="block74_GroupIdInput" name="GroupId" />
        <dataInput id="block74_Operation" name="operation" />

            <dataInput id="block74_userTokenInput" name="userToken" />
            <dataInput id="block74_mittenteInput" name="mittente" />
            <dataInput id="block74_documentInput" name="document" />
            <dataInput id="block74_destinatarioInput" name="destinatario" />
        
            <dataOutput id="block74_userTokenOutput" name="userToken" />
            <dataOutput id="block74_documentOutput" name="document" />
           

        <inputSet>
            <dataInputRefs>block74_TaskNameInput</dataInputRefs>
            <dataInputRefs>block74_GroupIdInput</dataInputRefs>
            <dataInputRefs>block74_Operation</dataInputRefs>
                <dataInputRefs>block74_userTokenInput</dataInputRefs>
                <dataInputRefs>block74_mittenteInput</dataInputRefs>
                <dataInputRefs>block74_documentInput</dataInputRefs>
                <dataInputRefs>block74_destinatarioInput</dataInputRefs>
        </inputSet>
        
        <outputSet>
                <dataOutputRefs>block74_userTokenOutput</dataOutputRefs>
                <dataOutputRefs>block74_documentOutput</dataOutputRefs>
                
         </outputSet>

    </ioSpecification>
                <dataInputAssociation>
                            <sourceRef>systemToken</sourceRef>
                            <targetRef>block74_userTokenInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef></sourceRef>
                            <targetRef>block74_mittenteInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef>doc_visto_copy</sourceRef>
                            <targetRef>block74_documentInput</targetRef>

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef></sourceRef>
                            <targetRef>block74_destinatarioInput</targetRef>
                            

                </dataInputAssociation>

      <dataInputAssociation>
        <targetRef>block74_GroupIdInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression"></from>
           <to xsi:type="tFormalExpression">block74_GroupIdInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>block74_TaskNameInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">UpdateDocument</from>
           <to xsi:type="tFormalExpression">block74_TaskNameInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>block74_Operation</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">AggiornaDocumento</from>
           <to xsi:type="tFormalExpression">block74_Operation</to>
        </assignment>
      </dataInputAssociation>


            <dataOutputAssociation>
                            <sourceRef>block74_userTokenOutput</sourceRef>
                            <targetRef>systemToken</targetRef>
                            
            </dataOutputAssociation>
            <dataOutputAssociation>
                            <sourceRef>block74_documentOutput</sourceRef>
                            <targetRef>doc_visto</targetRef>
            </dataOutputAssociation>
           
      <potentialOwner>
        <resourceAssignmentExpression>
           <formalExpression></formalExpression>
        </resourceAssignmentExpression>
      </potentialOwner>
</task>

<sequenceFlow id="con_33969" sourceRef="block98" targetRef="block6">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34539" sourceRef="block46" targetRef="block188">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34329" sourceRef="block166" targetRef="block137">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[abilita_rest=="si"]]>
    </conditionExpression>
</sequenceFlow>

<scriptTask id="block87" scriptFormat="http://www.mvel.org/2.0" name="Set docnum determina  - gestione documenti aggiunti manualmente" isForCompensation="false" >
    <script>
        <![CDATA[



/************** start user script ***************/

docnum_determina="";
listaCorrelati_precedenti = new java.util.ArrayList();
java.util.ArrayList listaUnica= new java.util.ArrayList();
listaUnica.addAll(listaAllegati_precedenti);
listaUnica.addAll(listaAnnessi_precedenti);

java.util.HashMap documento = new java.util.HashMap();

foreach(documento : listaUnica){
 	if(!(org.apache.commons.lang3.StringUtils.containsIgnoreCase(documento.get("DOCNAME"), "testo_determina-")) 
		&& !(org.apache.commons.lang3.StringUtils.containsIgnoreCase(documento.get("DOCNAME"), "beneficiari"))
		&& !(org.apache.commons.lang3.StringUtils.containsIgnoreCase(documento.get("DOCNAME"), "affidamento"))
		&& !(org.apache.commons.lang3.StringUtils.containsIgnoreCase(documento.get("DOCNAME"), "aggiudicazione"))
		&& !(org.apache.commons.lang3.StringUtils.containsIgnoreCase(documento.get("DOCNAME"), "rinnovo"))
		&& !(org.apache.commons.lang3.StringUtils.containsIgnoreCase(documento.get("DOCNAME"), "proroga"))
		&& !(org.apache.commons.lang3.StringUtils.containsIgnoreCase(documento.get("DOCNAME"), "nomina_commissioni"))
		&& !(org.apache.commons.lang3.StringUtils.containsIgnoreCase(documento.get("DOCNAME"), "incarichi_consulenti"))
		&& !(org.apache.commons.lang3.StringUtils.containsIgnoreCase(documento.get("DOCNAME"), "concorsi_selezioni"))){
		   listaCorrelati_precedenti.add(documento);
	}		 
}

/**************  end user script  ***************/



//[auto-insert]
kcontext.setVariable("docnum_determina",null);
kcontext.setVariable("docnum_determina",docnum_determina);
kcontext.setVariable("listaCorrelati_precedenti",null);
kcontext.setVariable("listaCorrelati_precedenti",listaCorrelati_precedenti);

        ]]>
    </script>
</scriptTask>



<sequenceFlow id="con_34431" sourceRef="block181" targetRef="block14">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_33879" sourceRef="block92" targetRef="block52">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34347" sourceRef="block169" targetRef="block98">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34479" sourceRef="block186" targetRef="block181">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34257" sourceRef="block157" targetRef="block158">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<scriptTask id="block40" scriptFormat="http://www.mvel.org/2.0" name="Impostazione Default" isForCompensation="false" >
    <script>
        <![CDATA[



//[auto-insert]
Descrizione=descrizione;

/************** start user script ***************/

System.out.println("XXXXX valori determina: "+valori_determina);
var_temp = valori_determina;
Default.identity=figura_professionale;
approvatori_proponente.get(0).gruppo=figura_professionale;
if(!java.lang.String.class.isInstance(rif_codice_classifica)) {
    System.out.println("XXXXX object is not a String");
    String str = Integer.toString(rif_codice_classifica);
    rif_codice_classifica=str;
}

if(variabili_determina.size() < 10) {
	System.out.println("XXXXX Avvio flusso determina con start normale");
	java.lang.String oggetto = oggetto_start;

	if(tipo_determina=="senza_impegno"){
		 template_determina=template_senzaSpeseEntrate;
		 valori_determina=valori_senzaSpeseEntrate;
		 variabili_determina=variabili_senzaSpeseEntrate;
	}
	if(tipo_determina!="senza_impegno"){
		 template_determina=template_conSpese;
		 valori_determina=valori_conSpese;
		 variabili_determina=variabili_conSpese;
	}

	variabili_determina.Intoggetto=oggetto.toUpperCase();

	Descrizione=instanceId+" - "+oggetto.toUpperCase();
	
}else{
	System.out.println("XXXXX Avvio flusso determina con clonazione");
	java.lang.String oggetto = oggetto_start;
	variabili_determina.Intoggetto=oggetto.toUpperCase();
	Descrizione=instanceId+" - "+oggetto.toUpperCase();
	docnum_determina="";
	if(tipo_determina=="senza_impegno"){
		 template_determina=template_senzaSpeseEntrate;
	}
	if(tipo_determina!="senza_impegno"){
		 template_determina=template_conSpese;
	}
}

//  java.lang.Integer myLevel=gruppi_parent_proponente.size() - 1;
//  java.lang.Integer i = myLevel;

//  java.lang.String trovato = "false";
//  java.lang.String grp = "";
//  java.lang.String test = "";
//  figura_professionale2 = "";
 nomeGruppo_dirigente = "";
 
// for (i =myLevel; i >= 0; i--) { 
//   System.out.println("XXXXX "+i);
//   java.util.HashMap group = new java.util.HashMap();
//   foreach(group : gruppi_parent_proponente){
//           if(group.get("livello")==i){
//                  System.out.println("XXXXX "+group.get("idGruppo"));
//                 grp = group.get("idGruppo");
//                 test = grp.substring(grp.length() - 2);
//                 System.out.println("XXXXX "+test);
//                 if(test==suffisso_resp && trovato=="false"){
//                       System.out.println("XXXXX trovato "+grp);
//                       trovato="true";
//                       figura_professionale2=grp;
//                       nomeGruppo_dirigente=group.get("nomeGruppo");
//                 }
//           }
//   }
// }
if(figura_professionale2==""){
  figura_professionale2=gruppoDirigenteDefault;
  nomeGruppo_dirigente=nome_gruppoDirigenteDefault;
}
System.out.println("XXXXX Il gruppo dirigente: "+figura_professionale2);

Default2.identity=figura_professionale2;
variabili_determina.IntCodSett=figura_professionale2;
variabili_determina.IntDescrSett=nomeGruppo_dirigente;

System.out.println("XXXXX le variabili determina: "+variabili_determina);

approvatori_dirigente.get(0).gruppo=figura_professionale2;
approvatori_responsabile.get(0).gruppo=figura_professionale_responsabile;

System.out.println("XXXXX approvatori determina dirigente: "+approvatori_dirigente);

//valori_determina = ...
if(valori_determina==null){
	valori_determina = var_temp;
}

System.out.println("XXXXX valori determina: "+var_temp);
valori_determina.idIstanzaPadre=instanceId;

/**************  end user script  ***************/

//[auto-insert]
//instanceId, instanceId
kcontext.setVariable("instanceId",null);
kcontext.setVariable("instanceId",instanceId);
kcontext.setVariable("instanceId",null);
kcontext.setVariable("instanceId",instanceId);



//[auto-insert]
kcontext.setVariable("Default",null);
kcontext.setVariable("Default",Default);
kcontext.setVariable("Default2",null);
kcontext.setVariable("Default2",Default2);
kcontext.setVariable("rif_codice_classifica",null);
kcontext.setVariable("rif_codice_classifica",rif_codice_classifica);
kcontext.setVariable("valori_determina",null);
kcontext.setVariable("valori_determina",valori_determina);
kcontext.setVariable("variabili_determina",null);
kcontext.setVariable("variabili_determina",variabili_determina);
kcontext.setVariable("template_determina",null);
kcontext.setVariable("template_determina",template_determina);
kcontext.setVariable("descrizione",null);
kcontext.setVariable("descrizione",Descrizione);
kcontext.setVariable("figura_professionale2",null);
kcontext.setVariable("figura_professionale2",figura_professionale2);
kcontext.setVariable("approvatori_proponente",null);
kcontext.setVariable("approvatori_proponente",approvatori_proponente);
kcontext.setVariable("approvatori_dirigente",null);
kcontext.setVariable("approvatori_dirigente",approvatori_dirigente);
kcontext.setVariable("approvatori_responsabile",null);
kcontext.setVariable("approvatori_responsabile",approvatori_responsabile);
kcontext.setVariable("figura_professionale_responsabile",null);
kcontext.setVariable("figura_professionale_responsabile",figura_professionale_responsabile);
kcontext.setVariable("docnum_determina",null);
kcontext.setVariable("docnum_determina",docnum_determina);

        ]]>
    </script>
</scriptTask>



<task id="block145" name="callRestService email Ufficio" tns:taskName="callRestService-task" >
    <ioSpecification>

        <dataInput id="block145_description" name="description" />
        <dataInput id="block145_name" name="name" />


        <dataInput id="block145_userTokenInput" name="userToken" />
        <dataInput id="block145_urlInput" name="url" />

        <dataOutput id="block145_UserTokenOutput" name="userToken" />
        <dataOutput id="block145_responseArrayOutput" name="responseArray" />
        <dataOutput id="block145_responseObjectOutput" name="responseObject" />


        <inputSet>
            <dataInputRefs>block145_name</dataInputRefs>
            <dataInputRefs>block145_description</dataInputRefs>
            <dataInputRefs>block145_userTokenInput</dataInputRefs>
            <dataInputRefs>block145_urlInput</dataInputRefs>
        </inputSet>

        <outputSet>

            <dataOutputRefs>block145_UserTokenOutput</dataOutputRefs>
            <dataOutputRefs>block145_responseArrayOutput</dataOutputRefs>
            <dataOutputRefs>block145_responseObjectOutput</dataOutputRefs>

        </outputSet>

    </ioSpecification>
    <dataInputAssociation>
                <sourceRef>systemToken</sourceRef>
                <targetRef>block145_userTokenInput</targetRef>


    </dataInputAssociation>
    <dataInputAssociation>
                <sourceRef>url_rest_uffici+figura_professionale;</sourceRef>
                <targetRef>block145_urlInput</targetRef>


    </dataInputAssociation>



    <dataOutputAssociation>
                <sourceRef>block145_responseArrayOutput</sourceRef>
                <targetRef>responseArray</targetRef>

    </dataOutputAssociation>
    <dataOutputAssociation>
                <sourceRef>block145_responseObjectOutput</sourceRef>
                <targetRef>responseObject</targetRef>

    </dataOutputAssociation>


</task>
<sequenceFlow id="con_34035" sourceRef="block24" targetRef="block122">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[esito=="no" || esito=="rev"]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34611" sourceRef="block213" targetRef="block203">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34245" sourceRef="block155" targetRef="block156">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<inclusiveGateway id="block131" name="gateway-merge" gatewayDirection="Converging"></inclusiveGateway>
<task id="block53" name="UpdateDocument" tns:taskName="DocerJMS" >
    <ioSpecification>

        <dataInput id="block53_TaskNameInput" name="TaskName" />
        <dataInput id="block53_GroupIdInput" name="GroupId" />
        <dataInput id="block53_Operation" name="operation" />

            <dataInput id="block53_userTokenInput" name="userToken" />
            <dataInput id="block53_mittenteInput" name="mittente" />
            <dataInput id="block53_documentInput" name="document" />
            <dataInput id="block53_destinatarioInput" name="destinatario" />
        
            <dataOutput id="block53_userTokenOutput" name="userToken" />
            <dataOutput id="block53_documentOutput" name="document" />
           

        <inputSet>
            <dataInputRefs>block53_TaskNameInput</dataInputRefs>
            <dataInputRefs>block53_GroupIdInput</dataInputRefs>
            <dataInputRefs>block53_Operation</dataInputRefs>
                <dataInputRefs>block53_userTokenInput</dataInputRefs>
                <dataInputRefs>block53_mittenteInput</dataInputRefs>
                <dataInputRefs>block53_documentInput</dataInputRefs>
                <dataInputRefs>block53_destinatarioInput</dataInputRefs>
        </inputSet>
        
        <outputSet>
                <dataOutputRefs>block53_userTokenOutput</dataOutputRefs>
                <dataOutputRefs>block53_documentOutput</dataOutputRefs>
                
         </outputSet>

    </ioSpecification>
                <dataInputAssociation>
                            <sourceRef>systemToken</sourceRef>
                            <targetRef>block53_userTokenInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef></sourceRef>
                            <targetRef>block53_mittenteInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef>doc_determina_copy</sourceRef>
                            <targetRef>block53_documentInput</targetRef>

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef></sourceRef>
                            <targetRef>block53_destinatarioInput</targetRef>
                            

                </dataInputAssociation>

      <dataInputAssociation>
        <targetRef>block53_GroupIdInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression"></from>
           <to xsi:type="tFormalExpression">block53_GroupIdInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>block53_TaskNameInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">UpdateDocument</from>
           <to xsi:type="tFormalExpression">block53_TaskNameInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>block53_Operation</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">AggiornaDocumento</from>
           <to xsi:type="tFormalExpression">block53_Operation</to>
        </assignment>
      </dataInputAssociation>


            <dataOutputAssociation>
                            <sourceRef>block53_userTokenOutput</sourceRef>
                            <targetRef>systemToken</targetRef>
                            
            </dataOutputAssociation>
            <dataOutputAssociation>
                            <sourceRef>block53_documentOutput</sourceRef>
                            <targetRef>doc_determina</targetRef>
            </dataOutputAssociation>
           
      <potentialOwner>
        <resourceAssignmentExpression>
           <formalExpression></formalExpression>
        </resourceAssignmentExpression>
      </potentialOwner>
</task>

<sequenceFlow id="con_33813" sourceRef="block74" targetRef="block75">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<inclusiveGateway id="block48" name="gateway-branching" gatewayDirection="Diverging"></inclusiveGateway>
<inclusiveGateway id="block14" name="gateway-branching" gatewayDirection="Diverging"></inclusiveGateway>
<sequenceFlow id="con_34251" sourceRef="block156" targetRef="block157">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>


<callActivity id="block134" isForCompensation="false" independent="false" waitForCompletion="true" name="Invio notifica numerazione atto" calledElementByName="Invio messaggio senza allegati1.0" >
<!-- ioSpecification -->
<ioSpecification>
    <dataInput id="block134_messaggioInput" name="messaggio" />
    <dataInput id="block134_mittenteInput" name="mittente" />
    <dataInput id="block134_instanceNameInput" name="instanceName" />
    <dataInput id="block134_systemTokenInput" name="systemToken" />
    <dataInput id="block134_oggettoInput" name="oggetto" />
    <dataInput id="block134_humanTokenInput" name="humanToken" />
    <dataInput id="block134_destinatarioInput" name="destinatario" />
    <dataInput id="block134_canaleMAILInput" name="canaleMAIL" />
    <dataInput id="block134_descrizioneInput" name="descrizione" />
    <dataInput id="block134_instanceIdInput" name="instanceId" />
    <dataInput id="block134___ckValueInput" name="__ckValue" />
    <dataInput id="block134_canalePECInput" name="canalePEC" />
    <dataInput id="block134_canaleJMSInput" name="canaleJMS" />
    <dataInput id="block134_outcomeInput" name="outcome" />
    <dataInput id="block134_nameInput" name="name" />
    <dataInput id="block134_descriptionInput" name="description" />
    <dataInput id="block134_waitForCompletionInput" name="waitForCompletion" />
    <dataInput id="block134_processNameInput" name="processName" />

    <inputSet>
        <dataInputRefs>block134_messaggioInput</dataInputRefs>
        <dataInputRefs>block134_mittenteInput</dataInputRefs>
        <dataInputRefs>block134_instanceNameInput</dataInputRefs>
        <dataInputRefs>block134_systemTokenInput</dataInputRefs>
        <dataInputRefs>block134_oggettoInput</dataInputRefs>
        <dataInputRefs>block134_humanTokenInput</dataInputRefs>
        <dataInputRefs>block134_destinatarioInput</dataInputRefs>
        <dataInputRefs>block134_canaleMAILInput</dataInputRefs>
        <dataInputRefs>block134_descrizioneInput</dataInputRefs>
        <dataInputRefs>block134_instanceIdInput</dataInputRefs>
        <dataInputRefs>block134___ckValueInput</dataInputRefs>
        <dataInputRefs>block134_canalePECInput</dataInputRefs>
        <dataInputRefs>block134_canaleJMSInput</dataInputRefs>
        <dataInputRefs>block134_outcomeInput</dataInputRefs>
        <dataInputRefs>block134_nameInput</dataInputRefs>
        <dataInputRefs>block134_descriptionInput</dataInputRefs>
        <dataInputRefs>block134_waitForCompletionInput</dataInputRefs>
        <dataInputRefs>block134_processNameInput</dataInputRefs>
    </inputSet>

    <outputSet>
    </outputSet>
</ioSpecification>

<!-- lista inputs -->
<dataInputAssociation><!-- k:messaggio var type: textRef -->
        <sourceRef><![CDATA[corpoNotifica]]></sourceRef>
        <targetRef>block134_messaggioInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:mittente var type: soggetto -->
        <sourceRef><![CDATA[mittente]]></sourceRef>
        <targetRef>block134_mittenteInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:instanceName var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block134_instanceNameInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:systemToken var type: userToken -->
        <sourceRef><![CDATA[systemToken]]></sourceRef>
        <targetRef>block134_systemTokenInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:oggetto var type: textRef -->
        <sourceRef><![CDATA[oggettoNotifica]]></sourceRef>
        <targetRef>block134_oggettoInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:humanToken var type: userToken -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block134_humanTokenInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:destinatario var type: soggetto -->
        <sourceRef><![CDATA[destinatario]]></sourceRef>
        <targetRef>block134_destinatarioInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:canaleMAIL var type: channel -->
        <targetRef>block134_canaleMAILInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[]]></from>
            <to xsi:type="tFormalExpression">block134_canaleMAILInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- k:descrizione var type: script -->
        <sourceRef><![CDATA["invio notifica numerazione atto";]]></sourceRef>
        <targetRef>block134_descrizioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:instanceId var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block134_instanceIdInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:__ckValue var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block134___ckValueInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:canalePEC var type: channel -->
        <targetRef>block134_canalePECInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[]]></from>
            <to xsi:type="tFormalExpression">block134_canalePECInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- k:canaleJMS var type: channel -->
        <targetRef>block134_canaleJMSInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[]]></from>
            <to xsi:type="tFormalExpression">block134_canaleJMSInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- k:outcome var type: object -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block134_outcomeInput</targetRef>
</dataInputAssociation>

<!-- lista props -->
<dataInputAssociation><!-- var type: string -->
        <targetRef>block134_nameInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[Invio notifica numerazione atto]]></from>
            <to xsi:type="tFormalExpression">block134_nameInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: string -->
        <targetRef>block134_descriptionInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[note]]></from>
            <to xsi:type="tFormalExpression">block134_descriptionInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: bool -->
        <targetRef>block134_waitForCompletionInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[true]]></from>
            <to xsi:type="tFormalExpression">block134_waitForCompletionInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: string -->
        <targetRef>block134_processNameInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[Invio messaggio senza allegati1.0]]></from>
            <to xsi:type="tFormalExpression">block134_processNameInput</to>
        </assignment>
</dataInputAssociation>

<!-- lista outputs -->
    
</callActivity>




<sequenceFlow id="con_34557" sourceRef="block17" targetRef="block175">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<exclusiveGateway id="block211" name="Exclusive Split (XOR)" gatewayDirection="Diverging"></exclusiveGateway>

<sequenceFlow id="con_34419" sourceRef="block174" targetRef="block140">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<task id="block174" name="getProfileDocument" tns:taskName="DocerJMS" >
    <ioSpecification>

        <dataInput id="block174_TaskNameInput" name="TaskName" />
        <dataInput id="block174_GroupIdInput" name="GroupId" />
        <dataInput id="block174_Operation" name="operation" />
        <dataInput id="block174_ForceDownloadDocument" name="forceDownloadDocument" />

            <dataInput id="block174_userTokenInput" name="userToken" />
            <dataInput id="block174_documentInput" name="document" />
        
            <dataOutput id="block174_userTokenOutput" name="userToken" />
            <dataOutput id="block174_allegatiOutput" name="allegati" />
            <dataOutput id="block174_documentOutput" name="document" />
            <dataOutput id="block174_filePathOutput" name="filePath" />
           

        <inputSet>
            <dataInputRefs>block174_TaskNameInput</dataInputRefs>
            <dataInputRefs>block174_GroupIdInput</dataInputRefs>
            <dataInputRefs>block174_ForceDownloadDocument</dataInputRefs>
            <dataInputRefs>block174_Operation</dataInputRefs>
                <dataInputRefs>block174_userTokenInput</dataInputRefs>
                <dataInputRefs>block174_documentInput</dataInputRefs>
        </inputSet>
        
        <outputSet>
                <dataOutputRefs>block174_userTokenOutput</dataOutputRefs>
                <dataOutputRefs>block174_allegatiOutput</dataOutputRefs>
                <dataOutputRefs>block174_documentOutput</dataOutputRefs>
                <dataOutputRefs>block174_filePathOutput</dataOutputRefs>
                
         </outputSet>

    </ioSpecification>
                <dataInputAssociation>
                            <sourceRef>systemToken</sourceRef>
                            <targetRef>block174_userTokenInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef>doc_determina</sourceRef>
                            <targetRef>block174_documentInput</targetRef>

                </dataInputAssociation>
				<dataInputAssociation>
			        <targetRef>block174_ForceDownloadDocument</targetRef>
			        <assignment>
			            <from xsi:type="tFormalExpression">false</from>
			            <to xsi:type="tFormalExpression">block174_ForceDownloadDocument</to>
			        </assignment>
			    </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>block174_GroupIdInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression"></from>
           <to xsi:type="tFormalExpression">block174_GroupIdInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>block174_TaskNameInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">getProfileDocument</from>
           <to xsi:type="tFormalExpression">block174_TaskNameInput</to>
        </assignment>
      </dataInputAssociation>
	  <dataInputAssociation>
        <targetRef>block174_Operation</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">RecuperaProfiloDocumento</from>
           <to xsi:type="tFormalExpression">block174_Operation</to>
        </assignment>
      </dataInputAssociation>

            <dataOutputAssociation>
                            <sourceRef>block174_userTokenOutput</sourceRef>
                            <targetRef>systemToken</targetRef>
                            
            </dataOutputAssociation>
            <dataOutputAssociation>
                            <sourceRef>block174_allegatiOutput</sourceRef>
                            <targetRef></targetRef>
            </dataOutputAssociation>
            <dataOutputAssociation>
                            <sourceRef>block174_documentOutput</sourceRef>
                            <targetRef>doc_determina</targetRef>
            </dataOutputAssociation>
            <dataOutputAssociation>
                            <sourceRef>block174_filePathOutput</sourceRef>
                            <targetRef></targetRef>
                            
            </dataOutputAssociation>
           
      <potentialOwner>
        <resourceAssignmentExpression>
           <formalExpression></formalExpression>
        </resourceAssignmentExpression>
      </potentialOwner>
</task>

<sequenceFlow id="con_33825" sourceRef="block14" targetRef="block79">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[esito=="si"]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34005" sourceRef="block114" targetRef="block115">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<scriptTask id="block186" scriptFormat="http://www.mvel.org/2.0" name="Gestione BS e timeline" isForCompensation="false" >
    <script>
        <![CDATA[



/************** start user script ***************/

businessState = "statoDetermina2";
timeline_state = 2;

/**************  end user script  ***************/

//[auto-insert]
//Business State (businessState), timeline_state
kcontext.setVariable("businessState",null);
kcontext.setVariable("businessState",businessState);
kcontext.setVariable("timeline_state",null);
kcontext.setVariable("timeline_state",timeline_state);



        ]]>
    </script>
</scriptTask>



<sequenceFlow id="con_34083" sourceRef="block81" targetRef="block130">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<task id="block51" name="UpdateDocument" tns:taskName="DocerJMS" >
    <ioSpecification>

        <dataInput id="block51_TaskNameInput" name="TaskName" />
        <dataInput id="block51_GroupIdInput" name="GroupId" />
        <dataInput id="block51_Operation" name="operation" />

            <dataInput id="block51_userTokenInput" name="userToken" />
            <dataInput id="block51_mittenteInput" name="mittente" />
            <dataInput id="block51_documentInput" name="document" />
            <dataInput id="block51_destinatarioInput" name="destinatario" />
        
            <dataOutput id="block51_userTokenOutput" name="userToken" />
            <dataOutput id="block51_documentOutput" name="document" />
           

        <inputSet>
            <dataInputRefs>block51_TaskNameInput</dataInputRefs>
            <dataInputRefs>block51_GroupIdInput</dataInputRefs>
            <dataInputRefs>block51_Operation</dataInputRefs>
                <dataInputRefs>block51_userTokenInput</dataInputRefs>
                <dataInputRefs>block51_mittenteInput</dataInputRefs>
                <dataInputRefs>block51_documentInput</dataInputRefs>
                <dataInputRefs>block51_destinatarioInput</dataInputRefs>
        </inputSet>
        
        <outputSet>
                <dataOutputRefs>block51_userTokenOutput</dataOutputRefs>
                <dataOutputRefs>block51_documentOutput</dataOutputRefs>
                
         </outputSet>

    </ioSpecification>
                <dataInputAssociation>
                            <sourceRef>systemToken</sourceRef>
                            <targetRef>block51_userTokenInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef></sourceRef>
                            <targetRef>block51_mittenteInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef>doc_determina_copy</sourceRef>
                            <targetRef>block51_documentInput</targetRef>

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef></sourceRef>
                            <targetRef>block51_destinatarioInput</targetRef>
                            

                </dataInputAssociation>

      <dataInputAssociation>
        <targetRef>block51_GroupIdInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression"></from>
           <to xsi:type="tFormalExpression">block51_GroupIdInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>block51_TaskNameInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">UpdateDocument</from>
           <to xsi:type="tFormalExpression">block51_TaskNameInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>block51_Operation</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">AggiornaDocumento</from>
           <to xsi:type="tFormalExpression">block51_Operation</to>
        </assignment>
      </dataInputAssociation>


            <dataOutputAssociation>
                            <sourceRef>block51_userTokenOutput</sourceRef>
                            <targetRef>systemToken</targetRef>
                            
            </dataOutputAssociation>
            <dataOutputAssociation>
                            <sourceRef>block51_documentOutput</sourceRef>
                            <targetRef>doc_determina</targetRef>
            </dataOutputAssociation>
           
      <potentialOwner>
        <resourceAssignmentExpression>
           <formalExpression></formalExpression>
        </resourceAssignmentExpression>
      </potentialOwner>
</task>

<sequenceFlow id="con_34323" sourceRef="block164" targetRef="block165">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[abilita_rest=="no"]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_33867" sourceRef="block88" targetRef="block90">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<userTask id="block110" name="HT-Generico_block110" >


    <ioSpecification>

        <dataInput id="block110_TaskNameInput" name="TaskName" />
        <dataInput id="block110_GroupIdInput" name="GroupId" />
        <dataInput id="block110_SwimlaneActorIdInput" name="SwimlaneActorId" />

            <dataInput id="block110_commentInput" name="comment" />
            <dataInput id="block110_variabili_determinaInput" name="variabili_determina" />
            <dataInput id="block110_tipo_determinaInput" name="tipo_determina" />
            <dataInput id="block110_omissisInput" name="omissis" />
        
            <dataOutput id="block110_reasonOutput" name="reason" />
            <dataOutput id="block110_userTokenOutput" name="userToken" />
            <dataOutput id="block110_omissisOutput" name="omissis" />
           

        <inputSet>
            <dataInputRefs>block110_SwimlaneActorIdInput</dataInputRefs>
            <dataInputRefs>block110_TaskNameInput</dataInputRefs>
            <dataInputRefs>block110_GroupIdInput</dataInputRefs>
                <dataInputRefs>block110_commentInput</dataInputRefs>
                <dataInputRefs>block110_variabili_determinaInput</dataInputRefs>
                <dataInputRefs>block110_tipo_determinaInput</dataInputRefs>
                <dataInputRefs>block110_omissisInput</dataInputRefs>
        </inputSet>
        
        <outputSet>
                <dataOutputRefs>block110_reasonOutput</dataOutputRefs>
                <dataOutputRefs>block110_userTokenOutput</dataOutputRefs>
                <dataOutputRefs>block110_omissisOutput</dataOutputRefs>
                
         </outputSet>

    </ioSpecification>
                <dataInputAssociation>
                                <targetRef>block110_commentInput</targetRef>
                                <assignment>
                                <from xsi:type="tFormalExpression"><![CDATA[]]></from>
                                <to xsi:type="tFormalExpression">block110_commentInput</to>
                                </assignment>

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef>variabili_determina</sourceRef>
                            <targetRef>block110_variabili_determinaInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef>tipo_determina</sourceRef>
                            <targetRef>block110_tipo_determinaInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef>omissis</sourceRef>
                            <targetRef>block110_omissisInput</targetRef>
                            

                </dataInputAssociation>

      <dataInputAssociation>
          <sourceRef>Default.identity</sourceRef>
          <targetRef>block110_GroupIdInput</targetRef>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>block110_TaskNameInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression">"Gestione omissis determina"</from>
           <to xsi:type="tFormalExpression">block110_TaskNameInput</to>
        </assignment>
      </dataInputAssociation>
            <dataOutputAssociation>
                    <sourceRef>block110_reasonOutput</sourceRef>
                    <targetRef></targetRef>
            </dataOutputAssociation>
            <dataOutputAssociation>
                    <sourceRef>block110_userTokenOutput</sourceRef>
                    <targetRef>humanToken</targetRef>
            </dataOutputAssociation>
            <dataOutputAssociation>
                    <sourceRef>block110_omissisOutput</sourceRef>
                    <targetRef>omissis</targetRef>
            </dataOutputAssociation>
           
      <potentialOwner>
        <resourceAssignmentExpression>
           <formalExpression></formalExpression>
        </resourceAssignmentExpression>
      </potentialOwner>
</userTask>

<sequenceFlow id="con_34095" sourceRef="block130" targetRef="block131">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[gestione_omissis=="no"]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34509" sourceRef="block107" targetRef="block190">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[tipo_determina!="senza_impegno"]]>
    </conditionExpression>
</sequenceFlow>

<scriptTask id="block52" scriptFormat="http://www.mvel.org/2.0" name="Set metadata tipo determina e set determina numerata no" isForCompensation="false" >
    <script>
        <![CDATA[



/************** start user script ***************/

java.util.HashMap doc = new java.util.HashMap();
doc.put("DOCNUM",doc_determina.DOCNUM);
doc.put("DOCNAME",doc_determina.DOCNAME);
doc.put("TYPE_ID",doc_determina.TYPE_ID);
doc.put("TIPO_COMPONENTE",doc_determina.TIPO_COMPONENTE);

if(tipo_determina=="con_impegno_spese"){
       doc.put("TIPO_DETERMINA","Con impegno di spesa (Spese)");
}
if(tipo_determina=="con_impegno_investimenti"){
       doc.put("TIPO_DETERMINA","Con impegno di spesa (Investimenti)");
}
if(tipo_determina=="senza_impegno"){
       doc.put("TIPO_DETERMINA","Senza impegno di spesa");
}
if(tipo_determina=="entrate_spese"){
       doc.put("TIPO_DETERMINA","Con entrate e spese");
}
if(tipo_determina=="solo_entrate"){
       doc.put("TIPO_DETERMINA","Con entrate");
}
if(tipo_determina=="entrate_investimenti"){
       doc.put("TIPO_DETERMINA","Con entrate e investimenti");
}

doc.put("UfficioInserimento",figura_professionale);
doc_determina_copy = doc;


docnum_determina=doc_determina.DOCNUM;

System.out.println("XXXXX lista referenziati ="+ lista_referenziati);
lista_referenziati = new java.util.ArrayList();

if(prima_determina=="si"){
     java.util.ArrayList lista = new java.util.ArrayList();
     lista.add(doc_determina);
     lista_referenziati=lista;
}

prima_determina="no";
determina_numerata="no";

/**************  end user script  ***************/



//[auto-insert]
kcontext.setVariable("doc_determina",null);
kcontext.setVariable("doc_determina",doc_determina);
kcontext.setVariable("doc_determina_copy",null);
kcontext.setVariable("doc_determina_copy",doc_determina_copy);
kcontext.setVariable("determina_numerata",null);
kcontext.setVariable("determina_numerata",determina_numerata);
kcontext.setVariable("docnum_determina",null);
kcontext.setVariable("docnum_determina",docnum_determina);
kcontext.setVariable("lista_referenziati",null);
kcontext.setVariable("lista_referenziati",lista_referenziati);
kcontext.setVariable("prima_determina",null);
kcontext.setVariable("prima_determina",prima_determina);

        ]]>
    </script>
</scriptTask>



<sequenceFlow id="con_34065" sourceRef="block127" targetRef="block128">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34335" sourceRef="block144" targetRef="block167">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[exit=="si"]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34317" sourceRef="block164" targetRef="block135">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[abilita_rest=="si"]]>
    </conditionExpression>
</sequenceFlow>


<callActivity id="block157" isForCompensation="false" independent="false" waitForCompletion="true" name="Invio notifica di gruppo non esistente" calledElementByName="Invio messaggio senza allegati1.0" >
<!-- ioSpecification -->
<ioSpecification>
    <dataInput id="block157_messaggioInput" name="messaggio" />
    <dataInput id="block157_mittenteInput" name="mittente" />
    <dataInput id="block157_instanceNameInput" name="instanceName" />
    <dataInput id="block157_systemTokenInput" name="systemToken" />
    <dataInput id="block157_oggettoInput" name="oggetto" />
    <dataInput id="block157_humanTokenInput" name="humanToken" />
    <dataInput id="block157_destinatarioInput" name="destinatario" />
    <dataInput id="block157_canaleMAILInput" name="canaleMAIL" />
    <dataInput id="block157_descrizioneInput" name="descrizione" />
    <dataInput id="block157_instanceIdInput" name="instanceId" />
    <dataInput id="block157___ckValueInput" name="__ckValue" />
    <dataInput id="block157_canalePECInput" name="canalePEC" />
    <dataInput id="block157_canaleJMSInput" name="canaleJMS" />
    <dataInput id="block157_outcomeInput" name="outcome" />
    <dataInput id="block157_nameInput" name="name" />
    <dataInput id="block157_descriptionInput" name="description" />
    <dataInput id="block157_waitForCompletionInput" name="waitForCompletion" />
    <dataInput id="block157_processNameInput" name="processName" />

    <inputSet>
        <dataInputRefs>block157_messaggioInput</dataInputRefs>
        <dataInputRefs>block157_mittenteInput</dataInputRefs>
        <dataInputRefs>block157_instanceNameInput</dataInputRefs>
        <dataInputRefs>block157_systemTokenInput</dataInputRefs>
        <dataInputRefs>block157_oggettoInput</dataInputRefs>
        <dataInputRefs>block157_humanTokenInput</dataInputRefs>
        <dataInputRefs>block157_destinatarioInput</dataInputRefs>
        <dataInputRefs>block157_canaleMAILInput</dataInputRefs>
        <dataInputRefs>block157_descrizioneInput</dataInputRefs>
        <dataInputRefs>block157_instanceIdInput</dataInputRefs>
        <dataInputRefs>block157___ckValueInput</dataInputRefs>
        <dataInputRefs>block157_canalePECInput</dataInputRefs>
        <dataInputRefs>block157_canaleJMSInput</dataInputRefs>
        <dataInputRefs>block157_outcomeInput</dataInputRefs>
        <dataInputRefs>block157_nameInput</dataInputRefs>
        <dataInputRefs>block157_descriptionInput</dataInputRefs>
        <dataInputRefs>block157_waitForCompletionInput</dataInputRefs>
        <dataInputRefs>block157_processNameInput</dataInputRefs>
    </inputSet>

    <outputSet>
    </outputSet>
</ioSpecification>

<!-- lista inputs -->
<dataInputAssociation><!-- k:messaggio var type: textRef -->
        <sourceRef><![CDATA[corpoNotifica]]></sourceRef>
        <targetRef>block157_messaggioInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:mittente var type: soggetto -->
        <sourceRef><![CDATA[mittente]]></sourceRef>
        <targetRef>block157_mittenteInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:instanceName var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block157_instanceNameInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:systemToken var type: userToken -->
        <sourceRef><![CDATA[systemToken]]></sourceRef>
        <targetRef>block157_systemTokenInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:oggetto var type: textRef -->
        <sourceRef><![CDATA[oggettoNotifica]]></sourceRef>
        <targetRef>block157_oggettoInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:humanToken var type: userToken -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block157_humanTokenInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:destinatario var type: soggetto -->
        <sourceRef><![CDATA[destinatario]]></sourceRef>
        <targetRef>block157_destinatarioInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:canaleMAIL var type: channel -->
        <targetRef>block157_canaleMAILInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[]]></from>
            <to xsi:type="tFormalExpression">block157_canaleMAILInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- k:descrizione var type: script -->
        <sourceRef><![CDATA["Invio notifica di gruppo non esistente";]]></sourceRef>
        <targetRef>block157_descrizioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:instanceId var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block157_instanceIdInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:__ckValue var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block157___ckValueInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:canalePEC var type: channel -->
        <targetRef>block157_canalePECInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[]]></from>
            <to xsi:type="tFormalExpression">block157_canalePECInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- k:canaleJMS var type: channel -->
        <targetRef>block157_canaleJMSInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[]]></from>
            <to xsi:type="tFormalExpression">block157_canaleJMSInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- k:outcome var type: object -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block157_outcomeInput</targetRef>
</dataInputAssociation>

<!-- lista props -->
<dataInputAssociation><!-- var type: string -->
        <targetRef>block157_nameInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[Invio notifica di gruppo non esistente]]></from>
            <to xsi:type="tFormalExpression">block157_nameInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: string -->
        <targetRef>block157_descriptionInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[note]]></from>
            <to xsi:type="tFormalExpression">block157_descriptionInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: bool -->
        <targetRef>block157_waitForCompletionInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[true]]></from>
            <to xsi:type="tFormalExpression">block157_waitForCompletionInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: string -->
        <targetRef>block157_processNameInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[Invio messaggio senza allegati1.0]]></from>
            <to xsi:type="tFormalExpression">block157_processNameInput</to>
        </assignment>
</dataInputAssociation>

<!-- lista outputs -->
    
</callActivity>




<sequenceFlow id="con_34413" sourceRef="block143" targetRef="block142">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<task id="block193" name="Setta ACL Documento" tns:taskName="DocerJMS" >
    <ioSpecification>

        <dataInput id="block193_TaskNameInput" name="TaskName" />
        <dataInput id="block193_GroupIdInput" name="GroupId" />
        <dataInput id="block193_ModeInput" name="mode" />

        <dataInput id="block193_Operation" name="operation" />

            <dataInput id="block193_userTokenInput" name="userToken" />
            <dataInput id="block193_readInput" name="read" />
            <dataInput id="block193_editInput" name="edit" />
            <dataInput id="block193_documentInput" name="document" />
            <dataInput id="block193_fullInput" name="full" />
        
            <dataOutput id="block193_userTokenOutput" name="userToken" />
            <dataOutput id="block193_aclListOutput" name="aclList" />
           

        <inputSet>
            <dataInputRefs>block193_ModeInput</dataInputRefs>
            <dataInputRefs>block193_Operation</dataInputRefs>
            <dataInputRefs>block193_TaskNameInput</dataInputRefs>
            <dataInputRefs>block193_GroupIdInput</dataInputRefs>
                <dataInputRefs>block193_userTokenInput</dataInputRefs>
                <dataInputRefs>block193_readInput</dataInputRefs>
                <dataInputRefs>block193_editInput</dataInputRefs>
                <dataInputRefs>block193_documentInput</dataInputRefs>
                <dataInputRefs>block193_fullInput</dataInputRefs>
        </inputSet>
        
        <outputSet>
                <dataOutputRefs>block193_userTokenOutput</dataOutputRefs>
                <dataOutputRefs>block193_aclListOutput</dataOutputRefs>
                
         </outputSet>

    </ioSpecification>
                <dataInputAssociation>
                            <sourceRef>systemToken</sourceRef>
                            <targetRef>block193_userTokenInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef></sourceRef>
                            <targetRef>block193_readInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef>_tmp2_</sourceRef>
                            <targetRef>block193_editInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef>doc_determina</sourceRef>
                            <targetRef>block193_documentInput</targetRef>

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef></sourceRef>
                            <targetRef>block193_fullInput</targetRef>
                            

                </dataInputAssociation>

      <dataInputAssociation>
        <targetRef>block193_GroupIdInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression"></from>
           <to xsi:type="tFormalExpression">block193_GroupIdInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>block193_TaskNameInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">Setta ACL Documento</from>
           <to xsi:type="tFormalExpression">block193_TaskNameInput</to>
        </assignment>
      </dataInputAssociation>
    <dataInputAssociation>
        <targetRef>block193_ModeInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression">add</from>
            <to xsi:type="tFormalExpression">block193_ModeInput</to>
        </assignment>
    </dataInputAssociation>
    <dataInputAssociation>
        <targetRef>block193_Operation</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression">settaAclDocumento</from>
            <to xsi:type="tFormalExpression">block193_Operation</to>
        </assignment>
    </dataInputAssociation>


            <dataOutputAssociation>
                            <sourceRef>block193_userTokenOutput</sourceRef>
                            <targetRef>systemToken</targetRef>
                            
            </dataOutputAssociation>
            <dataOutputAssociation>
                            <sourceRef>block193_aclListOutput</sourceRef>
                            <targetRef>_tmpc_</targetRef>
                            
            </dataOutputAssociation>
           
      <potentialOwner>
        <resourceAssignmentExpression>
           <formalExpression></formalExpression>
        </resourceAssignmentExpression>
      </potentialOwner>
</task>

<sequenceFlow id="con_34269" sourceRef="block158" targetRef="block159">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34053" sourceRef="block125" targetRef="block126">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_33843" sourceRef="block13" targetRef="block84">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<task id="block59" name="Aggiorna related" tns:taskName="DocerJMS" >
    <ioSpecification>

        <dataInput id="block59_TaskNameInput" name="TaskName" />
        <dataInput id="block59_GroupIdInput" name="GroupId" />
        <dataInput id="block59_Operation" name="operation" />

            <dataInput id="block59_userTokenInput" name="userToken" />
            <dataInput id="block59_relatedDocsInput" name="relatedDocs" />
            <dataInput id="block59_documentInput" name="document" />
        
            <dataOutput id="block59_deltaOutput" name="delta" />
            <dataOutput id="block59_userTokenOutput" name="userToken" />
            <dataOutput id="block59_resultsOutput" name="results" />
            <dataOutput id="block59_firstOutput" name="first" />
           

        <inputSet>
            <dataInputRefs>block59_TaskNameInput</dataInputRefs>
            <dataInputRefs>block59_GroupIdInput</dataInputRefs>
            <dataInputRefs>block59_Operation</dataInputRefs>
                <dataInputRefs>block59_userTokenInput</dataInputRefs>
                <dataInputRefs>block59_relatedDocsInput</dataInputRefs>
                <dataInputRefs>block59_documentInput</dataInputRefs>
        </inputSet>
        
        <outputSet>
                <dataOutputRefs>block59_deltaOutput</dataOutputRefs>
                <dataOutputRefs>block59_userTokenOutput</dataOutputRefs>
                <dataOutputRefs>block59_resultsOutput</dataOutputRefs>
                <dataOutputRefs>block59_firstOutput</dataOutputRefs>
                
         </outputSet>

    </ioSpecification>
                <dataInputAssociation>
                            <sourceRef>systemToken</sourceRef>
                            <targetRef>block59_userTokenInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef>lista_annessi_determina</sourceRef>
                            <targetRef>block59_relatedDocsInput</targetRef>

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef>doc_determina</sourceRef>
                            <targetRef>block59_documentInput</targetRef>

                </dataInputAssociation>

      <dataInputAssociation>
        <targetRef>block59_GroupIdInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression"></from>
           <to xsi:type="tFormalExpression">block59_GroupIdInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>block59_TaskNameInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">Aggiorna related</from>
           <to xsi:type="tFormalExpression">block59_TaskNameInput</to>
        </assignment>
      </dataInputAssociation>
    <dataInputAssociation>
        <targetRef>block59_Operation</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression">AggiornaRelated</from>
            <to xsi:type="tFormalExpression">block59_Operation</to>
        </assignment>
    </dataInputAssociation>



            <dataOutputAssociation>
                            <sourceRef>block59_deltaOutput</sourceRef>
                            <targetRef></targetRef>
            </dataOutputAssociation>
            <dataOutputAssociation>
                            <sourceRef>block59_userTokenOutput</sourceRef>
                            <targetRef>systemToken</targetRef>
                            
            </dataOutputAssociation>
            <dataOutputAssociation>
                            <sourceRef>block59_resultsOutput</sourceRef>
                            <targetRef></targetRef>
            </dataOutputAssociation>
            <dataOutputAssociation>
                            <sourceRef>block59_firstOutput</sourceRef>
                            <targetRef>doc_determina</targetRef>
            </dataOutputAssociation>
           
      <potentialOwner>
        <resourceAssignmentExpression>
           <formalExpression></formalExpression>
        </resourceAssignmentExpression>
      </potentialOwner>
</task>

<scriptTask id="block75" scriptFormat="http://www.mvel.org/2.0" name="Generazione lista allegati" isForCompensation="false" >
    <script>
        <![CDATA[



/************** start user script ***************/

lista_annessi_determina.add(doc_visto);

/**************  end user script  ***************/



//[auto-insert]
kcontext.setVariable("lista_annessi_determina",null);
kcontext.setVariable("lista_annessi_determina",lista_annessi_determina);

        ]]>
    </script>
</scriptTask>



<inclusiveGateway id="block154" name="gateway-branching" gatewayDirection="Diverging"></inclusiveGateway>
<sequenceFlow id="con_34275" sourceRef="block159" targetRef="block160">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34503" sourceRef="block189" targetRef="block3">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<endEvent id="block25" name="end">

</endEvent>

<sequenceFlow id="con_34047" sourceRef="block124" targetRef="block125">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34533" sourceRef="block192" targetRef="block166">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34371" sourceRef="block170" targetRef="block169">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[abilita_rest=="no"]]>
    </conditionExpression>
</sequenceFlow>

<inclusiveGateway id="block170" name="gateway-branching" gatewayDirection="Diverging"></inclusiveGateway>
<sequenceFlow id="con_34281" sourceRef="block160" targetRef="block161">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34059" sourceRef="block126" targetRef="block127">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34377" sourceRef="block165" targetRef="block67">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_33927" sourceRef="block31" targetRef="block74">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34071" sourceRef="block128" targetRef="block129">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34437" sourceRef="block182" targetRef="block83">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34443" sourceRef="block183" targetRef="block7">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>


<callActivity id="block126" isForCompensation="false" independent="false" waitForCompletion="true" name="AMD Conversione UD omissis" calledElementByName="AMD_ConversioneUD2.0" >
<!-- ioSpecification -->
<ioSpecification>
    <dataInput id="block126_instanceNameInput" name="instanceName" />
    <dataInput id="block126_systemTokenInput" name="systemToken" />
    <dataInput id="block126_conversione_manualeInput" name="conversione_manuale" />
    <dataInput id="block126_humanTokenInput" name="humanToken" />
    <dataInput id="block126_abilita_ht_verificaInput" name="abilita_ht_verifica" />
    <dataInput id="block126_descrizioneInput" name="descrizione" />
    <dataInput id="block126_instanceIdInput" name="instanceId" />
    <dataInput id="block126_canalePECInput" name="canalePEC" />
    <dataInput id="block126_docnum_principaleInput" name="docnum_principale" />
    <dataInput id="block126_figura_professionaleInput" name="figura_professionale" />
    <dataInput id="block126_userInput" name="user" />
    <dataInput id="block126_outcomeInput" name="outcome" />
    <dataInput id="block126_nameInput" name="name" />
    <dataInput id="block126_descriptionInput" name="description" />
    <dataInput id="block126_waitForCompletionInput" name="waitForCompletion" />
    <dataInput id="block126_processNameInput" name="processName" />
    <dataOutput id="block126_principale_nuova_udOutput" name="principale_nuova_ud" />

    <inputSet>
        <dataInputRefs>block126_instanceNameInput</dataInputRefs>
        <dataInputRefs>block126_systemTokenInput</dataInputRefs>
        <dataInputRefs>block126_conversione_manualeInput</dataInputRefs>
        <dataInputRefs>block126_humanTokenInput</dataInputRefs>
        <dataInputRefs>block126_abilita_ht_verificaInput</dataInputRefs>
        <dataInputRefs>block126_descrizioneInput</dataInputRefs>
        <dataInputRefs>block126_instanceIdInput</dataInputRefs>
        <dataInputRefs>block126_canalePECInput</dataInputRefs>
        <dataInputRefs>block126_docnum_principaleInput</dataInputRefs>
        <dataInputRefs>block126_figura_professionaleInput</dataInputRefs>
        <dataInputRefs>block126_userInput</dataInputRefs>
        <dataInputRefs>block126_outcomeInput</dataInputRefs>
        <dataInputRefs>block126_nameInput</dataInputRefs>
        <dataInputRefs>block126_descriptionInput</dataInputRefs>
        <dataInputRefs>block126_waitForCompletionInput</dataInputRefs>
        <dataInputRefs>block126_processNameInput</dataInputRefs>
    </inputSet>

    <outputSet>
        <dataOutputRefs>block126_principale_nuova_udOutput</dataOutputRefs>
    </outputSet>
</ioSpecification>

<!-- lista inputs -->
<dataInputAssociation><!-- k:instanceName var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block126_instanceNameInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:systemToken var type: userToken -->
        <sourceRef><![CDATA[systemToken]]></sourceRef>
        <targetRef>block126_systemTokenInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:conversione_manuale var type: script -->
        <sourceRef><![CDATA["no";]]></sourceRef>
        <targetRef>block126_conversione_manualeInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:humanToken var type: userToken -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block126_humanTokenInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:abilita_ht_verifica var type: script -->
        <sourceRef><![CDATA["no";]]></sourceRef>
        <targetRef>block126_abilita_ht_verificaInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:descrizione var type: script -->
        <sourceRef><![CDATA["Conversione documento omissis";]]></sourceRef>
        <targetRef>block126_descrizioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:instanceId var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block126_instanceIdInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:canalePEC var type: channel -->
        <targetRef>block126_canalePECInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[]]></from>
            <to xsi:type="tFormalExpression">block126_canalePECInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- k:docnum_principale var type: script -->
        <sourceRef><![CDATA[doc_testo_determina.DOCNUM;]]></sourceRef>
        <targetRef>block126_docnum_principaleInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:figura_professionale var type: textRef -->
        <sourceRef><![CDATA[figura_professionale2]]></sourceRef>
        <targetRef>block126_figura_professionaleInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:user var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block126_userInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:outcome var type: object -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block126_outcomeInput</targetRef>
</dataInputAssociation>

<!-- lista props -->
<dataInputAssociation><!-- var type: string -->
        <targetRef>block126_nameInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[AMD Conversione UD omissis]]></from>
            <to xsi:type="tFormalExpression">block126_nameInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: string -->
        <targetRef>block126_descriptionInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[note]]></from>
            <to xsi:type="tFormalExpression">block126_descriptionInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: bool -->
        <targetRef>block126_waitForCompletionInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[true]]></from>
            <to xsi:type="tFormalExpression">block126_waitForCompletionInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: string -->
        <targetRef>block126_processNameInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[AMD_ConversioneUD2.0]]></from>
            <to xsi:type="tFormalExpression">block126_processNameInput</to>
        </assignment>
</dataInputAssociation>

<!-- lista outputs -->
<dataOutputAssociation>
        <sourceRef>block126_principale_nuova_udOutput</sourceRef>
        <targetRef>doc_testo_determina</targetRef>
</dataOutputAssociation>
    
</callActivity>




<sequenceFlow id="con_33945" sourceRef="block107" targetRef="block100">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[tipo_determina=="senza_impegno"]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_33765" sourceRef="block14" targetRef="block13">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[esito=="no" || esito=="rev"]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34497" sourceRef="block96" targetRef="block189">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<task id="block135" name="callRestService email Ufficio" tns:taskName="callRestService-task" >
    <ioSpecification>

        <dataInput id="block135_description" name="description" />
        <dataInput id="block135_name" name="name" />


        <dataInput id="block135_userTokenInput" name="userToken" />
        <dataInput id="block135_urlInput" name="url" />

        <dataOutput id="block135_UserTokenOutput" name="userToken" />
        <dataOutput id="block135_responseArrayOutput" name="responseArray" />
        <dataOutput id="block135_responseObjectOutput" name="responseObject" />


        <inputSet>
            <dataInputRefs>block135_name</dataInputRefs>
            <dataInputRefs>block135_description</dataInputRefs>
            <dataInputRefs>block135_userTokenInput</dataInputRefs>
            <dataInputRefs>block135_urlInput</dataInputRefs>
        </inputSet>

        <outputSet>

            <dataOutputRefs>block135_UserTokenOutput</dataOutputRefs>
            <dataOutputRefs>block135_responseArrayOutput</dataOutputRefs>
            <dataOutputRefs>block135_responseObjectOutput</dataOutputRefs>

        </outputSet>

    </ioSpecification>
    <dataInputAssociation>
                <sourceRef>systemToken</sourceRef>
                <targetRef>block135_userTokenInput</targetRef>


    </dataInputAssociation>
    <dataInputAssociation>
                <sourceRef>url_rest_uffici+figura_professionale;</sourceRef>
                <targetRef>block135_urlInput</targetRef>


    </dataInputAssociation>



    <dataOutputAssociation>
                <sourceRef>block135_responseArrayOutput</sourceRef>
                <targetRef>responseArray</targetRef>

    </dataOutputAssociation>
    <dataOutputAssociation>
                <sourceRef>block135_responseObjectOutput</sourceRef>
                <targetRef>responseObject</targetRef>

    </dataOutputAssociation>


</task>
<sequenceFlow id="con_33795" sourceRef="block52" targetRef="block53">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_33837" sourceRef="block83" targetRef="block81">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[esito=="si"]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34215" sourceRef="block152" targetRef="block5">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34485" sourceRef="block80" targetRef="block187">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[controllo_responsabile=="si"]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34125" sourceRef="block133" targetRef="block124">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<scriptTask id="block189" scriptFormat="http://www.mvel.org/2.0" name="Gestione BS e timeline" isForCompensation="false" >
    <script>
        <![CDATA[



/************** start user script ***************/

businessState = "statoDetermina5";
timeline_state = 5;

/**************  end user script  ***************/

//[auto-insert]
//Business State (businessState), timeline_state
kcontext.setVariable("businessState",null);
kcontext.setVariable("businessState",businessState);
kcontext.setVariable("timeline_state",null);
kcontext.setVariable("timeline_state",timeline_state);



        ]]>
    </script>
</scriptTask>



<sequenceFlow id="con_34569" sourceRef="block203" targetRef="block208">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<!-- id:block0 -->
<startEvent id="block0" name="Start" isInterrupting="false" >
    <dataOutput id="block0_Output" name="object" />

    <outputSet>
        <dataOutputRefs>block0_Output</dataOutputRefs>
    </outputSet>

    <dataOutputAssociation>
        <sourceRef>block0_Output</sourceRef>
        <targetRef>_tmpevt_</targetRef>
    </dataOutputAssociation>

</startEvent>


<callActivity id="block147" isForCompensation="false" independent="false" waitForCompletion="true" name="Invio notifica annullamento automatico dell'atto" calledElementByName="Invio messaggio senza allegati1.0" >
<!-- ioSpecification -->
<ioSpecification>
    <dataInput id="block147_messaggioInput" name="messaggio" />
    <dataInput id="block147_mittenteInput" name="mittente" />
    <dataInput id="block147_instanceNameInput" name="instanceName" />
    <dataInput id="block147_systemTokenInput" name="systemToken" />
    <dataInput id="block147_oggettoInput" name="oggetto" />
    <dataInput id="block147_humanTokenInput" name="humanToken" />
    <dataInput id="block147_destinatarioInput" name="destinatario" />
    <dataInput id="block147_canaleMAILInput" name="canaleMAIL" />
    <dataInput id="block147_descrizioneInput" name="descrizione" />
    <dataInput id="block147_instanceIdInput" name="instanceId" />
    <dataInput id="block147___ckValueInput" name="__ckValue" />
    <dataInput id="block147_canalePECInput" name="canalePEC" />
    <dataInput id="block147_canaleJMSInput" name="canaleJMS" />
    <dataInput id="block147_outcomeInput" name="outcome" />
    <dataInput id="block147_nameInput" name="name" />
    <dataInput id="block147_descriptionInput" name="description" />
    <dataInput id="block147_waitForCompletionInput" name="waitForCompletion" />
    <dataInput id="block147_processNameInput" name="processName" />

    <inputSet>
        <dataInputRefs>block147_messaggioInput</dataInputRefs>
        <dataInputRefs>block147_mittenteInput</dataInputRefs>
        <dataInputRefs>block147_instanceNameInput</dataInputRefs>
        <dataInputRefs>block147_systemTokenInput</dataInputRefs>
        <dataInputRefs>block147_oggettoInput</dataInputRefs>
        <dataInputRefs>block147_humanTokenInput</dataInputRefs>
        <dataInputRefs>block147_destinatarioInput</dataInputRefs>
        <dataInputRefs>block147_canaleMAILInput</dataInputRefs>
        <dataInputRefs>block147_descrizioneInput</dataInputRefs>
        <dataInputRefs>block147_instanceIdInput</dataInputRefs>
        <dataInputRefs>block147___ckValueInput</dataInputRefs>
        <dataInputRefs>block147_canalePECInput</dataInputRefs>
        <dataInputRefs>block147_canaleJMSInput</dataInputRefs>
        <dataInputRefs>block147_outcomeInput</dataInputRefs>
        <dataInputRefs>block147_nameInput</dataInputRefs>
        <dataInputRefs>block147_descriptionInput</dataInputRefs>
        <dataInputRefs>block147_waitForCompletionInput</dataInputRefs>
        <dataInputRefs>block147_processNameInput</dataInputRefs>
    </inputSet>

    <outputSet>
    </outputSet>
</ioSpecification>

<!-- lista inputs -->
<dataInputAssociation><!-- k:messaggio var type: textRef -->
        <sourceRef><![CDATA[corpoNotifica]]></sourceRef>
        <targetRef>block147_messaggioInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:mittente var type: soggetto -->
        <sourceRef><![CDATA[mittente]]></sourceRef>
        <targetRef>block147_mittenteInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:instanceName var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block147_instanceNameInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:systemToken var type: userToken -->
        <sourceRef><![CDATA[systemToken]]></sourceRef>
        <targetRef>block147_systemTokenInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:oggetto var type: textRef -->
        <sourceRef><![CDATA[oggettoNotifica]]></sourceRef>
        <targetRef>block147_oggettoInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:humanToken var type: userToken -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block147_humanTokenInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:destinatario var type: soggetto -->
        <sourceRef><![CDATA[destinatario]]></sourceRef>
        <targetRef>block147_destinatarioInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:canaleMAIL var type: channel -->
        <targetRef>block147_canaleMAILInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[]]></from>
            <to xsi:type="tFormalExpression">block147_canaleMAILInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- k:descrizione var type: script -->
        <sourceRef><![CDATA["Invio notifica annullamento automatico dell'atto";]]></sourceRef>
        <targetRef>block147_descrizioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:instanceId var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block147_instanceIdInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:__ckValue var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block147___ckValueInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:canalePEC var type: channel -->
        <targetRef>block147_canalePECInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[]]></from>
            <to xsi:type="tFormalExpression">block147_canalePECInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- k:canaleJMS var type: channel -->
        <targetRef>block147_canaleJMSInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[]]></from>
            <to xsi:type="tFormalExpression">block147_canaleJMSInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- k:outcome var type: object -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block147_outcomeInput</targetRef>
</dataInputAssociation>

<!-- lista props -->
<dataInputAssociation><!-- var type: string -->
        <targetRef>block147_nameInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[Invio notifica annullamento automatico dell'atto]]></from>
            <to xsi:type="tFormalExpression">block147_nameInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: string -->
        <targetRef>block147_descriptionInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[note]]></from>
            <to xsi:type="tFormalExpression">block147_descriptionInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: bool -->
        <targetRef>block147_waitForCompletionInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[true]]></from>
            <to xsi:type="tFormalExpression">block147_waitForCompletionInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- var type: string -->
        <targetRef>block147_processNameInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[Invio messaggio senza allegati1.0]]></from>
            <to xsi:type="tFormalExpression">block147_processNameInput</to>
        </assignment>
</dataInputAssociation>

<!-- lista outputs -->
    
</callActivity>




<scriptTask id="block184" scriptFormat="http://www.mvel.org/2.0" name="Gestione BS e timeline" isForCompensation="false" >
    <script>
        <![CDATA[



/************** start user script ***************/

businessState = "statoDetermina1";

if(java.lang.String.class.isInstance(timeline_state)) {
	timeline_state = Integer.parseInt(timeline_state);
}

timeline_state = timeline_state + 1;

/**************  end user script  ***************/

//[auto-insert]
//Business State (businessState), timeline_state, timeline_state, timeline_state
kcontext.setVariable("businessState",null);
kcontext.setVariable("businessState",businessState);
kcontext.setVariable("timeline_state",null);
kcontext.setVariable("timeline_state",timeline_state);
kcontext.setVariable("timeline_state",null);
kcontext.setVariable("timeline_state",timeline_state);
kcontext.setVariable("timeline_state",null);
kcontext.setVariable("timeline_state",timeline_state);



        ]]>
    </script>
</scriptTask>



<inclusiveGateway id="block107" name="gateway-branching" gatewayDirection="Diverging"></inclusiveGateway>
<sequenceFlow id="con_34227" sourceRef="block154" targetRef="block152">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[gruppi_parent_proponente.size()>0]]>
    </conditionExpression>
</sequenceFlow>

<inclusiveGateway id="block132" name="gateway-branching" gatewayDirection="Diverging"></inclusiveGateway>
<inclusiveGateway id="block46" name="gateway-merge" gatewayDirection="Converging"></inclusiveGateway>
<sequenceFlow id="con_33849" sourceRef="block89" targetRef="block90">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[determina_numerata=="no"]]>
    </conditionExpression>
</sequenceFlow>

<scriptTask id="block171" scriptFormat="http://www.mvel.org/2.0" name="Gestione metadato controllo responsabile" isForCompensation="false" >
    <script>
        <![CDATA[



/************** start user script ***************/

doc_determina_copy = new java.util.HashMap();
doc_determina_copy.put("DOCNUM",doc_determina.DOCNUM);
doc_determina_copy.put("DOCNAME",doc_determina.DOCNAME);
doc_determina_copy.put("TYPE_ID",doc_determina.TYPE_ID);
doc_determina_copy.put("TIPO_COMPONENTE",doc_determina.TIPO_COMPONENTE);

doc_determina_copy.put("flag_controllo_responsabile",controllo_responsabile);

/**************  end user script  ***************/



//[auto-insert]
kcontext.setVariable("doc_determina_copy",null);
kcontext.setVariable("doc_determina_copy",doc_determina_copy);

        ]]>
    </script>
</scriptTask>



<scriptTask id="block124" scriptFormat="http://www.mvel.org/2.0" name="Script-task gestione degli omissis" isForCompensation="false" >
    <script>
        <![CDATA[



/************** start user script ***************/

System.out.println("XXXXX "+omissis);
java.util.HashMap variabili_determina_omissis = new java.util.HashMap(variabili_determina);
java.util.List oms = new java.util.ArrayList();
if(omissis.contains(",")){
	String[] parts =omissis.split(",");
	String s = new java.lang.Object();
	foreach (s : parts) {
		oms.add(s);
	}
}else if(omissis!=""){
        oms.add(omissis);
}

System.out.println("XXXXX "+oms.toString());
java.lang.String ele = new java.lang.String();
foreach(ele : oms){
		if(ele=="AttoStakehold"){
         	variabili_determina_omissis[ele]="Dato atto che risulta necessario/utile dare informazione del presente provvedimento ai seguenti soggetti: OMISSIS";
		}else if(ele=="DispDispBenef"){
			variabili_determina_omissis[ele]="Di dare atto che i beneficiari del presente atto sono i seguenti: OMISSIS";
		}else if(ele=="DispDispContr"){
			variabili_determina_omissis[ele]="Di dare atto che i contraenti del presente atto sono i seguenti soggetti: OMISSIS";
		}else if(ele=="DispDispDestin"){
			variabili_determina_omissis[ele]="Di dare atto che i destinatari del presente atto sono i seguenti soggetti: OMISSIS";
		}else{
			variabili_determina_omissis[ele]="OMISSIS";
		}		
}
System.out.println("XXXXX "+variabili_determina_omissis.toString());

/**************  end user script  ***************/



//[auto-insert]
kcontext.setVariable("variabili_determina_omissis",null);
kcontext.setVariable("variabili_determina_omissis",variabili_determina_omissis);

        ]]>
    </script>
</scriptTask>



<sequenceFlow id="con_33801" sourceRef="block7" targetRef="block57">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[esito=="no" || esito=="rev"]]>
    </conditionExpression>
</sequenceFlow>

<scriptTask id="block146" scriptFormat="http://www.mvel.org/2.0" name="Gestione response organigramma" isForCompensation="false" >
    <script>
        <![CDATA[



/************** start user script ***************/

java.text.DateFormat df = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss",java.util.Locale.ITALIAN);
java.text.DateFormat df2 = new java.text.SimpleDateFormat("yyyy-MM-dd");
java.util.Date dataRegistrazione = df.parse(doc_determina.D_REGISTRAZ);
java.lang.String OLD_FORMAT = "yyyy-MM-dd";
java.lang.String NEW_FORMAT = "dd/MM/yyyy";
java.lang.String oldDateString = df2.format(dataRegistrazione);
java.text.SimpleDateFormat sdf = new java.text.SimpleDateFormat(OLD_FORMAT);
java.util.Date d = sdf.parse(oldDateString);
sdf.applyPattern(NEW_FORMAT);
java.lang.String dReg = sdf.format(d);

java.lang.String indirizzoUfficio = responseArray.get(0).EmailUO;
java.lang.String oggettoMail = "";
java.lang.String corpoMail = "";

if(indirizzoUfficio!=""){
     destinatario.put("IndirizzoTelematico",indirizzoUfficio);
     oggettoMail="Annullamento automatico della determina "+doc_determina.N_REGISTRAZ+" del "+dReg;
     corpoMail="Si comunica che la determina "+doc_determina.N_REGISTRAZ+" del "+dReg+" recante oggetto "+doc_determina.INTOGGETTO+" e' stata annullata in automatico a seguito di richiesta di revisione/correzione.";
}else{
     destinatario.put("IndirizzoTelematico",indirizzoDefault);
     oggettoMail="Mancato recapito notifica istanza con id. "+instanceId+" e oggetto "+doc_determina.INTOGGETTO;
     corpoMail="Si comunica che l'invio di notifica non e' andato a buon fine in quanto il gruppo "+responseArray.get(0).CodiceUO+" non ha associato alcun indirizzo email.";
}

oggettoNotifica=oggettoMail;
corpoNotifica=corpoMail;

/**************  end user script  ***************/



//[auto-insert]
kcontext.setVariable("oggettoNotifica",null);
kcontext.setVariable("oggettoNotifica",oggettoNotifica);
kcontext.setVariable("corpoNotifica",null);
kcontext.setVariable("corpoNotifica",corpoNotifica);
kcontext.setVariable("destinatario",null);
kcontext.setVariable("destinatario",destinatario);

        ]]>
    </script>
</scriptTask>



<sequenceFlow id="con_34449" sourceRef="block0" targetRef="block184">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<task id="block137" name="callRestService email Ufficio" tns:taskName="callRestService-task" >
    <ioSpecification>

        <dataInput id="block137_description" name="description" />
        <dataInput id="block137_name" name="name" />


        <dataInput id="block137_userTokenInput" name="userToken" />
        <dataInput id="block137_urlInput" name="url" />

        <dataOutput id="block137_UserTokenOutput" name="userToken" />
        <dataOutput id="block137_responseArrayOutput" name="responseArray" />
        <dataOutput id="block137_responseObjectOutput" name="responseObject" />


        <inputSet>
            <dataInputRefs>block137_name</dataInputRefs>
            <dataInputRefs>block137_description</dataInputRefs>
            <dataInputRefs>block137_userTokenInput</dataInputRefs>
            <dataInputRefs>block137_urlInput</dataInputRefs>
        </inputSet>

        <outputSet>

            <dataOutputRefs>block137_UserTokenOutput</dataOutputRefs>
            <dataOutputRefs>block137_responseArrayOutput</dataOutputRefs>
            <dataOutputRefs>block137_responseObjectOutput</dataOutputRefs>

        </outputSet>

    </ioSpecification>
    <dataInputAssociation>
                <sourceRef>systemToken</sourceRef>
                <targetRef>block137_userTokenInput</targetRef>


    </dataInputAssociation>
    <dataInputAssociation>
                <sourceRef>url_rest_uffici+figura_professionale;</sourceRef>
                <targetRef>block137_urlInput</targetRef>


    </dataInputAssociation>



    <dataOutputAssociation>
                <sourceRef>block137_responseArrayOutput</sourceRef>
                <targetRef>responseArray</targetRef>

    </dataOutputAssociation>
    <dataOutputAssociation>
                <sourceRef>block137_responseObjectOutput</sourceRef>
                <targetRef>responseObject</targetRef>

    </dataOutputAssociation>


</task>
<inclusiveGateway id="block164" name="gateway-branching" gatewayDirection="Diverging"></inclusiveGateway>
<userTask id="block123" name="HT-Generico_block123" >


    <ioSpecification>

        <dataInput id="block123_TaskNameInput" name="TaskName" />
        <dataInput id="block123_GroupIdInput" name="GroupId" />
        <dataInput id="block123_SwimlaneActorIdInput" name="SwimlaneActorId" />

            <dataInput id="block123_commentInput" name="comment" />
            <dataInput id="block123_variabili_determinaInput" name="variabili_determina" />
            <dataInput id="block123_tipo_determinaInput" name="tipo_determina" />
            <dataInput id="block123_omissisInput" name="omissis" />
        
            <dataOutput id="block123_reasonOutput" name="reason" />
            <dataOutput id="block123_userTokenOutput" name="userToken" />
            <dataOutput id="block123_omissisOutput" name="omissis" />
           

        <inputSet>
            <dataInputRefs>block123_SwimlaneActorIdInput</dataInputRefs>
            <dataInputRefs>block123_TaskNameInput</dataInputRefs>
            <dataInputRefs>block123_GroupIdInput</dataInputRefs>
                <dataInputRefs>block123_commentInput</dataInputRefs>
                <dataInputRefs>block123_variabili_determinaInput</dataInputRefs>
                <dataInputRefs>block123_tipo_determinaInput</dataInputRefs>
                <dataInputRefs>block123_omissisInput</dataInputRefs>
        </inputSet>
        
        <outputSet>
                <dataOutputRefs>block123_reasonOutput</dataOutputRefs>
                <dataOutputRefs>block123_userTokenOutput</dataOutputRefs>
                <dataOutputRefs>block123_omissisOutput</dataOutputRefs>
                
         </outputSet>

    </ioSpecification>
                <dataInputAssociation>
                                <targetRef>block123_commentInput</targetRef>
                                <assignment>
                                <from xsi:type="tFormalExpression"><![CDATA[]]></from>
                                <to xsi:type="tFormalExpression">block123_commentInput</to>
                                </assignment>

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef>variabili_determina</sourceRef>
                            <targetRef>block123_variabili_determinaInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef>tipo_determina</sourceRef>
                            <targetRef>block123_tipo_determinaInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef>omissis</sourceRef>
                            <targetRef>block123_omissisInput</targetRef>
                            

                </dataInputAssociation>

      <dataInputAssociation>
          <sourceRef>Default2.identity</sourceRef>
          <targetRef>block123_GroupIdInput</targetRef>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>block123_TaskNameInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression">"Gestione omissis determina"</from>
           <to xsi:type="tFormalExpression">block123_TaskNameInput</to>
        </assignment>
      </dataInputAssociation>
            <dataOutputAssociation>
                    <sourceRef>block123_reasonOutput</sourceRef>
                    <targetRef></targetRef>
            </dataOutputAssociation>
            <dataOutputAssociation>
                    <sourceRef>block123_userTokenOutput</sourceRef>
                    <targetRef>humanToken</targetRef>
            </dataOutputAssociation>
            <dataOutputAssociation>
                    <sourceRef>block123_omissisOutput</sourceRef>
                    <targetRef>omissis</targetRef>
            </dataOutputAssociation>
           
      <potentialOwner>
        <resourceAssignmentExpression>
           <formalExpression></formalExpression>
        </resourceAssignmentExpression>
      </potentialOwner>
</userTask>

<task id="block175" name="getProfileDocument" tns:taskName="DocerJMS" >
    <ioSpecification>

        <dataInput id="block175_TaskNameInput" name="TaskName" />
        <dataInput id="block175_GroupIdInput" name="GroupId" />
        <dataInput id="block175_Operation" name="operation" />
        <dataInput id="block175_ForceDownloadDocument" name="forceDownloadDocument" />

            <dataInput id="block175_userTokenInput" name="userToken" />
            <dataInput id="block175_documentInput" name="document" />
        
            <dataOutput id="block175_userTokenOutput" name="userToken" />
            <dataOutput id="block175_allegatiOutput" name="allegati" />
            <dataOutput id="block175_documentOutput" name="document" />
            <dataOutput id="block175_filePathOutput" name="filePath" />
           

        <inputSet>
            <dataInputRefs>block175_TaskNameInput</dataInputRefs>
            <dataInputRefs>block175_GroupIdInput</dataInputRefs>
            <dataInputRefs>block175_ForceDownloadDocument</dataInputRefs>
            <dataInputRefs>block175_Operation</dataInputRefs>
                <dataInputRefs>block175_userTokenInput</dataInputRefs>
                <dataInputRefs>block175_documentInput</dataInputRefs>
        </inputSet>
        
        <outputSet>
                <dataOutputRefs>block175_userTokenOutput</dataOutputRefs>
                <dataOutputRefs>block175_allegatiOutput</dataOutputRefs>
                <dataOutputRefs>block175_documentOutput</dataOutputRefs>
                <dataOutputRefs>block175_filePathOutput</dataOutputRefs>
                
         </outputSet>

    </ioSpecification>
                <dataInputAssociation>
                            <sourceRef>systemToken</sourceRef>
                            <targetRef>block175_userTokenInput</targetRef>
                            

                </dataInputAssociation>
                <dataInputAssociation>
                            <sourceRef>doc_determina</sourceRef>
                            <targetRef>block175_documentInput</targetRef>

                </dataInputAssociation>
				<dataInputAssociation>
			        <targetRef>block175_ForceDownloadDocument</targetRef>
			        <assignment>
			            <from xsi:type="tFormalExpression">false</from>
			            <to xsi:type="tFormalExpression">block175_ForceDownloadDocument</to>
			        </assignment>
			    </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>block175_GroupIdInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression"></from>
           <to xsi:type="tFormalExpression">block175_GroupIdInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>block175_TaskNameInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">getProfileDocument</from>
           <to xsi:type="tFormalExpression">block175_TaskNameInput</to>
        </assignment>
      </dataInputAssociation>
	  <dataInputAssociation>
        <targetRef>block175_Operation</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">RecuperaProfiloDocumento</from>
           <to xsi:type="tFormalExpression">block175_Operation</to>
        </assignment>
      </dataInputAssociation>

            <dataOutputAssociation>
                            <sourceRef>block175_userTokenOutput</sourceRef>
                            <targetRef>systemToken</targetRef>
                            
            </dataOutputAssociation>
            <dataOutputAssociation>
                            <sourceRef>block175_allegatiOutput</sourceRef>
                            <targetRef></targetRef>
            </dataOutputAssociation>
            <dataOutputAssociation>
                            <sourceRef>block175_documentOutput</sourceRef>
                            <targetRef>doc_determina</targetRef>
            </dataOutputAssociation>
            <dataOutputAssociation>
                            <sourceRef>block175_filePathOutput</sourceRef>
                            <targetRef></targetRef>
                            
            </dataOutputAssociation>
           
      <potentialOwner>
        <resourceAssignmentExpression>
           <formalExpression></formalExpression>
        </resourceAssignmentExpression>
      </potentialOwner>
</task>

<inclusiveGateway id="block6" name="gateway-branching" gatewayDirection="Diverging"></inclusiveGateway>
<inclusiveGateway id="block90" name="gateway-merge" gatewayDirection="Converging"></inclusiveGateway>
<sequenceFlow id="con_34623" sourceRef="block119" targetRef="block173">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_33807" sourceRef="block65" targetRef="block66">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34515" sourceRef="block190" targetRef="block106">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34341" sourceRef="block166" targetRef="block167">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[abilita_rest=="no"]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34287" sourceRef="block161" targetRef="block152">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>

<sequenceFlow id="con_34041" sourceRef="block122" targetRef="block87">
    <conditionExpression language="http://www.mvel.org/2.0" xsi:type="tFormalExpression" >
        <![CDATA[true]]>
    </conditionExpression>
</sequenceFlow>


<callActivity id="block183" isForCompensation="false" independent="false" waitForCompletion="true" name="AMD Approvazione determina" calledElementByName="AMD_ApprovazioneUD2.6" >
<!-- ioSpecification -->
<ioSpecification>
    <dataInput id="block183_noteInput" name="note" />
    <dataInput id="block183_instanceNameInput" name="instanceName" />
    <dataInput id="block183_tipologiePrincipaleInput" name="tipologiePrincipale" />
    <dataInput id="block183_approvatoriInput" name="approvatori" />
    <dataInput id="block183_descrizioneTaskInput" name="descrizioneTask" />
    <dataInput id="block183_tipologieAnnotazioneInput" name="tipologieAnnotazione" />
    <dataInput id="block183_INSTANCE_AOOInput" name="INSTANCE_AOO" />
    <dataInput id="block183_humanTokenInput" name="humanToken" />
    <dataInput id="block183_invio_notificaInput" name="invio_notifica" />
    <dataInput id="block183_instanceIdInput" name="instanceId" />
    <dataInput id="block183_gestioneAggiuntaRelatedInput" name="gestioneAggiuntaRelated" />
    <dataInput id="block183_INSTANCE_ENTEInput" name="INSTANCE_ENTE" />
    <dataInput id="block183_lanesInput" name="lanes" />
    <dataInput id="block183_formatoDataPerNoteInput" name="formatoDataPerNote" />
    <dataInput id="block183_outcomeInput" name="outcome" />
    <dataInput id="block183_mittenteInput" name="mittente" />
    <dataInput id="block183_nomeHTApprovazioneInput" name="nomeHTApprovazione" />
    <dataInput id="block183_systemTokenInput" name="systemToken" />
    <dataInput id="block183_gestioneEliminaInput" name="gestioneElimina" />
    <dataInput id="block183_descrizioneInput" name="descrizione" />
    <dataInput id="block183_tipologieAnnessoInput" name="tipologieAnnesso" />
    <dataInput id="block183_canalePECInput" name="canalePEC" />
    <dataInput id="block183_filenameDinamicoInput" name="filenameDinamico" />
    <dataInput id="block183_tipologieAllegatoInput" name="tipologieAllegato" />
    <dataInput id="block183_docnum_principaleInput" name="docnum_principale" />
    <dataInput id="block183_figura_professionaleInput" name="figura_professionale" />
    <dataInput id="block183_userInput" name="user" />
    <dataInput id="block183_commitInput" name="commit" />
    <dataOutput id="block183_utente_approvatoreOutput" name="utente_approvatore" />
    <dataOutput id="block183_esitoOutput" name="esito" />
    <dataOutput id="block183_businessStateOutput" name="businessState" />
    <dataOutput id="block183_systemTokenOutput" name="systemToken" />
    <dataOutput id="block183_principaleOutput" name="principale" />
    <dataOutput id="block183_lanesOutput" name="lanes" />
    <dataOutput id="block183_richiesta_revisioneOutput" name="richiesta_revisione" />

    <inputSet>
        <dataInputRefs>block183_noteInput</dataInputRefs>
        <dataInputRefs>block183_instanceNameInput</dataInputRefs>
        <dataInputRefs>block183_tipologiePrincipaleInput</dataInputRefs>
        <dataInputRefs>block183_approvatoriInput</dataInputRefs>
        <dataInputRefs>block183_descrizioneTaskInput</dataInputRefs>
        <dataInputRefs>block183_tipologieAnnotazioneInput</dataInputRefs>
        <dataInputRefs>block183_INSTANCE_AOOInput</dataInputRefs>
        <dataInputRefs>block183_humanTokenInput</dataInputRefs>
        <dataInputRefs>block183_invio_notificaInput</dataInputRefs>
        <dataInputRefs>block183_instanceIdInput</dataInputRefs>
        <dataInputRefs>block183_gestioneAggiuntaRelatedInput</dataInputRefs>
        <dataInputRefs>block183_INSTANCE_ENTEInput</dataInputRefs>
        <dataInputRefs>block183_lanesInput</dataInputRefs>
        <dataInputRefs>block183_formatoDataPerNoteInput</dataInputRefs>
        <dataInputRefs>block183_outcomeInput</dataInputRefs>
        <dataInputRefs>block183_mittenteInput</dataInputRefs>
        <dataInputRefs>block183_nomeHTApprovazioneInput</dataInputRefs>
        <dataInputRefs>block183_systemTokenInput</dataInputRefs>
        <dataInputRefs>block183_gestioneEliminaInput</dataInputRefs>
        <dataInputRefs>block183_descrizioneInput</dataInputRefs>
        <dataInputRefs>block183_tipologieAnnessoInput</dataInputRefs>
        <dataInputRefs>block183_canalePECInput</dataInputRefs>
        <dataInputRefs>block183_filenameDinamicoInput</dataInputRefs>
        <dataInputRefs>block183_tipologieAllegatoInput</dataInputRefs>
        <dataInputRefs>block183_docnum_principaleInput</dataInputRefs>
        <dataInputRefs>block183_figura_professionaleInput</dataInputRefs>
        <dataInputRefs>block183_userInput</dataInputRefs>
        <dataInputRefs>block183_commitInput</dataInputRefs>
    </inputSet>

    <outputSet>
        <dataOutputRefs>block183_utente_approvatoreOutput</dataOutputRefs>
        <dataOutputRefs>block183_esitoOutput</dataOutputRefs>
        <dataOutputRefs>block183_businessStateOutput</dataOutputRefs>
        <dataOutputRefs>block183_systemTokenOutput</dataOutputRefs>
        <dataOutputRefs>block183_principaleOutput</dataOutputRefs>
        <dataOutputRefs>block183_lanesOutput</dataOutputRefs>
        <dataOutputRefs>block183_richiesta_revisioneOutput</dataOutputRefs>
    </outputSet>
</ioSpecification>

<!-- lista inputs -->
<dataInputAssociation><!-- k:note var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block183_noteInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:instanceName var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block183_instanceNameInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:tipologiePrincipale var type: textRef -->
        <sourceRef><![CDATA[tipologiePrincipale]]></sourceRef>
        <targetRef>block183_tipologiePrincipaleInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:approvatori var type: object -->
        <sourceRef><![CDATA[approvatori_dirigente]]></sourceRef>
        <targetRef>block183_approvatoriInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:descrizioneTask var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block183_descrizioneTaskInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:tipologieAnnotazione var type: textRef -->
        <sourceRef><![CDATA[tipologieAnnotazione]]></sourceRef>
        <targetRef>block183_tipologieAnnotazioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:INSTANCE_AOO var type: textRef -->
        <sourceRef><![CDATA[INSTANCE_AOO]]></sourceRef>
        <targetRef>block183_INSTANCE_AOOInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:humanToken var type: userToken -->
        <sourceRef><![CDATA[humanToken]]></sourceRef>
        <targetRef>block183_humanTokenInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:invio_notifica var type: script -->
        <sourceRef><![CDATA["no"]]></sourceRef>
        <targetRef>block183_invio_notificaInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:instanceId var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block183_instanceIdInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:gestioneAggiuntaRelated var type: script -->
        <sourceRef><![CDATA["si"]]></sourceRef>
        <targetRef>block183_gestioneAggiuntaRelatedInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:INSTANCE_ENTE var type: textRef -->
        <sourceRef><![CDATA[INSTANCE_ENTE]]></sourceRef>
        <targetRef>block183_INSTANCE_ENTEInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:lanes var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block183_lanesInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:formatoDataPerNote var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block183_formatoDataPerNoteInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:outcome var type: object -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block183_outcomeInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:mittente var type: tempRef -->
        <sourceRef><![CDATA[mittente]]></sourceRef>
        <targetRef>block183_mittenteInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:nomeHTApprovazione var type: textRef -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block183_nomeHTApprovazioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:systemToken var type: userToken -->
        <sourceRef><![CDATA[systemToken]]></sourceRef>
        <targetRef>block183_systemTokenInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:gestioneElimina var type: script -->
        <sourceRef><![CDATA["si"]]></sourceRef>
        <targetRef>block183_gestioneEliminaInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:descrizione var type: script -->
        <sourceRef><![CDATA["Approvazione determina - Dirigente ufficio "+descrizione_ufficioCompetenza]]></sourceRef>
        <targetRef>block183_descrizioneInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:tipologieAnnesso var type: textRef -->
        <sourceRef><![CDATA[tipologieAnnesso]]></sourceRef>
        <targetRef>block183_tipologieAnnessoInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:canalePEC var type: channel -->
        <targetRef>block183_canalePECInput</targetRef>
        <assignment>
            <from xsi:type="tFormalExpression"><![CDATA[]]></from>
            <to xsi:type="tFormalExpression">block183_canalePECInput</to>
        </assignment>
</dataInputAssociation>
<dataInputAssociation><!-- k:filenameDinamico var type: script -->
        <sourceRef><![CDATA["si"]]></sourceRef>
        <targetRef>block183_filenameDinamicoInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:tipologieAllegato var type: textRef -->
        <sourceRef><![CDATA[tipologieAllegato]]></sourceRef>
        <targetRef>block183_tipologieAllegatoInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:docnum_principale var type: script -->
        <sourceRef><![CDATA[doc_determina.DOCNUM]]></sourceRef>
        <targetRef>block183_docnum_principaleInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:figura_professionale var type: textRef -->
        <sourceRef><![CDATA[figura_professionale2]]></sourceRef>
        <targetRef>block183_figura_professionaleInput</targetRef>
</dataInputAssociation>
<dataInputAssociation><!-- k:user var type: object -->
        <sourceRef><![CDATA[]]></sourceRef>
        <targetRef>block183_userInput</targetRef>
</dataInputAssociation>

<!-- lista props -->
<dataInputAssociation><!-- var type: boolean -->
        <sourceRef>false</sourceRef>
        <targetRef>block183_commitInput</targetRef>
</dataInputAssociation>

<!-- lista outputs -->
<dataOutputAssociation>
        <sourceRef>block183_utente_approvatoreOutput</sourceRef>
        <targetRef></targetRef>
</dataOutputAssociation>
<dataOutputAssociation>
        <sourceRef>block183_esitoOutput</sourceRef>
        <targetRef>esito</targetRef>
</dataOutputAssociation>
<dataOutputAssociation>
        <sourceRef>block183_businessStateOutput</sourceRef>
        <targetRef></targetRef>
</dataOutputAssociation>
<dataOutputAssociation>
        <sourceRef>block183_systemTokenOutput</sourceRef>
        <targetRef>systemToken</targetRef>
</dataOutputAssociation>
<dataOutputAssociation>
        <sourceRef>block183_principaleOutput</sourceRef>
        <targetRef>doc_determina</targetRef>
</dataOutputAssociation>
<dataOutputAssociation>
        <sourceRef>block183_lanesOutput</sourceRef>
        <targetRef></targetRef>
</dataOutputAssociation>
<dataOutputAssociation>
        <sourceRef>block183_richiesta_revisioneOutput</sourceRef>
        <targetRef></targetRef>
</dataOutputAssociation>
    
</callActivity>






	</process>
</definitions>
